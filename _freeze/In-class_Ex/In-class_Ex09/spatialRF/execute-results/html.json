{
  "hash": "e1d95bc17fc55ea07affbabb84198c07",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"In-class Exercise 9: Geographically Weighted Predictive Modelling: SpatialRF methods\"\nexecute: \n  eval: true\n  echo: true\n  message: false\n  warning: false\n  freeze: true\nformat: html\n---\n\n\n## Background Information\n\n\n\n## Objective of analysis\n\nIn this take-home exercise, I will build hedonic pricing models to explain factors affecting the resale prices of public housing in Singapore. The hedonic price models will be built by using appropriate GWR methods.\n\n## Datasets\n\n-   **Aspatial dataset**:\n    -   HDB Resale data: a list of HDB resale transacted prices in Singapore from Jan 2017 onwards. It is in csv format which can be downloaded from Data.gov.sg.\n-   **Geospatial dataset**:\n    -   *MP14_SUBZONE_WEB_PL*: a polygon feature data providing information of URA 2014 Master Plan Planning Subzone boundary data. It is in ESRI shapefile format. This data set was also downloaded from Data.gov.sg\n-   **Locational factors with geographic coordinates**:\n    -   Downloaded from **Data.gov.sg**.\n        -   **Eldercare** data is a list of eldercare in Singapore. It is in shapefile format.\n        -   **Hawker Centre** data is a list of hawker centres in Singapore. It is in geojson format.\n        -   **Parks** data is a list of parks in Singapore. It is in geojson format.\n        -   **Supermarket** data is a list of supermarkets in Singapore. It is in geojson format.\n        -   **CHAS clinics** data is a list of CHAS clinics in Singapore. It is in geojson format.\n        -   **Childcare service** data is a list of childcare services in Singapore. It is in geojson format.\n        -   **Kindergartens** data is a list of kindergartens in Singapore. It is in geojson format.\n    -   Downloaded from **Datamall.lta.gov.sg**.\n        -   **MRT** data is a list of MRT/LRT stations in Singapore with the station names and codes. It is in shapefile format.\\\n        -   **Bus stops** data is a list of bus stops in Singapore. It is in shapefile format.\n-   **Locational factors without geographic coordinates**:\n    -   Downloaded from **Data.gov.sg**.\n        -   **Primary school** data is extracted from the list on General information of schools from data.gov portal. It is in csv format.\n    -   Retrieved/Scraped from **other sources**\n        -   **CBD** coordinates obtained from Google.\n        -   **Shopping malls** data is a list of Shopping malls in Singapore obtained from [Wikipedia](https://en.wikipedia.org/wiki/List_of_shopping_malls_in_Singapore).\n        -   **Good primary schools** is a list of primary schools that are ordered in ranking in terms of popularity and this can be found at [Local Salary Forum](https://www.salary.sg/2021/best-primary-schools-2021-by-popularity).\n\n## Install and Load R packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(sf, tidyverse, tmap, \n               tidymodels, spatialRF)\n```\n:::\n\n\n## The Data\n\n### Importing geospatial data\n\nThe geospatial data used in this hands-on exercise is called MP14_SUBZONE_WEB_PL. It is in ESRI shapefile format. The shapefile consists of URA Master Plan 2014's planning subzone boundaries. Polygon features are used to represent these geographic boundaries. The GIS data is in svy21 projected coordinates systems.\n\nThe code chunk below is used to import *MP_SUBZONE_WEB_PL* shapefile by using `st_read()` of **sf** packages.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmpsz = st_read(dsn = \"data/geospatial\", \n               layer = \"MP14_SUBZONE_WEB_PL\") %>%\n  st_transform(3414)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nReading layer `MP14_SUBZONE_WEB_PL' from data source \n  `D:\\tskam\\IS415-GAA\\In-class_Ex\\In-class_Ex09\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 323 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\n```\n\n\n:::\n:::\n\n\n### Importing the aspatial data\n\nThe *condo_resale_2015* is in csv file format. The codes chunk below uses `read_csv()` function of **readr** package to import *condo_resale_2015* into R as a tibble data frame called *condo_resale*.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncondo_resale_tbl = read_csv(\"data/aspatial/Condo_resale_2015.csv\")\n```\n:::\n\n\nAfter importing the data file into R, it is important for us to examine if the data file has been imported correctly.\n\nThe codes chunks below uses `glimpse()` to display the data structure of will do the job.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(condo_resale_tbl)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 1,436\nColumns: 23\n$ LATITUDE             <dbl> 1.287145, 1.328698, 1.313727, 1.308563, 1.321437,…\n$ LONGITUDE            <dbl> 103.7802, 103.8123, 103.7971, 103.8247, 103.9505,…\n$ POSTCODE             <dbl> 118635, 288420, 267833, 258380, 467169, 466472, 3…\n$ SELLING_PRICE        <dbl> 3000000, 3880000, 3325000, 4250000, 1400000, 1320…\n$ AREA_SQM             <dbl> 309, 290, 248, 127, 145, 139, 218, 141, 165, 168,…\n$ AGE                  <dbl> 30, 32, 33, 7, 28, 22, 24, 24, 27, 31, 17, 22, 6,…\n$ PROX_CBD             <dbl> 7.941259, 6.609797, 6.898000, 4.038861, 11.783402…\n$ PROX_CHILDCARE       <dbl> 0.16597932, 0.28027246, 0.42922669, 0.39473543, 0…\n$ PROX_ELDERLYCARE     <dbl> 2.5198118, 1.9333338, 0.5021395, 1.9910316, 1.121…\n$ PROX_URA_GROWTH_AREA <dbl> 6.618741, 7.505109, 6.463887, 4.906512, 6.410632,…\n$ PROX_HAWKER_MARKET   <dbl> 1.76542207, 0.54507614, 0.37789301, 1.68259969, 0…\n$ PROX_KINDERGARTEN    <dbl> 0.05835552, 0.61592412, 0.14120309, 0.38200076, 0…\n$ PROX_MRT             <dbl> 0.5607188, 0.6584461, 0.3053433, 0.6910183, 0.528…\n$ PROX_PARK            <dbl> 1.1710446, 0.1992269, 0.2779886, 0.9832843, 0.116…\n$ PROX_PRIMARY_SCH     <dbl> 1.6340256, 0.9747834, 1.4715016, 1.4546324, 0.709…\n$ PROX_TOP_PRIMARY_SCH <dbl> 3.3273195, 0.9747834, 1.4715016, 2.3006394, 0.709…\n$ PROX_SHOPPING_MALL   <dbl> 2.2102717, 2.9374279, 1.2256850, 0.3525671, 1.307…\n$ PROX_SUPERMARKET     <dbl> 0.9103958, 0.5900617, 0.4135583, 0.4162219, 0.581…\n$ PROX_BUS_STOP        <dbl> 0.10336166, 0.28673408, 0.28504777, 0.29872340, 0…\n$ NO_Of_UNITS          <dbl> 18, 20, 27, 30, 30, 31, 32, 32, 32, 32, 34, 34, 3…\n$ FAMILY_FRIENDLY      <dbl> 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0…\n$ FREEHOLD             <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1…\n$ LEASEHOLD_99YR       <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(condo_resale_tbl$LONGITUDE) #see the data in XCOORD column\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 103.7802 103.8123 103.7971 103.8247 103.9505 103.9386\n```\n\n\n:::\n\n```{.r .cell-code}\nhead(condo_resale_tbl$LATITUDE) #see the data in YCOORD column\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1.287145 1.328698 1.313727 1.308563 1.321437 1.314198\n```\n\n\n:::\n:::\n\n\nNext, `summary()` of base R is used to display the summary statistics of *cond_resale* tibble data frame.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(condo_resale_tbl)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    LATITUDE       LONGITUDE        POSTCODE      SELLING_PRICE     \n Min.   :1.240   Min.   :103.7   Min.   : 18965   Min.   :  540000  \n 1st Qu.:1.309   1st Qu.:103.8   1st Qu.:259849   1st Qu.: 1100000  \n Median :1.328   Median :103.8   Median :469298   Median : 1383222  \n Mean   :1.334   Mean   :103.8   Mean   :440439   Mean   : 1751211  \n 3rd Qu.:1.357   3rd Qu.:103.9   3rd Qu.:589486   3rd Qu.: 1950000  \n Max.   :1.454   Max.   :104.0   Max.   :828833   Max.   :18000000  \n    AREA_SQM          AGE           PROX_CBD       PROX_CHILDCARE    \n Min.   : 34.0   Min.   : 0.00   Min.   : 0.3869   Min.   :0.004927  \n 1st Qu.:103.0   1st Qu.: 5.00   1st Qu.: 5.5574   1st Qu.:0.174481  \n Median :121.0   Median :11.00   Median : 9.3567   Median :0.258135  \n Mean   :136.5   Mean   :12.14   Mean   : 9.3254   Mean   :0.326313  \n 3rd Qu.:156.0   3rd Qu.:18.00   3rd Qu.:12.6661   3rd Qu.:0.368293  \n Max.   :619.0   Max.   :37.00   Max.   :19.1804   Max.   :3.465726  \n PROX_ELDERLYCARE  PROX_URA_GROWTH_AREA PROX_HAWKER_MARKET PROX_KINDERGARTEN \n Min.   :0.05451   Min.   :0.2145       Min.   :0.05182    Min.   :0.004927  \n 1st Qu.:0.61254   1st Qu.:3.1643       1st Qu.:0.55245    1st Qu.:0.276345  \n Median :0.94179   Median :4.6186       Median :0.90842    Median :0.413385  \n Mean   :1.05351   Mean   :4.5981       Mean   :1.27987    Mean   :0.458903  \n 3rd Qu.:1.35122   3rd Qu.:5.7550       3rd Qu.:1.68578    3rd Qu.:0.578474  \n Max.   :3.94916   Max.   :9.1554       Max.   :5.37435    Max.   :2.229045  \n    PROX_MRT         PROX_PARK       PROX_PRIMARY_SCH  PROX_TOP_PRIMARY_SCH\n Min.   :0.05278   Min.   :0.02906   Min.   :0.07711   Min.   :0.07711     \n 1st Qu.:0.34646   1st Qu.:0.26211   1st Qu.:0.44024   1st Qu.:1.34451     \n Median :0.57430   Median :0.39926   Median :0.63505   Median :1.88213     \n Mean   :0.67316   Mean   :0.49802   Mean   :0.75471   Mean   :2.27347     \n 3rd Qu.:0.84844   3rd Qu.:0.65592   3rd Qu.:0.95104   3rd Qu.:2.90954     \n Max.   :3.48037   Max.   :2.16105   Max.   :3.92899   Max.   :6.74819     \n PROX_SHOPPING_MALL PROX_SUPERMARKET PROX_BUS_STOP       NO_Of_UNITS    \n Min.   :0.0000     Min.   :0.0000   Min.   :0.001595   Min.   :  18.0  \n 1st Qu.:0.5258     1st Qu.:0.3695   1st Qu.:0.098356   1st Qu.: 188.8  \n Median :0.9357     Median :0.5687   Median :0.151710   Median : 360.0  \n Mean   :1.0455     Mean   :0.6141   Mean   :0.193974   Mean   : 409.2  \n 3rd Qu.:1.3994     3rd Qu.:0.7862   3rd Qu.:0.220466   3rd Qu.: 590.0  \n Max.   :3.4774     Max.   :2.2441   Max.   :2.476639   Max.   :1703.0  \n FAMILY_FRIENDLY     FREEHOLD      LEASEHOLD_99YR  \n Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  \n 1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:0.0000  \n Median :0.0000   Median :0.0000   Median :0.0000  \n Mean   :0.4868   Mean   :0.4227   Mean   :0.4882  \n 3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:1.0000  \n Max.   :1.0000   Max.   :1.0000   Max.   :1.0000  \n```\n\n\n:::\n:::\n\n\n### Converting aspatial data frame into a sf object\n\nCurrently, the *condo_resale* tibble data frame is aspatial. We will convert it to a **sf** object. The code chunk below converts condo_resale data frame into a simple feature data frame by using `st_as_sf()` of **sf** packages.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncondo_resale_sf <- st_as_sf(\n  condo_resale_tbl,\n  coords = c(\"LONGITUDE\", \"LATITUDE\"),\n  crs=4326) %>%\n  st_transform(crs=3414)\n```\n:::\n\n\nNotice that `st_transform()` of **sf** package is used to convert the coordinates from wgs84 (i.e. crs:4326) to svy21 (i.e. crs=3414).\n\nLast but not least, we will convert condo_resale into data frame.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncondo_resale_df <- as.data.frame(condo_resale_tbl)\nclass(condo_resale_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"data.frame\"\n```\n\n\n:::\n:::\n\n\n## Geographically Weighted Predictive Model: spatialRF methods\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncoords <- st_coordinates(condo_resale_sf)\n#rs_data <- cbind(rs_data, coords) %>%\n#  st_drop_geometry()\n```\n:::\n\n\n### Computing distance matrix\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndm <- dist(coords)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndm1 <- as.matrix(dm) \n```\n:::\n\n\nWrite the data frame into rds for future use.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite_rds(dm1, \"data/spatialRF/dist_mat.rds\")\nwrite_rds(condo_resale_df,\n          \"data/spatialRF/condo_resale.rds\")\n```\n:::\n\n\n## Reading the modelling data sets\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncondo_resale <- read_rds(\"data/spatialRF/condo_resale.rds\")\ndist_mat <- read_rds(\"data/spatialRF/dist_mat.rds\")\ndist_th <- c(0, 500, 1000, 1500, 2000, 2500, 3000)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmem <- mem(dist_mat)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nvif(condo_resale[, 5:23])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n               variable   vif\n1        LEASEHOLD_99YR 3.779\n2              FREEHOLD 3.665\n3        PROX_CHILDCARE 3.450\n4         PROX_BUS_STOP 3.020\n5      PROX_PRIMARY_SCH 2.616\n6    PROX_HAWKER_MARKET 2.286\n7              PROX_CBD 2.186\n8  PROX_TOP_PRIMARY_SCH 2.050\n9    PROX_SHOPPING_MALL 2.040\n10             PROX_MRT 2.020\n11     PROX_ELDERLYCARE 1.689\n12     PROX_SUPERMARKET 1.628\n13          NO_Of_UNITS 1.528\n14 PROX_URA_GROWTH_AREA 1.512\n15                  AGE 1.426\n16      FAMILY_FRIENDLY 1.390\n17            PROX_PARK 1.248\n18    PROX_KINDERGARTEN 1.197\n19             AREA_SQM 1.163\n```\n\n\n:::\n:::\n\n\n### Fitting a non-spatial random forest model\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrs_rf <- rf(\n  data = condo_resale,\n  dependent.variable.name = \"SELLING_PRICE\",\n  predictor.variable.names = colnames(condo_resale)[5:23],\n  distance.matrix = dist_mat,\n  distance.thresholds = dist_th,\n  seed = 1234,\n  n.cores = 1\n  )\n```\n\n::: {.cell-output-display}\n![](spatialRF_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](spatialRF_files/figure-html/unnamed-chunk-16-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](spatialRF_files/figure-html/unnamed-chunk-16-3.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nModel type\n  - Fitted with:                     ranger()\n  - Response variable:               SELLING_PRICE\n\nRandom forest parameters\n  - Type:                            Regression\n  - Number of trees:                 500\n  - Sample size:                     1436\n  - Number of predictors:            19\n  - Mtry:                            4\n  - Minimum node size:               5\n\n\nModel performance \n  - R squared (oob):                  0.743754\n  - R squared (cor(obs, pred)^2):     0.9627429\n  - Pseudo R squared (cor(obs, pred)):0.9811946\n  - RMSE (oob):                       644289.5\n  - RMSE:                             294573.1\n  - Normalized RMSE:                  0.3465566\n\nModel residuals \n  - Stats: \n    ┌────────────┬───────────┬───────────┬────────┬──────────┬────────────┐\n    │ Min.       │ 1st Q.    │ Median    │ Mean   │ 3rd Q.   │ Max.       │\n    ├────────────┼───────────┼───────────┼────────┼──────────┼────────────┤\n    │ -1251849.1 │ -81609.90 │ -23770.12 │ 426.83 │ 40821.13 │ 6320311.37 │\n    │          3 │           │           │        │          │            │\n    └────────────┴───────────┴───────────┴────────┴──────────┴────────────┘\n  - Normality: \n      - Shapiro-Wilks W: 0.454 \n      - p-value        : 0 \n      - Interpretation : Residuals are not normal \n\n  - Spatial autocorrelation: \n             ┌──────────┬───────────┬─────────┬──────────────────┐\n             │ Distance │ Moran's I │ P value │ Interpretation   │\n             ├──────────┼───────────┼─────────┼──────────────────┤\n             │      0.0 │     0.007 │   0.330 │ No spatial       │\n             │          │           │         │ correlation      │\n             ├──────────┼───────────┼─────────┼──────────────────┤\n             │    500.0 │     0.065 │   0.000 │ Positive spatial │\n             │          │           │         │ correlation      │\n             ├──────────┼───────────┼─────────┼──────────────────┤\n             │   1000.0 │     0.049 │   0.000 │ Positive spatial │\n             │          │           │         │ correlation      │\n             ├──────────┼───────────┼─────────┼──────────────────┤\n             │   1500.0 │     0.045 │   0.000 │ Positive spatial │\n             │          │           │         │ correlation      │\n             ├──────────┼───────────┼─────────┼──────────────────┤\n             │   2000.0 │     0.032 │   0.000 │ Positive spatial │\n             │          │           │         │ correlation      │\n             ├──────────┼───────────┼─────────┼──────────────────┤\n             │   2500.0 │     0.025 │   0.000 │ Positive spatial │\n             │          │           │         │ correlation      │\n             ├──────────┼───────────┼─────────┼──────────────────┤\n             │   3000.0 │     0.019 │   0.000 │ Positive spatial │\n             │          │           │         │ correlation      │\n             └──────────┴───────────┴─────────┴──────────────────┘\n\nVariable importance: \n                     ┌──────────────────────┬────────────┐\n                     │ Variable             │ Importance │\n                     ├──────────────────────┼────────────┤\n                     │ PROX_CBD             │ 871303.326 │\n                     ├──────────────────────┼────────────┤\n                     │ AREA_SQM             │ 790996.980 │\n                     ├──────────────────────┼────────────┤\n                     │ PROX_HAWKER_MARKET   │ 562558.052 │\n                     ├──────────────────────┼────────────┤\n                     │ PROX_SHOPPING_MALL   │ 426226.349 │\n                     ├──────────────────────┼────────────┤\n                     │ PROX_PARK            │ 423803.859 │\n                     ├──────────────────────┼────────────┤\n                     │ PROX_PRIMARY_SCH     │ 419477.614 │\n                     ├──────────────────────┼────────────┤\n                     │ FREEHOLD             │ 355699.597 │\n                     ├──────────────────────┼────────────┤\n                     │ NO_Of_UNITS          │ 342057.355 │\n                     ├──────────────────────┼────────────┤\n                     │ PROX_TOP_PRIMARY_SCH │ 328606.409 │\n                     ├──────────────────────┼────────────┤\n                     │ AGE                  │ 321269.667 │\n                     ├──────────────────────┼────────────┤\n                     │ PROX_ELDERLYCARE     │ 307580.976 │\n                     ├──────────────────────┼────────────┤\n                     │ LEASEHOLD_99YR       │ 301769.399 │\n                     ├──────────────────────┼────────────┤\n                     │ PROX_MRT             │ 292885.106 │\n                     ├──────────────────────┼────────────┤\n                     │ PROX_BUS_STOP        │ 278731.266 │\n                     ├──────────────────────┼────────────┤\n                     │ PROX_URA_GROWTH_AREA │ 247489.168 │\n                     ├──────────────────────┼────────────┤\n                     │ PROX_SUPERMARKET     │ 231919.768 │\n                     ├──────────────────────┼────────────┤\n                     │ PROX_CHILDCARE       │ 211803.093 │\n                     ├──────────────────────┼────────────┤\n                     │ PROX_KINDERGARTEN    │ 198976.970 │\n                     ├──────────────────────┼────────────┤\n                     │ FAMILY_FRIENDLY      │ 168897.868 │\n                     └──────────────────────┴────────────┘\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite_rds(rs_rf, \n          \"data/spatialRF/rs_rf.rds\")\n```\n:::\n\n\n::: {.callout-warning}\nThis is a very time-consuming process.\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_training_df_moran(\n  data = condo_resale,\n  dependent.variable.name = \"SELLING_PRICE\",\n  predictor.variable.names = colnames(condo_resale)[5:23],\n  distance.matrix = dist_mat,\n  distance.thresholds = dist_th,\n  point.color = \"gray40\"\n)\n```\n:::\n\n\n### Retrieving RF results\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrs_rf <- read_rds(\"data/spatialRF/rs_rf.rds\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_moran(rs_rf,\n           verbose = FALSE)\n```\n\n::: {.cell-output-display}\n![](spatialRF_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n\n### Calibrating Spatial Random Forest\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrs_sprf <- rf_spatial(\n  data = condo_resale,\n  dependent.variable.name = \"SELLING_PRICE\",\n  predictor.variable.names = colnames(condo_resale)[5:23],\n  distance.matrix = dist_mat,\n  distance.thresholds = 580,\n  method = \"hengl\",\n  n.cores = 1\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nModel type\n  - Fitted with:                     rf_spatial()\n  - rf_spatial() method:             hengl\n  - Response variable:               SELLING_PRICE\n\nRandom forest parameters\n  - Type:                            Regression\n  - Number of trees:                 500\n  - Sample size:                     1436\n  - Number of predictors:            1455\n  - Mtry:                            38\n  - Minimum node size:               5\n\n\nModel performance \n  - R squared (oob):                  0.6245027\n  - R squared (cor(obs, pred)^2):     0.9445632\n  - Pseudo R squared (cor(obs, pred)):0.9718864\n  - RMSE (oob):                       779930.6\n  - RMSE:                             332623.4\n  - Normalized RMSE:                  0.3913216\n\nModel residuals \n  - Stats: \n    ┌────────────┬───────────┬───────────┬─────────┬──────────┬────────────┐\n    │ Min.       │ 1st Q.    │ Median    │ Mean    │ 3rd Q.   │ Max.       │\n    ├────────────┼───────────┼───────────┼─────────┼──────────┼────────────┤\n    │ -1769420.6 │ -95536.88 │ -18872.46 │ 1757.87 │ 66933.81 │ 5511410.40 │\n    │          0 │           │           │         │          │            │\n    └────────────┴───────────┴───────────┴─────────┴──────────┴────────────┘\n  - Normality: \n      - Shapiro-Wilks W: 0.609 \n      - p-value        : 0 \n      - Interpretation : Residuals are not normal \n\n  - Spatial autocorrelation: \n             ┌──────────┬───────────┬─────────┬──────────────────┐\n             │ Distance │ Moran's I │ P value │ Interpretation   │\n             ├──────────┼───────────┼─────────┼──────────────────┤\n             │    580.0 │    -0.066 │   0.000 │ Negative spatial │\n             │          │           │         │ correlation      │\n             └──────────┴───────────┴─────────┴──────────────────┘\n\nVariable importance: \n              ┌────────────────────────────────────┬────────────┐\n              │ Variable                           │ Importance │\n              ├────────────────────────────────────┼────────────┤\n              │ spatial_predictors (max)           │ 315905.445 │\n              ├────────────────────────────────────┼────────────┤\n              │ AREA_SQM                           │ 263745.792 │\n              ├────────────────────────────────────┼────────────┤\n              │ PROX_PRIMARY_SCH                   │ 188737.840 │\n              ├────────────────────────────────────┼────────────┤\n              │ PROX_PARK                          │ 131268.107 │\n              ├────────────────────────────────────┼────────────┤\n              │ PROX_HAWKER_MARKET                 │ 103055.700 │\n              ├────────────────────────────────────┼────────────┤\n              │ PROX_TOP_PRIMARY_SCH               │  95375.978 │\n              ├────────────────────────────────────┼────────────┤\n              │ PROX_ELDERLYCARE                   │  94922.837 │\n              ├────────────────────────────────────┼────────────┤\n              │ PROX_URA_GROWTH_AREA               │  79874.550 │\n              ├────────────────────────────────────┼────────────┤\n              │ PROX_SUPERMARKET                   │  77323.228 │\n              ├────────────────────────────────────┼────────────┤\n              │ AGE                                │  72798.250 │\n              ├────────────────────────────────────┼────────────┤\n              │ PROX_CBD                           │  72738.794 │\n              ├────────────────────────────────────┼────────────┤\n              │ FAMILY_FRIENDLY                    │  68899.037 │\n              ├────────────────────────────────────┼────────────┤\n              │ LEASEHOLD_99YR                     │  63976.606 │\n              ├────────────────────────────────────┼────────────┤\n              │ PROX_BUS_STOP                      │  63606.925 │\n              ├────────────────────────────────────┼────────────┤\n              │ spatial_predictors (quantile 0.75) │  61300.518 │\n              ├────────────────────────────────────┼────────────┤\n              │ PROX_MRT                           │  51175.270 │\n              ├────────────────────────────────────┼────────────┤\n              │ PROX_SHOPPING_MALL                 │  42882.501 │\n              ├────────────────────────────────────┼────────────┤\n              │ PROX_CHILDCARE                     │  40493.121 │\n              ├────────────────────────────────────┼────────────┤\n              │ spatial_predictors (median)        │  38911.420 │\n              ├────────────────────────────────────┼────────────┤\n              │ FREEHOLD                           │  37068.372 │\n              ├────────────────────────────────────┼────────────┤\n              │ NO_Of_UNITS                        │  36900.470 │\n              ├────────────────────────────────────┼────────────┤\n              │ PROX_KINDERGARTEN                  │  30231.961 │\n              ├────────────────────────────────────┼────────────┤\n              │ spatial_predictors (quantile 0.25) │  25270.681 │\n              ├────────────────────────────────────┼────────────┤\n              │ spatial_predictors (min)           │ -40500.248 │\n              └────────────────────────────────────┴────────────┘\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](spatialRF_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](spatialRF_files/figure-html/unnamed-chunk-21-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite_rds(rs_sprf, \"data/spatialRF/rs_sprf.rds\")\n```\n:::\n",
    "supporting": [
      "spatialRF_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}