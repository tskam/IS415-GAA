<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>IS415-GAA - In-class Exercise 11: Calibrating Spatial Interaction Models (SIM) with R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">IS415-GAA</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex02/In-class_Ex02.html">
 <span class="dropdown-text">In-class Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex03/In-class_Ex03.html">
 <span class="dropdown-text">In-class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex04/In-class_Ex04.html">
 <span class="dropdown-text">In-class Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex05/In-class_Ex05.html">
 <span class="dropdown-text">In-class Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex06/In-class_Ex06.html">
 <span class="dropdown-text">In-class Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex07/In-class_Ex07-GLSA.html">
 <span class="dropdown-text">In-class Exercise 7: GLSA</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex07/In-class_Ex07_EHSA.html">
 <span class="dropdown-text">In-class Exercise 7: EHSA</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex08/In-class_Ex08_gwr.html">
 <span class="dropdown-text">In-class Exercise 8: gwr</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex09/In-class_Ex09_gwML.html">
 <span class="dropdown-text">In-class Exercise 9: gwML</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex10/In-class_Ex10_GeoAcc.html">
 <span class="dropdown-text">In-class Exercise 10: GeoAcc</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex11/In-class_Ex11_SIM.html">
 <span class="dropdown-text">In-class Exercise 11: SIM</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex01/Take-home_Ex01.html">
 <span class="dropdown-text">Take-home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html">
 <span class="dropdown-text">Take-home Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex03/Take-home_Ex03.html">
 <span class="dropdown-text">Take-home Exercise 3</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link active" data-scroll-target="#getting-started">Getting Started</a></li>
  <li><a href="#preparing-the-flow-data" id="toc-preparing-the-flow-data" class="nav-link" data-scroll-target="#preparing-the-flow-data">Preparing the Flow Data</a>
  <ul class="collapse">
  <li><a href="#importing-the-od-data" id="toc-importing-the-od-data" class="nav-link" data-scroll-target="#importing-the-od-data">Importing the OD data</a></li>
  <li><a href="#extracting-the-study-data" id="toc-extracting-the-study-data" class="nav-link" data-scroll-target="#extracting-the-study-data">Extracting the study data</a></li>
  </ul></li>
  <li><a href="#working-with-geospatial-data" id="toc-working-with-geospatial-data" class="nav-link" data-scroll-target="#working-with-geospatial-data">Working with Geospatial Data</a>
  <ul class="collapse">
  <li><a href="#importing-geospatial-data" id="toc-importing-geospatial-data" class="nav-link" data-scroll-target="#importing-geospatial-data">Importing geospatial data</a></li>
  </ul></li>
  <li><a href="#geospatial-data-wrangling" id="toc-geospatial-data-wrangling" class="nav-link" data-scroll-target="#geospatial-data-wrangling">Geospatial data wrangling</a>
  <ul class="collapse">
  <li><a href="#combining-busstop-and-mpsz" id="toc-combining-busstop-and-mpsz" class="nav-link" data-scroll-target="#combining-busstop-and-mpsz">Combining Busstop and mpsz</a></li>
  </ul></li>
  <li><a href="#visualising-the-geospatial-data" id="toc-visualising-the-geospatial-data" class="nav-link" data-scroll-target="#visualising-the-geospatial-data">Visualising the Geospatial Data</a></li>
  <li><a href="#viewing-the-subzone-spatial-file" id="toc-viewing-the-subzone-spatial-file" class="nav-link" data-scroll-target="#viewing-the-subzone-spatial-file">Viewing the Subzone spatial file</a></li>
  <li><a href="#isolating-subzone_c-subzone_code-into-a-new-df" id="toc-isolating-subzone_c-subzone_code-into-a-new-df" class="nav-link" data-scroll-target="#isolating-subzone_c-subzone_code-into-a-new-df">Isolating SUBZONE_C (subzone_code) into a new df</a>
  <ul class="collapse">
  <li><a href="#computing-distance-matrix" id="toc-computing-distance-matrix" class="nav-link" data-scroll-target="#computing-distance-matrix">Computing Distance Matrix</a>
  <ul class="collapse">
  <li><a href="#converting-from-sf-data.table-to-spatialpolygondataframe" id="toc-converting-from-sf-data.table-to-spatialpolygondataframe" class="nav-link" data-scroll-target="#converting-from-sf-data.table-to-spatialpolygondataframe">Converting from sf data.table to SpatialPolygonDataFrame</a></li>
  <li><a href="#computing-the-distance-matrix" id="toc-computing-the-distance-matrix" class="nav-link" data-scroll-target="#computing-the-distance-matrix">Computing the distance matrix</a></li>
  <li><a href="#sorting-the-distance-matrix-by-plannint-sub-zone-code" id="toc-sorting-the-distance-matrix-by-plannint-sub-zone-code" class="nav-link" data-scroll-target="#sorting-the-distance-matrix-by-plannint-sub-zone-code">Sorting the distance matrix by plannint sub-zone code</a></li>
  <li><a href="#attaching-subzone_c-to-row-and-column-for-distance-matrix-matching-ahead" id="toc-attaching-subzone_c-to-row-and-column-for-distance-matrix-matching-ahead" class="nav-link" data-scroll-target="#attaching-subzone_c-to-row-and-column-for-distance-matrix-matching-ahead">Attaching SUBZONE_C to row and column for distance matrix matching ahead</a></li>
  <li><a href="#pivoting-distance-value-by-subzone_c" id="toc-pivoting-distance-value-by-subzone_c" class="nav-link" data-scroll-target="#pivoting-distance-value-by-subzone_c">Pivoting distance value by SUBZONE_C</a></li>
  <li><a href="#updating-intra-zonal-distances" id="toc-updating-intra-zonal-distances" class="nav-link" data-scroll-target="#updating-intra-zonal-distances">Updating intra-zonal distances</a></li>
  </ul></li>
  <li><a href="#preparing-flow-data" id="toc-preparing-flow-data" class="nav-link" data-scroll-target="#preparing-flow-data">Preparing flow data</a>
  <ul class="collapse">
  <li><a href="#separating-intra-flow-from-passenger-volume-df" id="toc-separating-intra-flow-from-passenger-volume-df" class="nav-link" data-scroll-target="#separating-intra-flow-from-passenger-volume-df">Separating intra-flow from passenger volume df</a></li>
  <li><a href="#combining-passenger-volume-data-with-distance-value" id="toc-combining-passenger-volume-data-with-distance-value" class="nav-link" data-scroll-target="#combining-passenger-volume-data-with-distance-value">Combining passenger volume data with distance value</a></li>
  </ul></li>
  <li><a href="#visualising-spatial-interaction" id="toc-visualising-spatial-interaction" class="nav-link" data-scroll-target="#visualising-spatial-interaction">Visualising Spatial Interaction</a>
  <ul class="collapse">
  <li><a href="#removing-intra-zonal-flows" id="toc-removing-intra-zonal-flows" class="nav-link" data-scroll-target="#removing-intra-zonal-flows">Removing intra-zonal flows</a></li>
  <li><a href="#creating-desire-lines" id="toc-creating-desire-lines" class="nav-link" data-scroll-target="#creating-desire-lines">Creating desire lines</a></li>
  <li><a href="#visualising-the-desire-lines" id="toc-visualising-the-desire-lines" class="nav-link" data-scroll-target="#visualising-the-desire-lines">Visualising the desire lines</a></li>
  </ul></li>
  <li><a href="#preparing-origin-and-destination-attributes" id="toc-preparing-origin-and-destination-attributes" class="nav-link" data-scroll-target="#preparing-origin-and-destination-attributes">Preparing Origin and Destination Attributes</a>
  <ul class="collapse">
  <li><a href="#importing-population-data" id="toc-importing-population-data" class="nav-link" data-scroll-target="#importing-population-data">Importing population data</a></li>
  <li><a href="#geospatial-data-wrangling-1" id="toc-geospatial-data-wrangling-1" class="nav-link" data-scroll-target="#geospatial-data-wrangling-1">Geospatial data wrangling</a></li>
  <li><a href="#preparing-origin-attribute" id="toc-preparing-origin-attribute" class="nav-link" data-scroll-target="#preparing-origin-attribute">Preparing origin attribute</a></li>
  <li><a href="#preparing-destination-attribute" id="toc-preparing-destination-attribute" class="nav-link" data-scroll-target="#preparing-destination-attribute">Preparing destination attribute</a></li>
  </ul></li>
  <li><a href="#calibrating-spatial-interaction-models" id="toc-calibrating-spatial-interaction-models" class="nav-link" data-scroll-target="#calibrating-spatial-interaction-models">Calibrating Spatial Interaction Models</a>
  <ul class="collapse">
  <li><a href="#importing-the-modelling-data" id="toc-importing-the-modelling-data" class="nav-link" data-scroll-target="#importing-the-modelling-data">Importing the modelling data</a></li>
  <li><a href="#checking-for-variables-with-zero-values" id="toc-checking-for-variables-with-zero-values" class="nav-link" data-scroll-target="#checking-for-variables-with-zero-values">Checking for variables with zero values</a></li>
  <li><a href="#unconstrained-spatial-interaction-model" id="toc-unconstrained-spatial-interaction-model" class="nav-link" data-scroll-target="#unconstrained-spatial-interaction-model">Unconstrained Spatial Interaction Model</a></li>
  <li><a href="#r-squared-function" id="toc-r-squared-function" class="nav-link" data-scroll-target="#r-squared-function">R-squared function</a></li>
  <li><a href="#origin-production-constrained-sim" id="toc-origin-production-constrained-sim" class="nav-link" data-scroll-target="#origin-production-constrained-sim">Origin (Production) constrained SIM</a></li>
  <li><a href="#destination-constrained" id="toc-destination-constrained" class="nav-link" data-scroll-target="#destination-constrained">Destination constrained</a></li>
  <li><a href="#doubly-constrained" id="toc-doubly-constrained" class="nav-link" data-scroll-target="#doubly-constrained">Doubly constrained</a></li>
  <li><a href="#model-comparison" id="toc-model-comparison" class="nav-link" data-scroll-target="#model-comparison">Model comparison</a></li>
  <li><a href="#visualising-fitted" id="toc-visualising-fitted" class="nav-link" data-scroll-target="#visualising-fitted">Visualising fitted</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">In-class Exercise 11: Calibrating Spatial Interaction Models (SIM) with R</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="getting-started" class="level2">
<h2 class="anchored" data-anchor-id="getting-started">Getting Started</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tmap, sf, sp, stplanr, </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               reshape2, broom, performance,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               gtsummary, ggpubr, tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="preparing-the-flow-data" class="level2">
<h2 class="anchored" data-anchor-id="preparing-the-flow-data">Preparing the Flow Data</h2>
<section id="importing-the-od-data" class="level3">
<h3 class="anchored" data-anchor-id="importing-the-od-data">Importing the OD data</h3>
<p>Firstly, we will import the <em>Passenger Volume by Origin Destination Bus Stops</em> data set downloaded from LTA DataMall by using <code>read_csv()</code> of <strong>readr</strong> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>odbus <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/origin_destination_bus_202210.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A quick check of odbus tibble data frame shows that the values in OROGIN_PT_CODE and DESTINATON_PT_CODE are in numeric data type. Hence, the code chunk below is used to convert these data values into character data type.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>odbus<span class="sc">$</span>ORIGIN_PT_CODE <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(odbus<span class="sc">$</span>ORIGIN_PT_CODE)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>odbus<span class="sc">$</span>DESTINATION_PT_CODE <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(odbus<span class="sc">$</span>DESTINATION_PT_CODE) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="extracting-the-study-data" class="level3">
<h3 class="anchored" data-anchor-id="extracting-the-study-data">Extracting the study data</h3>
<p>For the purpose of this exercise, we will extract commuting flows on weekday and between 7 and 9 o’clock.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>odbus7_9 <span class="ot">&lt;-</span> odbus <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(DAY_TYPE <span class="sc">==</span> <span class="st">"WEEKDAY"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TIME_PER_HOUR <span class="sc">&gt;=</span> <span class="dv">7</span> <span class="sc">&amp;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>           TIME_PER_HOUR <span class="sc">&lt;=</span> <span class="dv">9</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ORIGIN_PT_CODE,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>           DESTINATION_PT_CODE) <span class="sc">%&gt;%</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TRIPS =</span> <span class="fu">sum</span>(TOTAL_TRIPS))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will save the output in rds format for future used.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(odbus7_9, <span class="st">"data/rds/odbus7_9.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The code chunk below will be used to import the save odbus7_9.rds into R environment.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>odbus7_9 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/odbus7_9.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="working-with-geospatial-data" class="level2">
<h2 class="anchored" data-anchor-id="working-with-geospatial-data">Working with Geospatial Data</h2>
<p>For the purpose of this exercise, two geospatial data will be used. They are:</p>
<ul>
<li>BusStop: This data provides the location of bus stop as at last quarter of 2022.</li>
<li>MPSZ-2019: This data provides the sub-zone boundary of URA Master Plan 2019.</li>
</ul>
<p>Both data sets are in ESRI shapefile format.</p>
<section id="importing-geospatial-data" class="level3">
<h3 class="anchored" data-anchor-id="importing-geospatial-data">Importing geospatial data</h3>
<p>Two geospatial data will be used in this exercise, they are:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>busstop <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>,</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">layer =</span> <span class="st">"BusStop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>mpsz <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>,</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">layer =</span> <span class="st">"MPSZ-2019"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `MPSZ-2019' from data source 
  `D:\tskam\IS415-GAA\In-class_Ex\In-class_Ex11\data\geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 332 features and 6 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775
Geodetic CRS:  WGS 84</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>mpsz</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 332 features and 6 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33
Projected CRS: SVY21 / Singapore TM
First 10 features:
                 SUBZONE_N SUBZONE_C       PLN_AREA_N PLN_AREA_C       REGION_N
1              MARINA EAST    MESZ01      MARINA EAST         ME CENTRAL REGION
2         INSTITUTION HILL    RVSZ05     RIVER VALLEY         RV CENTRAL REGION
3           ROBERTSON QUAY    SRSZ01  SINGAPORE RIVER         SR CENTRAL REGION
4  JURONG ISLAND AND BUKOM    WISZ01  WESTERN ISLANDS         WI    WEST REGION
5             FORT CANNING    MUSZ02           MUSEUM         MU CENTRAL REGION
6         MARINA EAST (MP)    MPSZ05    MARINE PARADE         MP CENTRAL REGION
7                   SUDONG    WISZ03  WESTERN ISLANDS         WI    WEST REGION
8                  SEMAKAU    WISZ02  WESTERN ISLANDS         WI    WEST REGION
9           SOUTHERN GROUP    SISZ02 SOUTHERN ISLANDS         SI CENTRAL REGION
10                 SENTOSA    SISZ01 SOUTHERN ISLANDS         SI CENTRAL REGION
   REGION_C                       geometry
1        CR MULTIPOLYGON (((33222.98 29...
2        CR MULTIPOLYGON (((28481.45 30...
3        CR MULTIPOLYGON (((28087.34 30...
4        WR MULTIPOLYGON (((14557.7 304...
5        CR MULTIPOLYGON (((29542.53 31...
6        CR MULTIPOLYGON (((35279.55 30...
7        WR MULTIPOLYGON (((15772.59 21...
8        WR MULTIPOLYGON (((19843.41 21...
9        CR MULTIPOLYGON (((30870.53 22...
10       CR MULTIPOLYGON (((26879.04 26...</code></pre>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>st_read()</code> function of sf package is used to import the shapefile into R as sf data frame.</li>
<li><code>st_transform()</code> function of sf package is used to transform the projection to crs 3414.</li>
</ul>
</div>
</div>
</section>
</section>
<section id="geospatial-data-wrangling" class="level2">
<h2 class="anchored" data-anchor-id="geospatial-data-wrangling">Geospatial data wrangling</h2>
<section id="combining-busstop-and-mpsz" class="level3">
<h3 class="anchored" data-anchor-id="combining-busstop-and-mpsz">Combining Busstop and mpsz</h3>
<p>Code chunk below populates the planning subzone code (i.e.&nbsp;SUBZONE_C) of mpsz sf data frame into busstop sf data frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>busstop_mpsz <span class="ot">&lt;-</span> <span class="fu">st_intersection</span>(busstop, mpsz) <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(BUS_STOP_N, SUBZONE_C) <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>st_intersection()</code> is used to perform point and polygon overly and the output will be in point sf object.</li>
<li><code>select()</code> of dplyr package is then use to retain only BUS_STOP_N and SUBZONE_C in the busstop_mpsz sf data frame.</li>
<li>five bus stops are excluded in the resultant data frame because they are outside of Singapore bpundary.</li>
</ul>
</div>
</div>
<p>Before moving to the next step, it is wise to save the output into rds format.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(busstop_mpsz, <span class="st">"data/rds/busstop_mpsz.csv"</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we are going to append the planning subzone code from busstop_mpsz data frame onto odbus7_9 data frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>od_data <span class="ot">&lt;-</span> <span class="fu">left_join</span>(odbus7_9 , busstop_mpsz,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"ORIGIN_PT_CODE"</span> <span class="ot">=</span> <span class="st">"BUS_STOP_N"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">ORIGIN_BS =</span> ORIGIN_PT_CODE,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">ORIGIN_SZ =</span> SUBZONE_C,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">DESTIN_BS =</span> DESTINATION_PT_CODE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Before continue, it is a good practice for us to check for duplicating records.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>duplicate <span class="ot">&lt;-</span> od_data <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by_all</span>() <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>()<span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If duplicated records are found, the code chunk below will be used to retain the unique records.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>od_data <span class="ot">&lt;-</span> <span class="fu">unique</span>(od_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It will be a good practice to confirm if the duplicating records issue has been addressed fully.</p>
<p>Next, we will update od_data data frame cwith the planning subzone codes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>od_data <span class="ot">&lt;-</span> <span class="fu">left_join</span>(od_data , busstop_mpsz,</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"DESTIN_BS"</span> <span class="ot">=</span> <span class="st">"BUS_STOP_N"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>duplicate <span class="ot">&lt;-</span> od_data <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by_all</span>() <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>()<span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>od_data <span class="ot">&lt;-</span> <span class="fu">unique</span>(od_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>od_data <span class="ot">&lt;-</span> od_data <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">DESTIN_SZ =</span> SUBZONE_C) <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It is time to save the output into an rds file format.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(od_data, <span class="st">"data/rds/od_data.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>od_data <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/od_data.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="visualising-the-geospatial-data" class="level2">
<h2 class="anchored" data-anchor-id="visualising-the-geospatial-data">Visualising the Geospatial Data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_options</span>(<span class="at">check.and.fix =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qtm</span>(mpsz)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="In-class_Ex11_SIM_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="viewing-the-subzone-spatial-file" class="level1">
<h1>Viewing the Subzone spatial file</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mpsz, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 10 features and 6 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 8012.578 ymin: 15748.72 xmax: 35287.9 ymax: 31092.38
Projected CRS: SVY21 / Singapore TM
                 SUBZONE_N SUBZONE_C       PLN_AREA_N PLN_AREA_C       REGION_N
1              MARINA EAST    MESZ01      MARINA EAST         ME CENTRAL REGION
2         INSTITUTION HILL    RVSZ05     RIVER VALLEY         RV CENTRAL REGION
3           ROBERTSON QUAY    SRSZ01  SINGAPORE RIVER         SR CENTRAL REGION
4  JURONG ISLAND AND BUKOM    WISZ01  WESTERN ISLANDS         WI    WEST REGION
5             FORT CANNING    MUSZ02           MUSEUM         MU CENTRAL REGION
6         MARINA EAST (MP)    MPSZ05    MARINE PARADE         MP CENTRAL REGION
7                   SUDONG    WISZ03  WESTERN ISLANDS         WI    WEST REGION
8                  SEMAKAU    WISZ02  WESTERN ISLANDS         WI    WEST REGION
9           SOUTHERN GROUP    SISZ02 SOUTHERN ISLANDS         SI CENTRAL REGION
10                 SENTOSA    SISZ01 SOUTHERN ISLANDS         SI CENTRAL REGION
   REGION_C                       geometry
1        CR MULTIPOLYGON (((33222.98 29...
2        CR MULTIPOLYGON (((28481.45 30...
3        CR MULTIPOLYGON (((28087.34 30...
4        WR MULTIPOLYGON (((14557.7 304...
5        CR MULTIPOLYGON (((29542.53 31...
6        CR MULTIPOLYGON (((35279.55 30...
7        WR MULTIPOLYGON (((15772.59 21...
8        WR MULTIPOLYGON (((19843.41 21...
9        CR MULTIPOLYGON (((30870.53 22...
10       CR MULTIPOLYGON (((26879.04 26...</code></pre>
</div>
</div>
</section>
<section id="isolating-subzone_c-subzone_code-into-a-new-df" class="level1">
<h1>Isolating SUBZONE_C (subzone_code) into a new df</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>mpsz <span class="ot">&lt;-</span> mpsz[<span class="fu">order</span>(mpsz<span class="sc">$</span>SUBZONE_C),]</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mpsz, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 10 features and 6 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 26154.57 ymin: 37511.2 xmax: 31072.47 ymax: 41804.65
Projected CRS: SVY21 / Singapore TM
                 SUBZONE_N SUBZONE_C PLN_AREA_N PLN_AREA_C          REGION_N
171 ANG MO KIO TOWN CENTRE    AMSZ01 ANG MO KIO         AM NORTH-EAST REGION
170              CHENG SAN    AMSZ02 ANG MO KIO         AM NORTH-EAST REGION
163             CHONG BOON    AMSZ03 ANG MO KIO         AM NORTH-EAST REGION
330             TOWNSVILLE    AMSZ04 ANG MO KIO         AM NORTH-EAST REGION
329             SHANGRI-LA    AMSZ05 ANG MO KIO         AM NORTH-EAST REGION
172            KEBUN BAHRU    AMSZ06 ANG MO KIO         AM NORTH-EAST REGION
233        SEMBAWANG HILLS    AMSZ07 ANG MO KIO         AM NORTH-EAST REGION
254                 TAGORE    AMSZ08 ANG MO KIO         AM NORTH-EAST REGION
242      YIO CHU KANG WEST    AMSZ09 ANG MO KIO         AM NORTH-EAST REGION
252           YIO CHU KANG    AMSZ10 ANG MO KIO         AM NORTH-EAST REGION
    REGION_C                       geometry
171      NER MULTIPOLYGON (((29692.8 389...
170      NER MULTIPOLYGON (((30384.33 39...
163      NER MULTIPOLYGON (((30676.17 39...
330      NER MULTIPOLYGON (((29649.88 38...
329      NER MULTIPOLYGON (((28228.2 392...
172      NER MULTIPOLYGON (((28491.21 39...
233      NER MULTIPOLYGON (((27744.03 38...
254      NER MULTIPOLYGON (((27193.46 41...
242      NER MULTIPOLYGON (((29269.91 39...
252      NER MULTIPOLYGON (((29598.36 39...</code></pre>
</div>
</div>
<section id="computing-distance-matrix" class="level2">
<h2 class="anchored" data-anchor-id="computing-distance-matrix">Computing Distance Matrix</h2>
<p>The are at least two ways to compute the required distance matrix. One is based on sf and the other is based on sp. Past experience shows that computing distance matrix by using sf function took relatively longer time that sp method. In view of this, sp method is used in the code chunks below.</p>
<section id="converting-from-sf-data.table-to-spatialpolygondataframe" class="level3">
<h3 class="anchored" data-anchor-id="converting-from-sf-data.table-to-spatialpolygondataframe">Converting from sf data.table to SpatialPolygonDataFrame</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>mpsz_sp <span class="ot">&lt;-</span> <span class="fu">as</span>(mpsz, <span class="st">"Spatial"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="computing-the-distance-matrix" class="level3">
<h3 class="anchored" data-anchor-id="computing-the-distance-matrix">Computing the distance matrix</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>dist <span class="ot">&lt;-</span> <span class="fu">spDists</span>(mpsz_sp)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>dist </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sorting-the-distance-matrix-by-plannint-sub-zone-code" class="level3">
<h3 class="anchored" data-anchor-id="sorting-the-distance-matrix-by-plannint-sub-zone-code">Sorting the distance matrix by plannint sub-zone code</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>sz_names <span class="ot">&lt;-</span> mpsz<span class="sc">$</span>SUBZONE_C</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="attaching-subzone_c-to-row-and-column-for-distance-matrix-matching-ahead" class="level3">
<h3 class="anchored" data-anchor-id="attaching-subzone_c-to-row-and-column-for-distance-matrix-matching-ahead">Attaching SUBZONE_C to row and column for distance matrix matching ahead</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dist) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(sz_names)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(dist) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(sz_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pivoting-distance-value-by-subzone_c" class="level3">
<h3 class="anchored" data-anchor-id="pivoting-distance-value-by-subzone_c">Pivoting distance value by SUBZONE_C</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>distPair <span class="ot">&lt;-</span> <span class="fu">melt</span>(dist) <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">dist =</span> value)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(distPair, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="updating-intra-zonal-distances" class="level3">
<h3 class="anchored" data-anchor-id="updating-intra-zonal-distances">Updating intra-zonal distances</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>distPair <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(dist <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A constant distance value of 50m is added into intra-zones</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>distPair<span class="sc">$</span>dist <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(distPair<span class="sc">$</span>dist <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>                        <span class="dv">50</span>, distPair<span class="sc">$</span>dist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The code chunk below will be used to check the result data.frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>distPair <span class="sc">%&gt;%</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The code chunk below is used to rename the origin and destination fields.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>distPair <span class="ot">&lt;-</span> distPair <span class="sc">%&gt;%</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">orig =</span> Var1,</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">dest =</span> Var2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Lastly, code chunk is used to save the data frame for future use.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(distPair, <span class="st">"data/distPair.rds"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="preparing-flow-data" class="level2">
<h2 class="anchored" data-anchor-id="preparing-flow-data">Preparing flow data</h2>
<p>The code chunk below is used to prepared the flow_data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>od_data <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/od_data.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>flow_data <span class="ot">&lt;-</span> od_data <span class="sc">%&gt;%</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ORIGIN_SZ, DESTIN_SZ) <span class="sc">%&gt;%</span> </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">TRIPS =</span> <span class="fu">sum</span>(TRIPS)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The code chunk below is used to view the passenger volume df</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(flow_data, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="separating-intra-flow-from-passenger-volume-df" class="level3">
<h3 class="anchored" data-anchor-id="separating-intra-flow-from-passenger-volume-df">Separating intra-flow from passenger volume df</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>flow_data<span class="sc">$</span>FlowNoIntra <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  flow_data<span class="sc">$</span>ORIGIN_SZ <span class="sc">==</span> flow_data<span class="sc">$</span>DESTIN_SZ, </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">0</span>, flow_data<span class="sc">$</span>TRIPS)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>flow_data<span class="sc">$</span>offset <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  flow_data<span class="sc">$</span>ORIGIN_SZ <span class="sc">==</span> flow_data<span class="sc">$</span>DESTIN_SZ, </span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.000001</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="combining-passenger-volume-data-with-distance-value" class="level3">
<h3 class="anchored" data-anchor-id="combining-passenger-volume-data-with-distance-value">Combining passenger volume data with distance value</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>flow_data<span class="sc">$</span>ORIGIN_SZ <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(flow_data<span class="sc">$</span>ORIGIN_SZ)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>flow_data<span class="sc">$</span>DESTIN_SZ <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(flow_data<span class="sc">$</span>DESTIN_SZ)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>flow_data1 <span class="ot">&lt;-</span> flow_data <span class="sc">%&gt;%</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span> (distPair,</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"ORIGIN_SZ"</span> <span class="ot">=</span> <span class="st">"orig"</span>,</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"DESTIN_SZ"</span> <span class="ot">=</span> <span class="st">"dest"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="visualising-spatial-interaction" class="level2">
<h2 class="anchored" data-anchor-id="visualising-spatial-interaction">Visualising Spatial Interaction</h2>
<p>In this section, you will learn how to prepare a desire line by using <strong>stplanr</strong> package.</p>
<section id="removing-intra-zonal-flows" class="level3">
<h3 class="anchored" data-anchor-id="removing-intra-zonal-flows">Removing intra-zonal flows</h3>
<p>We will not plot the intra-zonal flows. The code chunk below will be used to remove intra-zonal flows.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>flow_data1 <span class="ot">&lt;-</span> flow_data1[flow_data1<span class="sc">$</span>ORIGIN_SZ<span class="sc">!=</span>flow_data1<span class="sc">$</span>DESTIN_SZ,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The code chunk below removes all but the origin, destination and flow columns.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>OD_data <span class="ot">&lt;-</span> flow_data1[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="creating-desire-lines" class="level3">
<h3 class="anchored" data-anchor-id="creating-desire-lines">Creating desire lines</h3>
<p>In this code chunk below, <code>od2line()</code> of <strong>stplanr</strong> package is used to create the desire lines.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>flowLine <span class="ot">&lt;-</span> <span class="fu">od2line</span>(<span class="at">flow =</span> OD_data, </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">zones =</span> mpsz,</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">zone_code =</span> <span class="st">"SUBZONE_C"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="visualising-the-desire-lines" class="level3">
<h3 class="anchored" data-anchor-id="visualising-the-desire-lines">Visualising the desire lines</h3>
<p>To visualise the resulting desire lines, the code chunk below is used.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz) <span class="sc">+</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(flowLine) <span class="sc">+</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">lwd =</span> <span class="st">"TRIPS"</span>,</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">style =</span> <span class="st">"quantile"</span>,</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">scale =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">10</span>),</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout-warning callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Be patient, the rendering process takes more time because of the transparency argument (i.e.&nbsp;alpha)</p>
</div>
</div>
</section>
</section>
<section id="preparing-origin-and-destination-attributes" class="level2">
<h2 class="anchored" data-anchor-id="preparing-origin-and-destination-attributes">Preparing Origin and Destination Attributes</h2>
<section id="importing-population-data" class="level3">
<h3 class="anchored" data-anchor-id="importing-population-data">Importing population data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>pop <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/pop.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="geospatial-data-wrangling-1" class="level3">
<h3 class="anchored" data-anchor-id="geospatial-data-wrangling-1">Geospatial data wrangling</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>pop <span class="ot">&lt;-</span> pop <span class="sc">%&gt;%</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mpsz,</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"PA"</span> <span class="ot">=</span> <span class="st">"PLN_AREA_N"</span>,</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"SZ"</span> <span class="ot">=</span> <span class="st">"SUBZONE_N"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">SZ_NAME =</span> SZ,</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">SZ =</span> SUBZONE_C)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="preparing-origin-attribute" class="level3">
<h3 class="anchored" data-anchor-id="preparing-origin-attribute">Preparing origin attribute</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>flow_data1 <span class="ot">&lt;-</span> flow_data1 <span class="sc">%&gt;%</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(pop,</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="at">ORIGIN_SZ =</span> <span class="st">"SZ"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">ORIGIN_AGE7_12 =</span> AGE7_12,</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">ORIGIN_AGE13_24 =</span> AGE13_24,</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">ORIGIN_AGE25_64 =</span> AGE25_64) <span class="sc">%&gt;%</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(PA, SZ_NAME))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="preparing-destination-attribute" class="level3">
<h3 class="anchored" data-anchor-id="preparing-destination-attribute">Preparing destination attribute</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>flow_data1 <span class="ot">&lt;-</span> flow_data1 <span class="sc">%&gt;%</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(pop,</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="at">DESTIN_SZ =</span> <span class="st">"SZ"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">DESTIN_AGE7_12 =</span> AGE7_12,</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">DESTIN_AGE13_24 =</span> AGE13_24,</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">DESTIN_AGE25_64 =</span> AGE25_64) <span class="sc">%&gt;%</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(PA, SZ_NAME))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(flow_data1, <span class="st">"data/rds/SIM_data"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="calibrating-spatial-interaction-models" class="level2">
<h2 class="anchored" data-anchor-id="calibrating-spatial-interaction-models">Calibrating Spatial Interaction Models</h2>
<p>In this section, you will learn how to calibrate Spatial Interaction Models by using Poisson Regression method.</p>
<section id="importing-the-modelling-data" class="level3">
<h3 class="anchored" data-anchor-id="importing-the-modelling-data">Importing the modelling data</h3>
<p>Firstly, let us import the modelling data by using the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>SIM_data <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/SIM_data"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="checking-for-variables-with-zero-values" class="level3">
<h3 class="anchored" data-anchor-id="checking-for-variables-with-zero-values">Checking for variables with zero values</h3>
<p>Since Poisson Regression is based of log and log 0 is undefined, it is important for us to ensure that no 0 values in the explanatory variables.</p>
<p>In the code chunk below, summary() of Base R is used to compute the summary statistics of all variables in <em>SIM_data</em> data frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SIM_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  ORIGIN_SZ          DESTIN_SZ             TRIPS           FlowNoIntra      
 Length:14274       Length:14274       Min.   :     1.0   Min.   :     1.0  
 Class :character   Class :character   1st Qu.:    11.0   1st Qu.:    11.0  
 Mode  :character   Mode  :character   Median :    56.0   Median :    56.0  
                                       Mean   :   664.3   Mean   :   664.3  
                                       3rd Qu.:   296.0   3rd Qu.:   296.0  
                                       Max.   :104167.0   Max.   :104167.0  
     offset       dist         ORIGIN_AGE7_12 ORIGIN_AGE13_24 ORIGIN_AGE25_64
 Min.   :1   Min.   :  173.8   Min.   :   0   Min.   :    0   Min.   :    0  
 1st Qu.:1   1st Qu.: 3465.4   1st Qu.: 240   1st Qu.:  460   1st Qu.: 2210  
 Median :1   Median : 6121.0   Median : 710   Median : 1400   Median : 7030  
 Mean   :1   Mean   : 6951.8   Mean   :1037   Mean   : 2278   Mean   :10536  
 3rd Qu.:1   3rd Qu.: 9725.1   3rd Qu.:1500   3rd Qu.: 3282   3rd Qu.:15830  
 Max.   :1   Max.   :26135.8   Max.   :6340   Max.   :16380   Max.   :74610  
 DESTIN_AGE7_12 DESTIN_AGE13_24 DESTIN_AGE25_64
 Min.   :   0   Min.   :    0   Min.   :    0  
 1st Qu.: 250   1st Qu.:  460   1st Qu.: 2210  
 Median : 720   Median : 1430   Median : 7120  
 Mean   :1040   Mean   : 2305   Mean   :10648  
 3rd Qu.:1500   3rd Qu.: 3290   3rd Qu.:15830  
 Max.   :6340   Max.   :16380   Max.   :74610  </code></pre>
</div>
</div>
<p>The print report above reveals that variables ORIGIN_AGE7_12, ORIGIN_AGE13_24, ORIGIN_AGE25_64,DESTIN_AGE7_12, DESTIN_AGE13_24, DESTIN_AGE25_64 consist of 0 values.</p>
<p>In view of this, code chunk below will be used to replace zero values to 0.99.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>SIM_data<span class="sc">$</span>DESTIN_AGE7_12 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  SIM_data<span class="sc">$</span>DESTIN_AGE7_12 <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, SIM_data<span class="sc">$</span>DESTIN_AGE7_12)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>SIM_data<span class="sc">$</span>DESTIN_AGE13_24 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  SIM_data<span class="sc">$</span>DESTIN_AGE13_24 <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, SIM_data<span class="sc">$</span>DESTIN_AGE13_24)</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>SIM_data<span class="sc">$</span>DESTIN_AGE25_64 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  SIM_data<span class="sc">$</span>DESTIN_AGE25_64 <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, SIM_data<span class="sc">$</span>DESTIN_AGE25_64)</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>SIM_data<span class="sc">$</span>ORIGIN_AGE7_12 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>  SIM_data<span class="sc">$</span>ORIGIN_AGE7_12 <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, SIM_data<span class="sc">$</span>ORIGIN_AGE7_12)</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>SIM_data<span class="sc">$</span>ORIGIN_AGE13_24 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>  SIM_data<span class="sc">$</span>ORIGIN_AGE13_24 <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, SIM_data<span class="sc">$</span>ORIGIN_AGE13_24)</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>SIM_data<span class="sc">$</span>ORIGIN_AGE25_64 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>  SIM_data<span class="sc">$</span>ORIGIN_AGE25_64 <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, SIM_data<span class="sc">$</span>ORIGIN_AGE25_64)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can run the summary() again.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SIM_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  ORIGIN_SZ          DESTIN_SZ             TRIPS           FlowNoIntra      
 Length:14274       Length:14274       Min.   :     1.0   Min.   :     1.0  
 Class :character   Class :character   1st Qu.:    11.0   1st Qu.:    11.0  
 Mode  :character   Mode  :character   Median :    56.0   Median :    56.0  
                                       Mean   :   664.3   Mean   :   664.3  
                                       3rd Qu.:   296.0   3rd Qu.:   296.0  
                                       Max.   :104167.0   Max.   :104167.0  
     offset       dist         ORIGIN_AGE7_12    ORIGIN_AGE13_24   
 Min.   :1   Min.   :  173.8   Min.   :   0.99   Min.   :    0.99  
 1st Qu.:1   1st Qu.: 3465.4   1st Qu.: 240.00   1st Qu.:  460.00  
 Median :1   Median : 6121.0   Median : 710.00   Median : 1400.00  
 Mean   :1   Mean   : 6951.8   Mean   :1036.73   Mean   : 2278.59  
 3rd Qu.:1   3rd Qu.: 9725.1   3rd Qu.:1500.00   3rd Qu.: 3282.50  
 Max.   :1   Max.   :26135.8   Max.   :6340.00   Max.   :16380.00  
 ORIGIN_AGE25_64    DESTIN_AGE7_12    DESTIN_AGE13_24    DESTIN_AGE25_64   
 Min.   :    0.99   Min.   :   0.99   Min.   :    0.99   Min.   :    0.99  
 1st Qu.: 2210.00   1st Qu.: 250.00   1st Qu.:  460.00   1st Qu.: 2210.00  
 Median : 7030.00   Median : 720.00   Median : 1430.00   Median : 7120.00  
 Mean   :10535.93   Mean   :1039.98   Mean   : 2305.33   Mean   :10647.95  
 3rd Qu.:15830.00   3rd Qu.:1500.00   3rd Qu.: 3290.00   3rd Qu.:15830.00  
 Max.   :74610.00   Max.   :6340.00   Max.   :16380.00   Max.   :74610.00  </code></pre>
</div>
</div>
<p>Notice that all the 0 values have been replaced by 0.99.</p>
</section>
<section id="unconstrained-spatial-interaction-model" class="level3">
<h3 class="anchored" data-anchor-id="unconstrained-spatial-interaction-model">Unconstrained Spatial Interaction Model</h3>
<p>In this section, you will learn how to calibrate an unconstrained spatial interaction model by using <code>glm()</code> of Base Stats. The explanatory variables are origin population by different age cohort, destination population by different age cohort (i.e.&nbsp;wj3_destmedinc) and distance between origin and destination in km (i.e.&nbsp;dist).</p>
<p>The code chunk used to calibrate to model is shown below:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>uncSIM <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> TRIPS <span class="sc">~</span> <span class="fu">log</span>(dist),</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> SIM_data,</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">na.action =</span> na.exclude)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>uncSIM</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:  glm(formula = TRIPS ~ log(dist), family = poisson(link = "log"), 
    data = SIM_data, na.action = na.exclude)

Coefficients:
(Intercept)    log(dist)  
     18.514       -1.474  

Degrees of Freedom: 14273 Total (i.e. Null);  14272 Residual
Null Deviance:      36120000 
Residual Deviance: 22090000     AIC: 22170000</code></pre>
</div>
</div>
</section>
<section id="r-squared-function" class="level3">
<h3 class="anchored" data-anchor-id="r-squared-function">R-squared function</h3>
<p>In order to measure how much variation of the trips can be accounted by the model we will write a function to calculate R-Squared value as shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>CalcRSquared <span class="ot">&lt;-</span> <span class="cf">function</span>(observed,estimated){</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">cor</span>(observed,estimated)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  R2 <span class="ot">&lt;-</span> r<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  R2</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we will compute the R-squared of the unconstrained SIM by using the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CalcRSquared</span>(uncSIM<span class="sc">$</span>data<span class="sc">$</span>TRIPS, uncSIM<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.09503493</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">r2_mcfadden</span>(uncSIM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># R2 for Generalized Linear Regression
       R2: 0.388
  adj. R2: 0.388</code></pre>
</div>
</div>
</section>
<section id="origin-production-constrained-sim" class="level3">
<h3 class="anchored" data-anchor-id="origin-production-constrained-sim">Origin (Production) constrained SIM</h3>
<p>In this section, we will fit an origin constrained SIM by using the code3 chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>orcSIM0 <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> TRIPS <span class="sc">~</span> ORIGIN_SZ <span class="sc">+</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">log</span>(dist),</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> SIM_data,</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">na.action =</span> na.exclude)</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(orcSIM0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = TRIPS ~ ORIGIN_SZ + log(dist), family = poisson(link = "log"), 
    data = SIM_data, na.action = na.exclude)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-258.53   -16.14    -7.46     0.83   419.71  

Coefficients:
                  Estimate Std. Error   z value Pr(&gt;|z|)    
(Intercept)     20.2005805  0.0053269  3792.185  &lt; 2e-16 ***
ORIGIN_SZAMSZ02  0.6726970  0.0052686   127.681  &lt; 2e-16 ***
ORIGIN_SZAMSZ03  0.3648277  0.0054884    66.473  &lt; 2e-16 ***
ORIGIN_SZAMSZ04 -0.1022828  0.0060026   -17.040  &lt; 2e-16 ***
ORIGIN_SZAMSZ05 -0.3085178  0.0067998   -45.372  &lt; 2e-16 ***
ORIGIN_SZAMSZ06  0.0567919  0.0060258     9.425  &lt; 2e-16 ***
ORIGIN_SZAMSZ07 -1.1372311  0.0110298  -103.105  &lt; 2e-16 ***
ORIGIN_SZAMSZ08 -0.6610431  0.0102944   -64.214  &lt; 2e-16 ***
ORIGIN_SZAMSZ09  0.0663246  0.0063437    10.455  &lt; 2e-16 ***
ORIGIN_SZAMSZ10  0.4819850  0.0053883    89.451  &lt; 2e-16 ***
ORIGIN_SZAMSZ11 -1.3809014  0.0144850   -95.333  &lt; 2e-16 ***
ORIGIN_SZAMSZ12 -1.5341976  0.0127449  -120.377  &lt; 2e-16 ***
ORIGIN_SZBDSZ01  1.3755022  0.0051431   267.446  &lt; 2e-16 ***
ORIGIN_SZBDSZ02  0.9635755  0.0059654   161.527  &lt; 2e-16 ***
ORIGIN_SZBDSZ03  1.1802071  0.0054268   217.477  &lt; 2e-16 ***
ORIGIN_SZBDSZ04  2.0245844  0.0046346   436.845  &lt; 2e-16 ***
ORIGIN_SZBDSZ05  1.0794387  0.0053975   199.987  &lt; 2e-16 ***
ORIGIN_SZBDSZ06  1.2925765  0.0054770   235.999  &lt; 2e-16 ***
ORIGIN_SZBDSZ07 -0.4854590  0.0111553   -43.518  &lt; 2e-16 ***
ORIGIN_SZBDSZ08 -0.3216072  0.0102943   -31.241  &lt; 2e-16 ***
ORIGIN_SZBKSZ01 -0.3453783  0.0075472   -45.763  &lt; 2e-16 ***
ORIGIN_SZBKSZ02  0.1248816  0.0061394    20.341  &lt; 2e-16 ***
ORIGIN_SZBKSZ03  0.4133704  0.0058983    70.083  &lt; 2e-16 ***
ORIGIN_SZBKSZ04 -0.3223399  0.0070761   -45.553  &lt; 2e-16 ***
ORIGIN_SZBKSZ05 -0.2946179  0.0074073   -39.774  &lt; 2e-16 ***
ORIGIN_SZBKSZ06 -0.2563882  0.0068739   -37.299  &lt; 2e-16 ***
ORIGIN_SZBKSZ07  0.5504786  0.0051476   106.939  &lt; 2e-16 ***
ORIGIN_SZBKSZ08 -0.0445955  0.0061456    -7.256 3.97e-13 ***
ORIGIN_SZBKSZ09 -0.1778689  0.0067296   -26.431  &lt; 2e-16 ***
ORIGIN_SZBLSZ01 -1.9094577  0.0176521  -108.172  &lt; 2e-16 ***
ORIGIN_SZBLSZ02 -2.1274141  0.0213770   -99.519  &lt; 2e-16 ***
ORIGIN_SZBLSZ03 -3.1266861  0.0535678   -58.369  &lt; 2e-16 ***
ORIGIN_SZBLSZ04 -1.6929155  0.0254564   -66.503  &lt; 2e-16 ***
ORIGIN_SZBMSZ01  0.1616399  0.0060559    26.691  &lt; 2e-16 ***
ORIGIN_SZBMSZ02 -1.4095082  0.0078243  -180.145  &lt; 2e-16 ***
ORIGIN_SZBMSZ03 -0.6104379  0.0063806   -95.671  &lt; 2e-16 ***
ORIGIN_SZBMSZ04 -0.5631319  0.0059057   -95.354  &lt; 2e-16 ***
ORIGIN_SZBMSZ05 -3.1099409  0.0188118  -165.319  &lt; 2e-16 ***
ORIGIN_SZBMSZ06 -3.0245343  0.0194320  -155.647  &lt; 2e-16 ***
ORIGIN_SZBMSZ07 -0.7545268  0.0066862  -112.849  &lt; 2e-16 ***
ORIGIN_SZBMSZ08 -0.9437549  0.0067186  -140.470  &lt; 2e-16 ***
ORIGIN_SZBMSZ09 -1.4113373  0.0101071  -139.639  &lt; 2e-16 ***
ORIGIN_SZBMSZ10 -1.7194808  0.0101580  -169.273  &lt; 2e-16 ***
ORIGIN_SZBMSZ11 -1.2653719  0.0076788  -164.787  &lt; 2e-16 ***
ORIGIN_SZBMSZ12 -1.3836282  0.0109769  -126.050  &lt; 2e-16 ***
ORIGIN_SZBMSZ13 -0.4562384  0.0069330   -65.806  &lt; 2e-16 ***
ORIGIN_SZBMSZ14 -1.0107166  0.0076300  -132.466  &lt; 2e-16 ***
ORIGIN_SZBMSZ15 -0.6732245  0.0068962   -97.623  &lt; 2e-16 ***
ORIGIN_SZBMSZ16 -1.5932145  0.0105301  -151.301  &lt; 2e-16 ***
ORIGIN_SZBMSZ17 -1.6690377  0.0180671   -92.380  &lt; 2e-16 ***
ORIGIN_SZBPSZ01  0.1777519  0.0064727    27.462  &lt; 2e-16 ***
ORIGIN_SZBPSZ02 -0.3284577  0.0073896   -44.449  &lt; 2e-16 ***
ORIGIN_SZBPSZ03 -0.1258805  0.0072220   -17.430  &lt; 2e-16 ***
ORIGIN_SZBPSZ04  0.4643807  0.0058416    79.495  &lt; 2e-16 ***
ORIGIN_SZBPSZ05  0.5120682  0.0053682    95.390  &lt; 2e-16 ***
ORIGIN_SZBPSZ06 -0.9931433  0.0105636   -94.015  &lt; 2e-16 ***
ORIGIN_SZBPSZ07 -0.3928510  0.0098561   -39.859  &lt; 2e-16 ***
ORIGIN_SZBSSZ01  0.1457767  0.0065505    22.254  &lt; 2e-16 ***
ORIGIN_SZBSSZ02  0.4368915  0.0055892    78.166  &lt; 2e-16 ***
ORIGIN_SZBSSZ03 -0.2368000  0.0062020   -38.181  &lt; 2e-16 ***
ORIGIN_SZBTSZ01  0.1951168  0.0066669    29.266  &lt; 2e-16 ***
ORIGIN_SZBTSZ02 -0.4614877  0.0090782   -50.835  &lt; 2e-16 ***
ORIGIN_SZBTSZ03 -0.2826570  0.0077937   -36.267  &lt; 2e-16 ***
ORIGIN_SZBTSZ04 -1.1588974  0.0115211  -100.589  &lt; 2e-16 ***
ORIGIN_SZBTSZ05 -1.0085445  0.0132592   -76.064  &lt; 2e-16 ***
ORIGIN_SZBTSZ06 -1.0887338  0.0102241  -106.487  &lt; 2e-16 ***
ORIGIN_SZBTSZ07 -2.3187184  0.0158499  -146.292  &lt; 2e-16 ***
ORIGIN_SZBTSZ08 -1.1612098  0.0121160   -95.841  &lt; 2e-16 ***
ORIGIN_SZCBSZ01 -1.1866290  0.0577816   -20.536  &lt; 2e-16 ***
ORIGIN_SZCCSZ01 -0.8116425  0.0152637   -53.175  &lt; 2e-16 ***
ORIGIN_SZCHSZ01  0.0504281  0.0133237     3.785 0.000154 ***
ORIGIN_SZCHSZ02 -0.6360464  0.0096388   -65.988  &lt; 2e-16 ***
ORIGIN_SZCHSZ03  1.6691131  0.0069550   239.988  &lt; 2e-16 ***
ORIGIN_SZCKSZ01  0.0939593  0.0059933    15.677  &lt; 2e-16 ***
ORIGIN_SZCKSZ02  0.4436501  0.0062289    71.225  &lt; 2e-16 ***
ORIGIN_SZCKSZ03  0.8047754  0.0051891   155.088  &lt; 2e-16 ***
ORIGIN_SZCKSZ04  1.2618796  0.0053164   237.354  &lt; 2e-16 ***
ORIGIN_SZCKSZ05  0.9539941  0.0061802   154.362  &lt; 2e-16 ***
ORIGIN_SZCKSZ06  0.3985787  0.0085639    46.542  &lt; 2e-16 ***
ORIGIN_SZCLSZ01 -0.7460360  0.0094655   -78.816  &lt; 2e-16 ***
ORIGIN_SZCLSZ02 -1.3874882  0.0153260   -90.532  &lt; 2e-16 ***
ORIGIN_SZCLSZ03 -0.8305576  0.0091003   -91.267  &lt; 2e-16 ***
ORIGIN_SZCLSZ04  0.8270184  0.0051253   161.361  &lt; 2e-16 ***
ORIGIN_SZCLSZ05 -1.6669714  0.0166091  -100.365  &lt; 2e-16 ***
ORIGIN_SZCLSZ06  0.9123924  0.0048167   189.424  &lt; 2e-16 ***
ORIGIN_SZCLSZ07 -0.2861844  0.0064620   -44.287  &lt; 2e-16 ***
ORIGIN_SZCLSZ08  0.1054195  0.0069288    15.215  &lt; 2e-16 ***
ORIGIN_SZCLSZ09 -1.4033271  0.0192743   -72.808  &lt; 2e-16 ***
ORIGIN_SZDTSZ02 -3.7790771  0.0871323   -43.372  &lt; 2e-16 ***
ORIGIN_SZDTSZ03 -3.8603548  0.0840155   -45.948  &lt; 2e-16 ***
ORIGIN_SZDTSZ13 -3.0395604  0.0349232   -87.036  &lt; 2e-16 ***
ORIGIN_SZGLSZ01 -1.5046012  0.0110135  -136.615  &lt; 2e-16 ***
ORIGIN_SZGLSZ02  0.2253927  0.0058737    38.373  &lt; 2e-16 ***
ORIGIN_SZGLSZ03  0.1838412  0.0061988    29.658  &lt; 2e-16 ***
ORIGIN_SZGLSZ04  1.0155562  0.0049023   207.161  &lt; 2e-16 ***
ORIGIN_SZGLSZ05  0.9835979  0.0050898   193.249  &lt; 2e-16 ***
ORIGIN_SZHGSZ01  0.3092405  0.0054307    56.943  &lt; 2e-16 ***
ORIGIN_SZHGSZ02  0.3437757  0.0054544    63.028  &lt; 2e-16 ***
ORIGIN_SZHGSZ03  0.2532037  0.0059237    42.744  &lt; 2e-16 ***
ORIGIN_SZHGSZ04  0.8778350  0.0049639   176.844  &lt; 2e-16 ***
ORIGIN_SZHGSZ05  1.1787319  0.0049467   238.284  &lt; 2e-16 ***
ORIGIN_SZHGSZ06 -0.0285657  0.0063802    -4.477 7.56e-06 ***
ORIGIN_SZHGSZ07  0.4366275  0.0055136    79.191  &lt; 2e-16 ***
ORIGIN_SZHGSZ08  0.2047214  0.0061274    33.411  &lt; 2e-16 ***
ORIGIN_SZHGSZ09 -1.8264899  0.0084243  -216.813  &lt; 2e-16 ***
ORIGIN_SZHGSZ10 -3.1689875  0.0501002   -63.253  &lt; 2e-16 ***
ORIGIN_SZJESZ01  0.3467544  0.0056248    61.648  &lt; 2e-16 ***
ORIGIN_SZJESZ02  0.0931648  0.0056855    16.386  &lt; 2e-16 ***
ORIGIN_SZJESZ03 -0.0133318  0.0061011    -2.185 0.028879 *  
ORIGIN_SZJESZ04 -1.3989245  0.0117178  -119.385  &lt; 2e-16 ***
ORIGIN_SZJESZ05 -2.1115477  0.0157074  -134.430  &lt; 2e-16 ***
ORIGIN_SZJESZ06  0.0913367  0.0055205    16.545  &lt; 2e-16 ***
ORIGIN_SZJESZ07 -1.7832364  0.0133169  -133.908  &lt; 2e-16 ***
ORIGIN_SZJESZ08 -1.0182049  0.0138155   -73.700  &lt; 2e-16 ***
ORIGIN_SZJESZ09  0.5241815  0.0060303    86.925  &lt; 2e-16 ***
ORIGIN_SZJESZ10 -1.3152629  0.0233178   -56.406  &lt; 2e-16 ***
ORIGIN_SZJESZ11 -1.5019583  0.0220899   -67.993  &lt; 2e-16 ***
ORIGIN_SZJWSZ01  0.5998779  0.0077737    77.168  &lt; 2e-16 ***
ORIGIN_SZJWSZ02  0.9414224  0.0053016   177.572  &lt; 2e-16 ***
ORIGIN_SZJWSZ03  1.2795649  0.0049046   260.893  &lt; 2e-16 ***
ORIGIN_SZJWSZ04  0.4716268  0.0057749    81.668  &lt; 2e-16 ***
ORIGIN_SZJWSZ05 -1.6259199  0.0146895  -110.686  &lt; 2e-16 ***
ORIGIN_SZJWSZ06 -0.9848862  0.0126892   -77.616  &lt; 2e-16 ***
ORIGIN_SZJWSZ07 -2.3794136  0.0357836   -66.495  &lt; 2e-16 ***
ORIGIN_SZJWSZ08  1.9348365  0.0047892   403.999  &lt; 2e-16 ***
ORIGIN_SZJWSZ09  1.8253414  0.0045170   404.109  &lt; 2e-16 ***
ORIGIN_SZKLSZ01  0.2563989  0.0056902    45.060  &lt; 2e-16 ***
ORIGIN_SZKLSZ02 -0.6791494  0.0074514   -91.144  &lt; 2e-16 ***
ORIGIN_SZKLSZ03 -0.4298685  0.0067206   -63.963  &lt; 2e-16 ***
ORIGIN_SZKLSZ04 -2.1711552  0.0138400  -156.875  &lt; 2e-16 ***
ORIGIN_SZKLSZ05 -1.1387866  0.0121500   -93.727  &lt; 2e-16 ***
ORIGIN_SZKLSZ06 -5.8058298  0.1857394   -31.258  &lt; 2e-16 ***
ORIGIN_SZKLSZ07 -1.1997901  0.0096830  -123.907  &lt; 2e-16 ***
ORIGIN_SZKLSZ08 -1.6985192  0.0114317  -148.580  &lt; 2e-16 ***
ORIGIN_SZLKSZ01 -1.7811971  0.0446401   -39.901  &lt; 2e-16 ***
ORIGIN_SZMDSZ01 -1.2268600  0.0318811   -38.482  &lt; 2e-16 ***
ORIGIN_SZMDSZ02 -0.5250822  0.0116644   -45.016  &lt; 2e-16 ***
ORIGIN_SZMDSZ03 -1.9199768  0.0198291   -96.826  &lt; 2e-16 ***
ORIGIN_SZMPSZ01 -0.5270361  0.0094201   -55.948  &lt; 2e-16 ***
ORIGIN_SZMPSZ02 -0.2710134  0.0077972   -34.758  &lt; 2e-16 ***
ORIGIN_SZMPSZ03  0.3415676  0.0063715    53.609  &lt; 2e-16 ***
ORIGIN_SZMUSZ02 -3.8131508  0.1105053   -34.506  &lt; 2e-16 ***
ORIGIN_SZNTSZ01 -2.9810768  0.0397028   -75.085  &lt; 2e-16 ***
ORIGIN_SZNTSZ02 -3.2242118  0.0249466  -129.245  &lt; 2e-16 ***
ORIGIN_SZNTSZ03 -0.9992892  0.0085420  -116.985  &lt; 2e-16 ***
ORIGIN_SZNTSZ05 -4.2962543  0.0579730   -74.108  &lt; 2e-16 ***
ORIGIN_SZNTSZ06 -4.6409947  0.0583481   -79.540  &lt; 2e-16 ***
ORIGIN_SZNVSZ01  0.3145540  0.0052943    59.413  &lt; 2e-16 ***
ORIGIN_SZNVSZ02 -0.5543580  0.0073741   -75.176  &lt; 2e-16 ***
ORIGIN_SZNVSZ03 -1.0013848  0.0090557  -110.580  &lt; 2e-16 ***
ORIGIN_SZNVSZ04 -0.8333043  0.0099587   -83.676  &lt; 2e-16 ***
ORIGIN_SZNVSZ05 -2.1373486  0.0182401  -117.179  &lt; 2e-16 ***
ORIGIN_SZPGSZ01 -0.5147486  0.0151509   -33.975  &lt; 2e-16 ***
ORIGIN_SZPGSZ02 -0.3681355  0.0085127   -43.245  &lt; 2e-16 ***
ORIGIN_SZPGSZ03  0.7227031  0.0055527   130.153  &lt; 2e-16 ***
ORIGIN_SZPGSZ04  1.2482068  0.0051069   244.416  &lt; 2e-16 ***
ORIGIN_SZPGSZ05  0.4209311  0.0069842    60.269  &lt; 2e-16 ***
ORIGIN_SZPLSZ01 -0.5563754  0.0134472   -41.375  &lt; 2e-16 ***
ORIGIN_SZPLSZ02 -1.0808639  0.0172304   -62.730  &lt; 2e-16 ***
ORIGIN_SZPLSZ03 -1.8383936  0.0472605   -38.899  &lt; 2e-16 ***
ORIGIN_SZPLSZ04 -2.2456989  0.0373577   -60.113  &lt; 2e-16 ***
ORIGIN_SZPLSZ05 -1.7355343  0.0260917   -66.517  &lt; 2e-16 ***
ORIGIN_SZPNSZ01  1.3460904  0.0054727   245.964  &lt; 2e-16 ***
ORIGIN_SZPNSZ02  0.5018834  0.0127510    39.360  &lt; 2e-16 ***
ORIGIN_SZPNSZ03 -1.5880997  0.0216035   -73.511  &lt; 2e-16 ***
ORIGIN_SZPNSZ04 -2.2470613  0.0360547   -62.324  &lt; 2e-16 ***
ORIGIN_SZPNSZ05 -1.1595518  0.0320834   -36.142  &lt; 2e-16 ***
ORIGIN_SZPRSZ01  0.0716523  0.0139141     5.150 2.61e-07 ***
ORIGIN_SZPRSZ02  1.2869331  0.0053802   239.196  &lt; 2e-16 ***
ORIGIN_SZPRSZ03  1.0118036  0.0054290   186.369  &lt; 2e-16 ***
ORIGIN_SZPRSZ04 -0.0219072  0.0088010    -2.489 0.012804 *  
ORIGIN_SZPRSZ05  1.6793693  0.0050837   330.346  &lt; 2e-16 ***
ORIGIN_SZPRSZ06 -0.8423620  0.0131295   -64.158  &lt; 2e-16 ***
ORIGIN_SZPRSZ07 -2.2135050  0.0177358  -124.804  &lt; 2e-16 ***
ORIGIN_SZPRSZ08  0.4531685  0.0072609    62.412  &lt; 2e-16 ***
ORIGIN_SZQTSZ01 -0.3620954  0.0078769   -45.970  &lt; 2e-16 ***
ORIGIN_SZQTSZ02 -0.8329377  0.0071542  -116.426  &lt; 2e-16 ***
ORIGIN_SZQTSZ03 -0.2496311  0.0065554   -38.080  &lt; 2e-16 ***
ORIGIN_SZQTSZ04 -1.2371956  0.0084049  -147.200  &lt; 2e-16 ***
ORIGIN_SZQTSZ05 -0.7308655  0.0072359  -101.005  &lt; 2e-16 ***
ORIGIN_SZQTSZ06 -0.6700293  0.0076658   -87.405  &lt; 2e-16 ***
ORIGIN_SZQTSZ07 -1.4503496  0.0109364  -132.616  &lt; 2e-16 ***
ORIGIN_SZQTSZ08 -0.3090784  0.0070183   -44.039  &lt; 2e-16 ***
ORIGIN_SZQTSZ09 -0.6239414  0.0078738   -79.243  &lt; 2e-16 ***
ORIGIN_SZQTSZ10 -0.3764000  0.0075434   -49.898  &lt; 2e-16 ***
ORIGIN_SZQTSZ11 -1.9806135  0.0151246  -130.953  &lt; 2e-16 ***
ORIGIN_SZQTSZ12 -2.6832037  0.0205853  -130.346  &lt; 2e-16 ***
ORIGIN_SZQTSZ13 -0.4464148  0.0088394   -50.503  &lt; 2e-16 ***
ORIGIN_SZQTSZ14 -1.7125156  0.0134361  -127.457  &lt; 2e-16 ***
ORIGIN_SZQTSZ15 -0.3833753  0.0131948   -29.055  &lt; 2e-16 ***
ORIGIN_SZRCSZ01 -1.7175411  0.0141179  -121.657  &lt; 2e-16 ***
ORIGIN_SZRCSZ06 -1.2241770  0.0094858  -129.054  &lt; 2e-16 ***
ORIGIN_SZRVSZ01 -3.0502614  0.0339692   -89.795  &lt; 2e-16 ***
ORIGIN_SZRVSZ02 -3.6240634  0.0297640  -121.760  &lt; 2e-16 ***
ORIGIN_SZRVSZ03 -3.2572237  0.0259148  -125.690  &lt; 2e-16 ***
ORIGIN_SZRVSZ04 -3.7798646  0.0575900   -65.634  &lt; 2e-16 ***
ORIGIN_SZRVSZ05 -2.9657451  0.0178584  -166.070  &lt; 2e-16 ***
ORIGIN_SZSBSZ01  0.0484242  0.0078560     6.164 7.09e-10 ***
ORIGIN_SZSBSZ02 -0.5693475  0.0093053   -61.185  &lt; 2e-16 ***
ORIGIN_SZSBSZ03  0.8710065  0.0054580   159.583  &lt; 2e-16 ***
ORIGIN_SZSBSZ04  0.7702307  0.0061845   124.542  &lt; 2e-16 ***
ORIGIN_SZSBSZ05 -0.1570793  0.0078341   -20.051  &lt; 2e-16 ***
ORIGIN_SZSBSZ06 -1.1187512  0.0196419   -56.957  &lt; 2e-16 ***
ORIGIN_SZSBSZ07 -0.8702492  0.0160708   -54.151  &lt; 2e-16 ***
ORIGIN_SZSBSZ08 -1.2444209  0.0174533   -71.300  &lt; 2e-16 ***
ORIGIN_SZSBSZ09 -0.6083768  0.0101960   -59.668  &lt; 2e-16 ***
ORIGIN_SZSESZ02  1.1480617  0.0050937   225.390  &lt; 2e-16 ***
ORIGIN_SZSESZ03  1.1332035  0.0049018   231.183  &lt; 2e-16 ***
ORIGIN_SZSESZ04  0.7626907  0.0056944   133.937  &lt; 2e-16 ***
ORIGIN_SZSESZ05 -0.2538087  0.0069590   -36.472  &lt; 2e-16 ***
ORIGIN_SZSESZ06  0.8046502  0.0055795   144.214  &lt; 2e-16 ***
ORIGIN_SZSESZ07 -2.2884152  0.0231232   -98.966  &lt; 2e-16 ***
ORIGIN_SZSGSZ01 -0.7263478  0.0098956   -73.401  &lt; 2e-16 ***
ORIGIN_SZSGSZ02 -1.0955256  0.0110917   -98.770  &lt; 2e-16 ***
ORIGIN_SZSGSZ03  0.1720514  0.0060507    28.435  &lt; 2e-16 ***
ORIGIN_SZSGSZ04  0.3876535  0.0056164    69.021  &lt; 2e-16 ***
ORIGIN_SZSGSZ05 -1.7081284  0.0118944  -143.607  &lt; 2e-16 ***
ORIGIN_SZSGSZ06  0.4634813  0.0052885    87.640  &lt; 2e-16 ***
ORIGIN_SZSGSZ07 -0.7267953  0.0073129   -99.386  &lt; 2e-16 ***
ORIGIN_SZSKSZ01  0.1031931  0.0100646    10.253  &lt; 2e-16 ***
ORIGIN_SZSKSZ02  1.1409565  0.0063341   180.130  &lt; 2e-16 ***
ORIGIN_SZSKSZ03 -0.3304290  0.0096784   -34.141  &lt; 2e-16 ***
ORIGIN_SZSKSZ04 -1.9419108  0.0359190   -54.064  &lt; 2e-16 ***
ORIGIN_SZSKSZ05 -0.5658728  0.0176571   -32.048  &lt; 2e-16 ***
ORIGIN_SZSLSZ01 -2.6009009  0.0348000   -74.738  &lt; 2e-16 ***
ORIGIN_SZSLSZ04 -0.2193943  0.0088515   -24.786  &lt; 2e-16 ***
ORIGIN_SZSRSZ01 -2.9693856  0.0173639  -171.009  &lt; 2e-16 ***
ORIGIN_SZTHSZ01 -2.0115256  0.0570319   -35.270  &lt; 2e-16 ***
ORIGIN_SZTHSZ03 -1.8336174  0.0272774   -67.221  &lt; 2e-16 ***
ORIGIN_SZTHSZ04 -2.7490858  0.0343177   -80.107  &lt; 2e-16 ***
ORIGIN_SZTHSZ06 -2.2050873  0.0205489  -107.309  &lt; 2e-16 ***
ORIGIN_SZTMSZ01  0.8269386  0.0066824   123.750  &lt; 2e-16 ***
ORIGIN_SZTMSZ02  2.3168168  0.0044981   515.063  &lt; 2e-16 ***
ORIGIN_SZTMSZ03  1.6951634  0.0048612   348.712  &lt; 2e-16 ***
ORIGIN_SZTMSZ04  1.2533753  0.0058390   214.656  &lt; 2e-16 ***
ORIGIN_SZTMSZ05 -0.0801676  0.0124078    -6.461 1.04e-10 ***
ORIGIN_SZTNSZ01 -2.0531360  0.0139593  -147.080  &lt; 2e-16 ***
ORIGIN_SZTNSZ02 -1.8856729  0.0107900  -174.762  &lt; 2e-16 ***
ORIGIN_SZTNSZ03 -2.1728446  0.0146759  -148.056  &lt; 2e-16 ***
ORIGIN_SZTNSZ04 -0.5119935  0.0081499   -62.822  &lt; 2e-16 ***
ORIGIN_SZTPSZ01 -0.6673283  0.0075606   -88.264  &lt; 2e-16 ***
ORIGIN_SZTPSZ02  0.4557995  0.0050191    90.813  &lt; 2e-16 ***
ORIGIN_SZTPSZ03 -0.7710271  0.0072249  -106.719  &lt; 2e-16 ***
ORIGIN_SZTPSZ04 -0.6961504  0.0066457  -104.752  &lt; 2e-16 ***
ORIGIN_SZTPSZ05 -0.5472208  0.0070367   -77.767  &lt; 2e-16 ***
ORIGIN_SZTPSZ06 -0.4182875  0.0068714   -60.874  &lt; 2e-16 ***
ORIGIN_SZTPSZ07 -0.2840441  0.0071030   -39.989  &lt; 2e-16 ***
ORIGIN_SZTPSZ08 -1.0725367  0.0110045   -97.463  &lt; 2e-16 ***
ORIGIN_SZTPSZ09 -0.8153667  0.0079160  -103.002  &lt; 2e-16 ***
ORIGIN_SZTPSZ10 -0.9196991  0.0086808  -105.946  &lt; 2e-16 ***
ORIGIN_SZTPSZ11 -0.0701830  0.0064336   -10.909  &lt; 2e-16 ***
ORIGIN_SZTPSZ12 -0.6499036  0.0078321   -82.980  &lt; 2e-16 ***
ORIGIN_SZTSSZ01 -1.9951324  0.0517290   -38.569  &lt; 2e-16 ***
ORIGIN_SZTSSZ02  0.9520650  0.0093851   101.445  &lt; 2e-16 ***
ORIGIN_SZTSSZ03  0.4346920  0.0095561    45.488  &lt; 2e-16 ***
ORIGIN_SZTSSZ04  0.6298396  0.0104594    60.218  &lt; 2e-16 ***
ORIGIN_SZTSSZ05 -0.1472193  0.0178492    -8.248  &lt; 2e-16 ***
ORIGIN_SZTSSZ06  1.5179959  0.0206625    73.466  &lt; 2e-16 ***
ORIGIN_SZWCSZ01  0.7473805  0.0105596    70.777  &lt; 2e-16 ***
ORIGIN_SZWCSZ02 -1.9686666  0.0345747   -56.940  &lt; 2e-16 ***
ORIGIN_SZWCSZ03 -5.0468779  0.1474971   -34.217  &lt; 2e-16 ***
ORIGIN_SZWDSZ01  1.4709388  0.0047211   311.566  &lt; 2e-16 ***
ORIGIN_SZWDSZ02  0.9347458  0.0055730   167.727  &lt; 2e-16 ***
ORIGIN_SZWDSZ03  1.5447734  0.0052159   296.168  &lt; 2e-16 ***
ORIGIN_SZWDSZ04  1.3725834  0.0060516   226.812  &lt; 2e-16 ***
ORIGIN_SZWDSZ05  0.6185757  0.0062263    99.349  &lt; 2e-16 ***
ORIGIN_SZWDSZ06  0.7397555  0.0060902   121.466  &lt; 2e-16 ***
ORIGIN_SZWDSZ07 -0.6989839  0.0093552   -74.716  &lt; 2e-16 ***
ORIGIN_SZWDSZ08 -0.4458874  0.0096399   -46.255  &lt; 2e-16 ***
ORIGIN_SZWDSZ09  1.3147766  0.0052106   252.327  &lt; 2e-16 ***
ORIGIN_SZYSSZ01 -0.1828752  0.0069544   -26.296  &lt; 2e-16 ***
ORIGIN_SZYSSZ02  0.8948598  0.0058951   151.796  &lt; 2e-16 ***
ORIGIN_SZYSSZ03  1.8357721  0.0050377   364.408  &lt; 2e-16 ***
ORIGIN_SZYSSZ04  1.0782847  0.0052959   203.607  &lt; 2e-16 ***
ORIGIN_SZYSSZ05  0.3002503  0.0069692    43.082  &lt; 2e-16 ***
ORIGIN_SZYSSZ06 -0.4626255  0.0124864   -37.050  &lt; 2e-16 ***
ORIGIN_SZYSSZ07 -1.0611504  0.0155816   -68.103  &lt; 2e-16 ***
ORIGIN_SZYSSZ08  0.1839980  0.0070935    25.939  &lt; 2e-16 ***
ORIGIN_SZYSSZ09  1.0661665  0.0050450   211.332  &lt; 2e-16 ***
log(dist)       -1.7058554  0.0004637 -3679.012  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 36117615  on 14273  degrees of freedom
Residual deviance: 13066296  on 13994  degrees of freedom
AIC: 13151411

Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
<p>We can examine how the constraints hold for destinations this time.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CalcRSquared</span>(orcSIM0<span class="sc">$</span>data<span class="sc">$</span>TRIPS, orcSIM0<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3878401</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>orcSIM <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> TRIPS <span class="sc">~</span> ORIGIN_SZ <span class="sc">+</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(DESTIN_AGE25_64) <span class="sc">+</span> <span class="fu">log</span>(dist),</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> SIM_data,</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">na.action =</span> na.exclude)</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(orcSIM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = TRIPS ~ ORIGIN_SZ + log(DESTIN_AGE25_64) + log(dist), 
    family = poisson(link = "log"), data = SIM_data, na.action = na.exclude)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-241.02   -16.13    -7.46     0.80   418.33  

Coefficients:
                       Estimate Std. Error   z value Pr(&gt;|z|)    
(Intercept)          19.9309957  0.0054015  3689.887  &lt; 2e-16 ***
ORIGIN_SZAMSZ02       0.6805710  0.0052686   129.175  &lt; 2e-16 ***
ORIGIN_SZAMSZ03       0.3597850  0.0054884    65.554  &lt; 2e-16 ***
ORIGIN_SZAMSZ04      -0.1106566  0.0060027   -18.434  &lt; 2e-16 ***
ORIGIN_SZAMSZ05      -0.3140561  0.0067998   -46.186  &lt; 2e-16 ***
ORIGIN_SZAMSZ06       0.0634425  0.0060258    10.528  &lt; 2e-16 ***
ORIGIN_SZAMSZ07      -1.1301580  0.0110298  -102.464  &lt; 2e-16 ***
ORIGIN_SZAMSZ08      -0.6330394  0.0102949   -61.491  &lt; 2e-16 ***
ORIGIN_SZAMSZ09       0.1064915  0.0063450    16.784  &lt; 2e-16 ***
ORIGIN_SZAMSZ10       0.5061899  0.0053889    93.931  &lt; 2e-16 ***
ORIGIN_SZAMSZ11      -1.3167911  0.0144870   -90.895  &lt; 2e-16 ***
ORIGIN_SZAMSZ12      -1.5103004  0.0127453  -118.499  &lt; 2e-16 ***
ORIGIN_SZBDSZ01       1.3626004  0.0051433   264.929  &lt; 2e-16 ***
ORIGIN_SZBDSZ02       0.9554084  0.0059655   160.156  &lt; 2e-16 ***
ORIGIN_SZBDSZ03       1.1476190  0.0054278   211.433  &lt; 2e-16 ***
ORIGIN_SZBDSZ04       2.0110410  0.0046344   433.940  &lt; 2e-16 ***
ORIGIN_SZBDSZ05       1.0658940  0.0053976   197.477  &lt; 2e-16 ***
ORIGIN_SZBDSZ06       1.2719222  0.0054774   232.213  &lt; 2e-16 ***
ORIGIN_SZBDSZ07      -0.5053039  0.0111553   -45.297  &lt; 2e-16 ***
ORIGIN_SZBDSZ08      -0.3556193  0.0102947   -34.544  &lt; 2e-16 ***
ORIGIN_SZBKSZ01      -0.3606399  0.0075473   -47.784  &lt; 2e-16 ***
ORIGIN_SZBKSZ02       0.1357265  0.0061394    22.107  &lt; 2e-16 ***
ORIGIN_SZBKSZ03       0.4101999  0.0058983    69.545  &lt; 2e-16 ***
ORIGIN_SZBKSZ04      -0.3418645  0.0070764   -48.310  &lt; 2e-16 ***
ORIGIN_SZBKSZ05      -0.2986750  0.0074073   -40.322  &lt; 2e-16 ***
ORIGIN_SZBKSZ06      -0.2637855  0.0068739   -38.375  &lt; 2e-16 ***
ORIGIN_SZBKSZ07       0.5498323  0.0051476   106.813  &lt; 2e-16 ***
ORIGIN_SZBKSZ08      -0.0527393  0.0061457    -8.582  &lt; 2e-16 ***
ORIGIN_SZBKSZ09      -0.1564691  0.0067300   -23.249  &lt; 2e-16 ***
ORIGIN_SZBLSZ01      -1.7551329  0.0176599   -99.385  &lt; 2e-16 ***
ORIGIN_SZBLSZ02      -1.9493637  0.0213859   -91.152  &lt; 2e-16 ***
ORIGIN_SZBLSZ03      -2.9057732  0.0535995   -54.213  &lt; 2e-16 ***
ORIGIN_SZBLSZ04      -1.4672066  0.0254726   -57.599  &lt; 2e-16 ***
ORIGIN_SZBMSZ01       0.1806064  0.0060563    29.821  &lt; 2e-16 ***
ORIGIN_SZBMSZ02      -1.4026549  0.0078244  -179.267  &lt; 2e-16 ***
ORIGIN_SZBMSZ03      -0.5976236  0.0063808   -93.660  &lt; 2e-16 ***
ORIGIN_SZBMSZ04      -0.5456513  0.0059061   -92.388  &lt; 2e-16 ***
ORIGIN_SZBMSZ05      -3.1095195  0.0188118  -165.297  &lt; 2e-16 ***
ORIGIN_SZBMSZ06      -3.0273827  0.0194319  -155.794  &lt; 2e-16 ***
ORIGIN_SZBMSZ07      -0.7378197  0.0066865  -110.345  &lt; 2e-16 ***
ORIGIN_SZBMSZ08      -0.9306150  0.0067188  -138.510  &lt; 2e-16 ***
ORIGIN_SZBMSZ09      -1.4137345  0.0101071  -139.876  &lt; 2e-16 ***
ORIGIN_SZBMSZ10      -1.7054195  0.0101582  -167.886  &lt; 2e-16 ***
ORIGIN_SZBMSZ11      -1.2418380  0.0076792  -161.714  &lt; 2e-16 ***
ORIGIN_SZBMSZ12      -1.3746537  0.0109769  -125.231  &lt; 2e-16 ***
ORIGIN_SZBMSZ13      -0.4339494  0.0069335   -62.587  &lt; 2e-16 ***
ORIGIN_SZBMSZ14      -0.9950458  0.0076302  -130.410  &lt; 2e-16 ***
ORIGIN_SZBMSZ15      -0.6544196  0.0068964   -94.892  &lt; 2e-16 ***
ORIGIN_SZBMSZ16      -1.5193747  0.0105329  -144.250  &lt; 2e-16 ***
ORIGIN_SZBMSZ17      -1.6536771  0.0180672   -91.529  &lt; 2e-16 ***
ORIGIN_SZBPSZ01       0.1484355  0.0064734    22.930  &lt; 2e-16 ***
ORIGIN_SZBPSZ02      -0.3602094  0.0073902   -48.741  &lt; 2e-16 ***
ORIGIN_SZBPSZ03      -0.1567975  0.0072226   -21.709  &lt; 2e-16 ***
ORIGIN_SZBPSZ04       0.4504873  0.0058418    77.115  &lt; 2e-16 ***
ORIGIN_SZBPSZ05       0.5028646  0.0053682    93.675  &lt; 2e-16 ***
ORIGIN_SZBPSZ06      -1.0125668  0.0105638   -95.853  &lt; 2e-16 ***
ORIGIN_SZBPSZ07      -0.3859065  0.0098561   -39.154  &lt; 2e-16 ***
ORIGIN_SZBSSZ01       0.1488497  0.0065504    22.724  &lt; 2e-16 ***
ORIGIN_SZBSSZ02       0.4269498  0.0055893    76.387  &lt; 2e-16 ***
ORIGIN_SZBSSZ03      -0.2437385  0.0062020   -39.300  &lt; 2e-16 ***
ORIGIN_SZBTSZ01       0.1987940  0.0066672    29.817  &lt; 2e-16 ***
ORIGIN_SZBTSZ02      -0.4571546  0.0090784   -50.356  &lt; 2e-16 ***
ORIGIN_SZBTSZ03      -0.2697243  0.0077941   -34.606  &lt; 2e-16 ***
ORIGIN_SZBTSZ04      -1.0997236  0.0115225   -95.441  &lt; 2e-16 ***
ORIGIN_SZBTSZ05      -1.0053122  0.0132594   -75.819  &lt; 2e-16 ***
ORIGIN_SZBTSZ06      -1.0841201  0.0102242  -106.035  &lt; 2e-16 ***
ORIGIN_SZBTSZ07      -2.3134497  0.0158499  -145.960  &lt; 2e-16 ***
ORIGIN_SZBTSZ08      -1.1581618  0.0121161   -95.589  &lt; 2e-16 ***
ORIGIN_SZCBSZ01      -1.0805930  0.0577831   -18.701  &lt; 2e-16 ***
ORIGIN_SZCCSZ01      -0.8145372  0.0152638   -53.364  &lt; 2e-16 ***
ORIGIN_SZCHSZ01       0.0377079  0.0133240     2.830 0.004654 ** 
ORIGIN_SZCHSZ02      -0.6209553  0.0096388   -64.422  &lt; 2e-16 ***
ORIGIN_SZCHSZ03       1.6790244  0.0069559   241.381  &lt; 2e-16 ***
ORIGIN_SZCKSZ01       0.0839586  0.0059934    14.008  &lt; 2e-16 ***
ORIGIN_SZCKSZ02       0.4379511  0.0062289    70.309  &lt; 2e-16 ***
ORIGIN_SZCKSZ03       0.7956950  0.0051892   153.335  &lt; 2e-16 ***
ORIGIN_SZCKSZ04       1.2740323  0.0053165   239.637  &lt; 2e-16 ***
ORIGIN_SZCKSZ05       0.9326213  0.0061807   150.893  &lt; 2e-16 ***
ORIGIN_SZCKSZ06       0.3976273  0.0085639    46.431  &lt; 2e-16 ***
ORIGIN_SZCLSZ01      -0.7522917  0.0094655   -79.477  &lt; 2e-16 ***
ORIGIN_SZCLSZ02      -1.3937450  0.0153260   -90.940  &lt; 2e-16 ***
ORIGIN_SZCLSZ03      -0.7898683  0.0091016   -86.784  &lt; 2e-16 ***
ORIGIN_SZCLSZ04       0.8451512  0.0051258   164.882  &lt; 2e-16 ***
ORIGIN_SZCLSZ05      -1.6573818  0.0166091   -99.788  &lt; 2e-16 ***
ORIGIN_SZCLSZ06       0.9478181  0.0048182   196.716  &lt; 2e-16 ***
ORIGIN_SZCLSZ07      -0.2499753  0.0064632   -38.677  &lt; 2e-16 ***
ORIGIN_SZCLSZ08       0.1350119  0.0069296    19.483  &lt; 2e-16 ***
ORIGIN_SZCLSZ09      -1.3868782  0.0192743   -71.955  &lt; 2e-16 ***
ORIGIN_SZDTSZ02      -3.7535792  0.0871325   -43.079  &lt; 2e-16 ***
ORIGIN_SZDTSZ03      -3.8462041  0.0840156   -45.780  &lt; 2e-16 ***
ORIGIN_SZDTSZ13      -2.9738127  0.0349241   -85.151  &lt; 2e-16 ***
ORIGIN_SZGLSZ01      -1.5175198  0.0110135  -137.787  &lt; 2e-16 ***
ORIGIN_SZGLSZ02       0.2405712  0.0058742    40.954  &lt; 2e-16 ***
ORIGIN_SZGLSZ03       0.1940241  0.0061989    31.300  &lt; 2e-16 ***
ORIGIN_SZGLSZ04       1.0292572  0.0049028   209.931  &lt; 2e-16 ***
ORIGIN_SZGLSZ05       0.9864552  0.0050898   193.811  &lt; 2e-16 ***
ORIGIN_SZHGSZ01       0.3073609  0.0054307    56.597  &lt; 2e-16 ***
ORIGIN_SZHGSZ02       0.3827293  0.0054555    70.154  &lt; 2e-16 ***
ORIGIN_SZHGSZ03       0.2342580  0.0059240    39.544  &lt; 2e-16 ***
ORIGIN_SZHGSZ04       0.8750090  0.0049639   176.275  &lt; 2e-16 ***
ORIGIN_SZHGSZ05       1.1695280  0.0049468   236.420  &lt; 2e-16 ***
ORIGIN_SZHGSZ06      -0.0462411  0.0063805    -7.247 4.25e-13 ***
ORIGIN_SZHGSZ07       0.4488583  0.0055139    81.404  &lt; 2e-16 ***
ORIGIN_SZHGSZ08       0.2236095  0.0061279    36.490  &lt; 2e-16 ***
ORIGIN_SZHGSZ09      -1.6376674  0.0084442  -193.941  &lt; 2e-16 ***
ORIGIN_SZHGSZ10      -2.9849025  0.0501042   -59.574  &lt; 2e-16 ***
ORIGIN_SZJESZ01       0.3926525  0.0056268    69.783  &lt; 2e-16 ***
ORIGIN_SZJESZ02       0.1230160  0.0056864    21.633  &lt; 2e-16 ***
ORIGIN_SZJESZ03       0.0188276  0.0061020     3.085 0.002032 ** 
ORIGIN_SZJESZ04      -1.3611618  0.0117184  -116.156  &lt; 2e-16 ***
ORIGIN_SZJESZ05      -2.0643662  0.0157083  -131.419  &lt; 2e-16 ***
ORIGIN_SZJESZ06       0.1556368  0.0055245    28.172  &lt; 2e-16 ***
ORIGIN_SZJESZ07      -1.7664532  0.0133171  -132.646  &lt; 2e-16 ***
ORIGIN_SZJESZ08      -0.9115981  0.0138203   -65.961  &lt; 2e-16 ***
ORIGIN_SZJESZ09       0.6121916  0.0060381   101.388  &lt; 2e-16 ***
ORIGIN_SZJESZ10      -1.1953045  0.0233216   -51.253  &lt; 2e-16 ***
ORIGIN_SZJESZ11      -1.4088748  0.0220921   -63.773  &lt; 2e-16 ***
ORIGIN_SZJWSZ01       0.5759093  0.0077741    74.081  &lt; 2e-16 ***
ORIGIN_SZJWSZ02       0.9769314  0.0053029   184.227  &lt; 2e-16 ***
ORIGIN_SZJWSZ03       1.3242695  0.0049068   269.882  &lt; 2e-16 ***
ORIGIN_SZJWSZ04       0.5621088  0.0057831    97.199  &lt; 2e-16 ***
ORIGIN_SZJWSZ05      -1.5744341  0.0146904  -107.174  &lt; 2e-16 ***
ORIGIN_SZJWSZ06      -0.9113320  0.0126913   -71.807  &lt; 2e-16 ***
ORIGIN_SZJWSZ07      -2.3083419  0.0357843   -64.507  &lt; 2e-16 ***
ORIGIN_SZJWSZ08       2.0114225  0.0047956   419.429  &lt; 2e-16 ***
ORIGIN_SZJWSZ09       1.9086705  0.0045255   421.759  &lt; 2e-16 ***
ORIGIN_SZKLSZ01       0.2743166  0.0056908    48.204  &lt; 2e-16 ***
ORIGIN_SZKLSZ02      -0.6443386  0.0074521   -86.463  &lt; 2e-16 ***
ORIGIN_SZKLSZ03      -0.3990113  0.0067213   -59.366  &lt; 2e-16 ***
ORIGIN_SZKLSZ04      -2.1413876  0.0138405  -154.719  &lt; 2e-16 ***
ORIGIN_SZKLSZ05      -1.0913697  0.0121512   -89.816  &lt; 2e-16 ***
ORIGIN_SZKLSZ06      -5.6240764  0.1857405   -30.279  &lt; 2e-16 ***
ORIGIN_SZKLSZ07      -1.1885897  0.0096830  -122.750  &lt; 2e-16 ***
ORIGIN_SZKLSZ08      -1.7018593  0.0114317  -148.872  &lt; 2e-16 ***
ORIGIN_SZLKSZ01      -1.6659670  0.0446420   -37.318  &lt; 2e-16 ***
ORIGIN_SZMDSZ01      -1.1210505  0.0318834   -35.161  &lt; 2e-16 ***
ORIGIN_SZMDSZ02      -0.5096299  0.0116645   -43.691  &lt; 2e-16 ***
ORIGIN_SZMDSZ03      -1.9187039  0.0198291   -96.762  &lt; 2e-16 ***
ORIGIN_SZMPSZ01      -0.5260512  0.0094201   -55.844  &lt; 2e-16 ***
ORIGIN_SZMPSZ02      -0.2905084  0.0077974   -37.257  &lt; 2e-16 ***
ORIGIN_SZMPSZ03       0.3342293  0.0063715    52.457  &lt; 2e-16 ***
ORIGIN_SZMUSZ02      -3.8337096  0.1105053   -34.693  &lt; 2e-16 ***
ORIGIN_SZNTSZ01      -2.9845040  0.0397028   -75.171  &lt; 2e-16 ***
ORIGIN_SZNTSZ02      -3.1812985  0.0249470  -127.522  &lt; 2e-16 ***
ORIGIN_SZNTSZ03      -0.9742991  0.0085424  -114.054  &lt; 2e-16 ***
ORIGIN_SZNTSZ05      -4.2086932  0.0579737   -72.597  &lt; 2e-16 ***
ORIGIN_SZNTSZ06      -4.5831822  0.0583494   -78.547  &lt; 2e-16 ***
ORIGIN_SZNVSZ01       0.3186962  0.0052944    60.195  &lt; 2e-16 ***
ORIGIN_SZNVSZ02      -0.5321136  0.0073747   -72.154  &lt; 2e-16 ***
ORIGIN_SZNVSZ03      -0.9911852  0.0090560  -109.451  &lt; 2e-16 ***
ORIGIN_SZNVSZ04      -0.8329721  0.0099590   -83.640  &lt; 2e-16 ***
ORIGIN_SZNVSZ05      -2.1460777  0.0182401  -117.657  &lt; 2e-16 ***
ORIGIN_SZPGSZ01      -0.5604078  0.0151515   -36.987  &lt; 2e-16 ***
ORIGIN_SZPGSZ02      -0.4025139  0.0085135   -47.279  &lt; 2e-16 ***
ORIGIN_SZPGSZ03       0.6975483  0.0055534   125.608  &lt; 2e-16 ***
ORIGIN_SZPGSZ04       1.2175486  0.0051080   238.363  &lt; 2e-16 ***
ORIGIN_SZPGSZ05       0.3895354  0.0069851    55.767  &lt; 2e-16 ***
ORIGIN_SZPLSZ01      -0.5572701  0.0134473   -41.441  &lt; 2e-16 ***
ORIGIN_SZPLSZ02      -0.9854214  0.0172337   -57.180  &lt; 2e-16 ***
ORIGIN_SZPLSZ03      -1.6991954  0.0472629   -35.952  &lt; 2e-16 ***
ORIGIN_SZPLSZ04      -2.2000217  0.0373580   -58.890  &lt; 2e-16 ***
ORIGIN_SZPLSZ05      -1.7086663  0.0260920   -65.486  &lt; 2e-16 ***
ORIGIN_SZPNSZ01       1.5292867  0.0055102   277.535  &lt; 2e-16 ***
ORIGIN_SZPNSZ02       0.7457519  0.0127815    58.346  &lt; 2e-16 ***
ORIGIN_SZPNSZ03      -1.3659046  0.0216180   -63.184  &lt; 2e-16 ***
ORIGIN_SZPNSZ04      -2.0025379  0.0360655   -55.525  &lt; 2e-16 ***
ORIGIN_SZPNSZ05      -0.9157959  0.0320955   -28.533  &lt; 2e-16 ***
ORIGIN_SZPRSZ01       0.0522611  0.0139142     3.756 0.000173 ***
ORIGIN_SZPRSZ02       1.3063371  0.0053809   242.774  &lt; 2e-16 ***
ORIGIN_SZPRSZ03       0.9963670  0.0054293   183.516  &lt; 2e-16 ***
ORIGIN_SZPRSZ04      -0.0300950  0.0088010    -3.419 0.000627 ***
ORIGIN_SZPRSZ05       1.6840313  0.0050839   331.245  &lt; 2e-16 ***
ORIGIN_SZPRSZ06      -0.8277202  0.0131296   -63.042  &lt; 2e-16 ***
ORIGIN_SZPRSZ07      -2.1698449  0.0177362  -122.340  &lt; 2e-16 ***
ORIGIN_SZPRSZ08       0.4559353  0.0072609    62.793  &lt; 2e-16 ***
ORIGIN_SZQTSZ01      -0.3517047  0.0078770   -44.650  &lt; 2e-16 ***
ORIGIN_SZQTSZ02      -0.8199353  0.0071544  -114.605  &lt; 2e-16 ***
ORIGIN_SZQTSZ03      -0.2457614  0.0065555   -37.490  &lt; 2e-16 ***
ORIGIN_SZQTSZ04      -1.2216614  0.0084050  -145.349  &lt; 2e-16 ***
ORIGIN_SZQTSZ05      -0.7219952  0.0072360   -99.778  &lt; 2e-16 ***
ORIGIN_SZQTSZ06      -0.6729363  0.0076658   -87.784  &lt; 2e-16 ***
ORIGIN_SZQTSZ07      -1.4497690  0.0109365  -132.563  &lt; 2e-16 ***
ORIGIN_SZQTSZ08      -0.2770151  0.0070193   -39.465  &lt; 2e-16 ***
ORIGIN_SZQTSZ09      -0.6157554  0.0078739   -78.202  &lt; 2e-16 ***
ORIGIN_SZQTSZ10      -0.3091547  0.0075471   -40.963  &lt; 2e-16 ***
ORIGIN_SZQTSZ11      -1.9698881  0.0151247  -130.243  &lt; 2e-16 ***
ORIGIN_SZQTSZ12      -2.6449643  0.0205857  -128.485  &lt; 2e-16 ***
ORIGIN_SZQTSZ13      -0.3754107  0.0088433   -42.452  &lt; 2e-16 ***
ORIGIN_SZQTSZ14      -1.6537473  0.0134378  -123.067  &lt; 2e-16 ***
ORIGIN_SZQTSZ15      -0.3435351  0.0131956   -26.034  &lt; 2e-16 ***
ORIGIN_SZRCSZ01      -1.7104390  0.0141179  -121.154  &lt; 2e-16 ***
ORIGIN_SZRCSZ06      -1.1250727  0.0094909  -118.542  &lt; 2e-16 ***
ORIGIN_SZRVSZ01      -3.0220116  0.0339694   -88.963  &lt; 2e-16 ***
ORIGIN_SZRVSZ02      -3.6040075  0.0297641  -121.086  &lt; 2e-16 ***
ORIGIN_SZRVSZ03      -3.2345594  0.0259149  -124.814  &lt; 2e-16 ***
ORIGIN_SZRVSZ04      -3.6900313  0.0575908   -64.073  &lt; 2e-16 ***
ORIGIN_SZRVSZ05      -2.9527570  0.0178582  -165.344  &lt; 2e-16 ***
ORIGIN_SZSBSZ01       0.0238445  0.0078563     3.035 0.002405 ** 
ORIGIN_SZSBSZ02      -0.5780602  0.0093054   -62.121  &lt; 2e-16 ***
ORIGIN_SZSBSZ03       0.8961719  0.0054586   164.175  &lt; 2e-16 ***
ORIGIN_SZSBSZ04       0.8421798  0.0061888   136.080  &lt; 2e-16 ***
ORIGIN_SZSBSZ05      -0.1682984  0.0078342   -21.482  &lt; 2e-16 ***
ORIGIN_SZSBSZ06      -1.1482701  0.0196421   -58.460  &lt; 2e-16 ***
ORIGIN_SZSBSZ07      -0.8830317  0.0160709   -54.946  &lt; 2e-16 ***
ORIGIN_SZSBSZ08      -1.1039492  0.0174602   -63.226  &lt; 2e-16 ***
ORIGIN_SZSBSZ09      -0.5946691  0.0101961   -58.323  &lt; 2e-16 ***
ORIGIN_SZSESZ02       1.1144933  0.0050948   218.749  &lt; 2e-16 ***
ORIGIN_SZSESZ03       1.1058963  0.0049026   225.574  &lt; 2e-16 ***
ORIGIN_SZSESZ04       0.7427975  0.0056948   130.433  &lt; 2e-16 ***
ORIGIN_SZSESZ05      -0.2812684  0.0069596   -40.414  &lt; 2e-16 ***
ORIGIN_SZSESZ06       0.8168315  0.0055800   146.387  &lt; 2e-16 ***
ORIGIN_SZSESZ07      -2.2842043  0.0231232   -98.784  &lt; 2e-16 ***
ORIGIN_SZSGSZ01      -0.7313790  0.0098957   -73.909  &lt; 2e-16 ***
ORIGIN_SZSGSZ02      -1.1185406  0.0110919  -100.843  &lt; 2e-16 ***
ORIGIN_SZSGSZ03       0.1752618  0.0060508    28.965  &lt; 2e-16 ***
ORIGIN_SZSGSZ04       0.3764395  0.0056165    67.023  &lt; 2e-16 ***
ORIGIN_SZSGSZ05      -1.7203916  0.0118945  -144.637  &lt; 2e-16 ***
ORIGIN_SZSGSZ06       0.4630857  0.0052886    87.563  &lt; 2e-16 ***
ORIGIN_SZSGSZ07      -0.7051233  0.0073133   -96.417  &lt; 2e-16 ***
ORIGIN_SZSKSZ01       0.2053928  0.0100710    20.395  &lt; 2e-16 ***
ORIGIN_SZSKSZ02       1.2630428  0.0063490   198.935  &lt; 2e-16 ***
ORIGIN_SZSKSZ03      -0.3035297  0.0096788   -31.360  &lt; 2e-16 ***
ORIGIN_SZSKSZ04      -1.7952886  0.0359225   -49.977  &lt; 2e-16 ***
ORIGIN_SZSKSZ05      -0.3836861  0.0176686   -21.716  &lt; 2e-16 ***
ORIGIN_SZSLSZ01      -2.5916326  0.0348001   -74.472  &lt; 2e-16 ***
ORIGIN_SZSLSZ04      -0.2251549  0.0088517   -25.436  &lt; 2e-16 ***
ORIGIN_SZSRSZ01      -2.9590365  0.0173638  -170.414  &lt; 2e-16 ***
ORIGIN_SZTHSZ01      -1.9639893  0.0570321   -34.437  &lt; 2e-16 ***
ORIGIN_SZTHSZ03      -1.7281304  0.0272797   -63.349  &lt; 2e-16 ***
ORIGIN_SZTHSZ04      -2.7837906  0.0343179   -81.118  &lt; 2e-16 ***
ORIGIN_SZTHSZ06      -2.1800693  0.0205491  -106.091  &lt; 2e-16 ***
ORIGIN_SZTMSZ01       0.8228136  0.0066824   123.131  &lt; 2e-16 ***
ORIGIN_SZTMSZ02       2.3174781  0.0044978   515.243  &lt; 2e-16 ***
ORIGIN_SZTMSZ03       1.7061757  0.0048615   350.957  &lt; 2e-16 ***
ORIGIN_SZTMSZ04       1.2407899  0.0058389   212.504  &lt; 2e-16 ***
ORIGIN_SZTMSZ05      -0.1000526  0.0124079    -8.064 7.41e-16 ***
ORIGIN_SZTNSZ01      -2.0347519  0.0139596  -145.760  &lt; 2e-16 ***
ORIGIN_SZTNSZ02      -1.8682671  0.0107901  -173.146  &lt; 2e-16 ***
ORIGIN_SZTNSZ03      -2.1737183  0.0146759  -148.115  &lt; 2e-16 ***
ORIGIN_SZTNSZ04      -0.5006452  0.0081501   -61.428  &lt; 2e-16 ***
ORIGIN_SZTPSZ01      -0.6722487  0.0075606   -88.914  &lt; 2e-16 ***
ORIGIN_SZTPSZ02       0.4552916  0.0050191    90.711  &lt; 2e-16 ***
ORIGIN_SZTPSZ03      -0.7865781  0.0072250  -108.869  &lt; 2e-16 ***
ORIGIN_SZTPSZ04      -0.7049044  0.0066456  -106.071  &lt; 2e-16 ***
ORIGIN_SZTPSZ05      -0.5574925  0.0070366   -79.227  &lt; 2e-16 ***
ORIGIN_SZTPSZ06      -0.4247282  0.0068709   -61.815  &lt; 2e-16 ***
ORIGIN_SZTPSZ07      -0.2846984  0.0071030   -40.081  &lt; 2e-16 ***
ORIGIN_SZTPSZ08      -1.0898051  0.0110046   -99.031  &lt; 2e-16 ***
ORIGIN_SZTPSZ09      -0.8092746  0.0079160  -102.232  &lt; 2e-16 ***
ORIGIN_SZTPSZ10      -0.9332072  0.0086809  -107.502  &lt; 2e-16 ***
ORIGIN_SZTPSZ11      -0.0421981  0.0064343    -6.558 5.44e-11 ***
ORIGIN_SZTPSZ12      -0.6330081  0.0078324   -80.819  &lt; 2e-16 ***
ORIGIN_SZTSSZ01      -1.7650409  0.0517357   -34.116  &lt; 2e-16 ***
ORIGIN_SZTSSZ02       1.1707267  0.0094178   124.310  &lt; 2e-16 ***
ORIGIN_SZTSSZ03       0.6581679  0.0095894    68.635  &lt; 2e-16 ***
ORIGIN_SZTSSZ04       0.8736493  0.0104965    83.233  &lt; 2e-16 ***
ORIGIN_SZTSSZ05       0.0957248  0.0178709     5.356 8.49e-08 ***
ORIGIN_SZTSSZ06       1.7581609  0.0206810    85.013  &lt; 2e-16 ***
ORIGIN_SZWCSZ01       0.8097950  0.0105622    76.669  &lt; 2e-16 ***
ORIGIN_SZWCSZ02      -1.9966163  0.0345747   -57.748  &lt; 2e-16 ***
ORIGIN_SZWCSZ03      -5.0687420  0.1474971   -34.365  &lt; 2e-16 ***
ORIGIN_SZWDSZ01       1.4926003  0.0047216   316.124  &lt; 2e-16 ***
ORIGIN_SZWDSZ02       0.9916597  0.0055755   177.859  &lt; 2e-16 ***
ORIGIN_SZWDSZ03       1.5918065  0.0052180   305.062  &lt; 2e-16 ***
ORIGIN_SZWDSZ04       1.3717152  0.0060516   226.669  &lt; 2e-16 ***
ORIGIN_SZWDSZ05       0.6700111  0.0062287   107.569  &lt; 2e-16 ***
ORIGIN_SZWDSZ06       0.8115996  0.0060947   133.165  &lt; 2e-16 ***
ORIGIN_SZWDSZ07      -0.6488914  0.0093567   -69.351  &lt; 2e-16 ***
ORIGIN_SZWDSZ08      -0.3610234  0.0096440   -37.435  &lt; 2e-16 ***
ORIGIN_SZWDSZ09       1.4445461  0.0052279   276.317  &lt; 2e-16 ***
ORIGIN_SZYSSZ01      -0.2039272  0.0069548   -29.322  &lt; 2e-16 ***
ORIGIN_SZYSSZ02       0.8707707  0.0058957   147.697  &lt; 2e-16 ***
ORIGIN_SZYSSZ03       1.8348842  0.0050377   364.231  &lt; 2e-16 ***
ORIGIN_SZYSSZ04       1.0780641  0.0052960   203.564  &lt; 2e-16 ***
ORIGIN_SZYSSZ05       0.3222765  0.0069700    46.237  &lt; 2e-16 ***
ORIGIN_SZYSSZ06      -0.4424689  0.0124866   -35.435  &lt; 2e-16 ***
ORIGIN_SZYSSZ07      -1.0267883  0.0155821   -65.895  &lt; 2e-16 ***
ORIGIN_SZYSSZ08       0.1833117  0.0070935    25.842  &lt; 2e-16 ***
ORIGIN_SZYSSZ09       1.0766070  0.0050451   213.396  &lt; 2e-16 ***
log(DESTIN_AGE25_64)  0.0295428  0.0001051   280.998  &lt; 2e-16 ***
log(dist)            -1.7024691  0.0004625 -3681.042  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 36117615  on 14273  degrees of freedom
Residual deviance: 12983718  on 13993  degrees of freedom
AIC: 13068835

Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CalcRSquared</span>(orcSIM<span class="sc">$</span>data<span class="sc">$</span>TRIPS, orcSIM<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4029115</code></pre>
</div>
</div>
<p>What about adding new variables?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>orcSIM2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> TRIPS <span class="sc">~</span> ORIGIN_SZ <span class="sc">+</span> </span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>                    DESTIN_AGE7_12 <span class="sc">+</span> </span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>                    DESTIN_AGE13_24 <span class="sc">+</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>                    DESTIN_AGE25_64 <span class="sc">+</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">log</span>(dist),</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> SIM_data,</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">na.action =</span> na.exclude)</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(orcSIM2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = TRIPS ~ ORIGIN_SZ + DESTIN_AGE7_12 + DESTIN_AGE13_24 + 
    DESTIN_AGE25_64 + log(dist), family = poisson(link = "log"), 
    data = SIM_data, na.action = na.exclude)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-234.66   -15.68    -7.58     0.69   439.46  

Coefficients:
                  Estimate Std. Error   z value Pr(&gt;|z|)    
(Intercept)      1.987e+01  5.331e-03  3726.642  &lt; 2e-16 ***
ORIGIN_SZAMSZ02  7.112e-01  5.269e-03   134.982  &lt; 2e-16 ***
ORIGIN_SZAMSZ03  3.505e-01  5.488e-03    63.870  &lt; 2e-16 ***
ORIGIN_SZAMSZ04 -8.682e-02  6.003e-03   -14.464  &lt; 2e-16 ***
ORIGIN_SZAMSZ05 -2.657e-01  6.800e-03   -39.066  &lt; 2e-16 ***
ORIGIN_SZAMSZ06  1.224e-01  6.026e-03    20.303  &lt; 2e-16 ***
ORIGIN_SZAMSZ07 -1.080e+00  1.103e-02   -97.923  &lt; 2e-16 ***
ORIGIN_SZAMSZ08 -5.804e-01  1.030e-02   -56.373  &lt; 2e-16 ***
ORIGIN_SZAMSZ09  1.562e-01  6.345e-03    24.612  &lt; 2e-16 ***
ORIGIN_SZAMSZ10  5.457e-01  5.390e-03   101.260  &lt; 2e-16 ***
ORIGIN_SZAMSZ11 -1.311e+00  1.449e-02   -90.507  &lt; 2e-16 ***
ORIGIN_SZAMSZ12 -1.519e+00  1.275e-02  -119.180  &lt; 2e-16 ***
ORIGIN_SZBDSZ01  1.252e+00  5.147e-03   243.188  &lt; 2e-16 ***
ORIGIN_SZBDSZ02  6.157e-01  5.985e-03   102.872  &lt; 2e-16 ***
ORIGIN_SZBDSZ03  1.019e+00  5.433e-03   187.623  &lt; 2e-16 ***
ORIGIN_SZBDSZ04  1.870e+00  4.641e-03   402.891  &lt; 2e-16 ***
ORIGIN_SZBDSZ05  9.837e-01  5.400e-03   182.174  &lt; 2e-16 ***
ORIGIN_SZBDSZ06  1.082e+00  5.489e-03   197.058  &lt; 2e-16 ***
ORIGIN_SZBDSZ07 -5.398e-01  1.116e-02   -48.381  &lt; 2e-16 ***
ORIGIN_SZBDSZ08 -5.866e-01  1.030e-02   -56.950  &lt; 2e-16 ***
ORIGIN_SZBKSZ01 -3.499e-01  7.549e-03   -46.350  &lt; 2e-16 ***
ORIGIN_SZBKSZ02  1.697e-01  6.141e-03    27.640  &lt; 2e-16 ***
ORIGIN_SZBKSZ03  4.509e-01  5.901e-03    76.410  &lt; 2e-16 ***
ORIGIN_SZBKSZ04 -3.137e-01  7.077e-03   -44.326  &lt; 2e-16 ***
ORIGIN_SZBKSZ05 -2.033e-01  7.410e-03   -27.434  &lt; 2e-16 ***
ORIGIN_SZBKSZ06 -2.614e-01  6.874e-03   -38.023  &lt; 2e-16 ***
ORIGIN_SZBKSZ07  6.114e-01  5.149e-03   118.726  &lt; 2e-16 ***
ORIGIN_SZBKSZ08  1.923e-02  6.148e-03     3.128  0.00176 ** 
ORIGIN_SZBKSZ09 -8.738e-02  6.732e-03   -12.979  &lt; 2e-16 ***
ORIGIN_SZBLSZ01 -1.769e+00  1.765e-02  -100.183  &lt; 2e-16 ***
ORIGIN_SZBLSZ02 -1.955e+00  2.138e-02   -91.439  &lt; 2e-16 ***
ORIGIN_SZBLSZ03 -2.909e+00  5.366e-02   -54.205  &lt; 2e-16 ***
ORIGIN_SZBLSZ04 -1.466e+00  2.547e-02   -57.546  &lt; 2e-16 ***
ORIGIN_SZBMSZ01  2.747e-01  6.058e-03    45.345  &lt; 2e-16 ***
ORIGIN_SZBMSZ02 -1.274e+00  7.826e-03  -162.859  &lt; 2e-16 ***
ORIGIN_SZBMSZ03 -4.808e-01  6.382e-03   -75.329  &lt; 2e-16 ***
ORIGIN_SZBMSZ04 -4.328e-01  5.908e-03   -73.268  &lt; 2e-16 ***
ORIGIN_SZBMSZ05 -2.995e+00  1.881e-02  -159.225  &lt; 2e-16 ***
ORIGIN_SZBMSZ06 -2.888e+00  1.943e-02  -148.606  &lt; 2e-16 ***
ORIGIN_SZBMSZ07 -6.076e-01  6.688e-03   -90.841  &lt; 2e-16 ***
ORIGIN_SZBMSZ08 -8.040e-01  6.720e-03  -119.641  &lt; 2e-16 ***
ORIGIN_SZBMSZ09 -1.309e+00  1.011e-02  -129.539  &lt; 2e-16 ***
ORIGIN_SZBMSZ10 -1.586e+00  1.016e-02  -156.106  &lt; 2e-16 ***
ORIGIN_SZBMSZ11 -1.129e+00  7.680e-03  -147.017  &lt; 2e-16 ***
ORIGIN_SZBMSZ12 -1.285e+00  1.098e-02  -117.009  &lt; 2e-16 ***
ORIGIN_SZBMSZ13 -2.959e-01  6.936e-03   -42.661  &lt; 2e-16 ***
ORIGIN_SZBMSZ14 -8.696e-01  7.632e-03  -113.951  &lt; 2e-16 ***
ORIGIN_SZBMSZ15 -5.350e-01  6.898e-03   -77.566  &lt; 2e-16 ***
ORIGIN_SZBMSZ16 -1.434e+00  1.053e-02  -136.152  &lt; 2e-16 ***
ORIGIN_SZBMSZ17 -1.530e+00  1.807e-02   -84.707  &lt; 2e-16 ***
ORIGIN_SZBPSZ01  2.133e-01  6.479e-03    32.927  &lt; 2e-16 ***
ORIGIN_SZBPSZ02 -2.922e-01  7.394e-03   -39.512  &lt; 2e-16 ***
ORIGIN_SZBPSZ03 -8.616e-02  7.227e-03   -11.921  &lt; 2e-16 ***
ORIGIN_SZBPSZ04  5.101e-01  5.847e-03    87.236  &lt; 2e-16 ***
ORIGIN_SZBPSZ05  5.707e-01  5.373e-03   106.214  &lt; 2e-16 ***
ORIGIN_SZBPSZ06 -9.680e-01  1.057e-02   -91.619  &lt; 2e-16 ***
ORIGIN_SZBPSZ07 -2.821e-01  9.860e-03   -28.606  &lt; 2e-16 ***
ORIGIN_SZBSSZ01  2.144e-01  6.552e-03    32.717  &lt; 2e-16 ***
ORIGIN_SZBSSZ02  4.415e-01  5.589e-03    78.987  &lt; 2e-16 ***
ORIGIN_SZBSSZ03 -2.062e-01  6.203e-03   -33.241  &lt; 2e-16 ***
ORIGIN_SZBTSZ01  2.726e-01  6.670e-03    40.872  &lt; 2e-16 ***
ORIGIN_SZBTSZ02 -3.477e-01  9.082e-03   -38.290  &lt; 2e-16 ***
ORIGIN_SZBTSZ03 -1.604e-01  7.798e-03   -20.568  &lt; 2e-16 ***
ORIGIN_SZBTSZ04 -9.966e-01  1.152e-02   -86.490  &lt; 2e-16 ***
ORIGIN_SZBTSZ05 -9.147e-01  1.326e-02   -68.976  &lt; 2e-16 ***
ORIGIN_SZBTSZ06 -9.133e-01  1.023e-02   -89.297  &lt; 2e-16 ***
ORIGIN_SZBTSZ07 -2.157e+00  1.585e-02  -136.089  &lt; 2e-16 ***
ORIGIN_SZBTSZ08 -9.812e-01  1.212e-02   -80.956  &lt; 2e-16 ***
ORIGIN_SZCBSZ01 -1.194e+00  5.778e-02   -20.666  &lt; 2e-16 ***
ORIGIN_SZCCSZ01 -7.901e-01  1.526e-02   -51.758  &lt; 2e-16 ***
ORIGIN_SZCHSZ01 -1.564e-01  1.333e-02   -11.731  &lt; 2e-16 ***
ORIGIN_SZCHSZ02 -6.216e-01  9.644e-03   -64.456  &lt; 2e-16 ***
ORIGIN_SZCHSZ03  1.517e+00  6.966e-03   217.747  &lt; 2e-16 ***
ORIGIN_SZCKSZ01  1.329e-01  6.001e-03    22.139  &lt; 2e-16 ***
ORIGIN_SZCKSZ02  4.540e-01  6.232e-03    72.850  &lt; 2e-16 ***
ORIGIN_SZCKSZ03  7.961e-01  5.201e-03   153.066  &lt; 2e-16 ***
ORIGIN_SZCKSZ04  1.292e+00  5.325e-03   242.696  &lt; 2e-16 ***
ORIGIN_SZCKSZ05  9.500e-01  6.201e-03   153.204  &lt; 2e-16 ***
ORIGIN_SZCKSZ06  3.930e-01  8.590e-03    45.752  &lt; 2e-16 ***
ORIGIN_SZCLSZ01 -6.723e-01  9.467e-03   -71.012  &lt; 2e-16 ***
ORIGIN_SZCLSZ02 -1.354e+00  1.533e-02   -88.317  &lt; 2e-16 ***
ORIGIN_SZCLSZ03 -7.333e-01  9.102e-03   -80.563  &lt; 2e-16 ***
ORIGIN_SZCLSZ04  9.735e-01  5.131e-03   189.738  &lt; 2e-16 ***
ORIGIN_SZCLSZ05 -1.591e+00  1.661e-02   -95.806  &lt; 2e-16 ***
ORIGIN_SZCLSZ06  1.033e+00  4.820e-03   214.411  &lt; 2e-16 ***
ORIGIN_SZCLSZ07 -1.499e-01  6.465e-03   -23.179  &lt; 2e-16 ***
ORIGIN_SZCLSZ08  2.415e-01  6.931e-03    34.849  &lt; 2e-16 ***
ORIGIN_SZCLSZ09 -1.307e+00  1.928e-02   -67.814  &lt; 2e-16 ***
ORIGIN_SZDTSZ02 -3.713e+00  8.713e-02   -42.617  &lt; 2e-16 ***
ORIGIN_SZDTSZ03 -3.712e+00  8.402e-02   -44.187  &lt; 2e-16 ***
ORIGIN_SZDTSZ13 -2.924e+00  3.492e-02   -83.719  &lt; 2e-16 ***
ORIGIN_SZGLSZ01 -1.536e+00  1.101e-02  -139.455  &lt; 2e-16 ***
ORIGIN_SZGLSZ02  2.285e-01  5.875e-03    38.900  &lt; 2e-16 ***
ORIGIN_SZGLSZ03  1.336e-01  6.199e-03    21.548  &lt; 2e-16 ***
ORIGIN_SZGLSZ04  1.061e+00  4.903e-03   216.433  &lt; 2e-16 ***
ORIGIN_SZGLSZ05  9.714e-01  5.090e-03   190.836  &lt; 2e-16 ***
ORIGIN_SZHGSZ01  1.891e-01  5.434e-03    34.796  &lt; 2e-16 ***
ORIGIN_SZHGSZ02  3.383e-01  5.454e-03    62.020  &lt; 2e-16 ***
ORIGIN_SZHGSZ03  1.787e-01  5.929e-03    30.130  &lt; 2e-16 ***
ORIGIN_SZHGSZ04  8.426e-01  4.966e-03   169.664  &lt; 2e-16 ***
ORIGIN_SZHGSZ05  1.104e+00  4.950e-03   222.982  &lt; 2e-16 ***
ORIGIN_SZHGSZ06 -1.092e-01  6.381e-03   -17.114  &lt; 2e-16 ***
ORIGIN_SZHGSZ07  4.280e-01  5.515e-03    77.611  &lt; 2e-16 ***
ORIGIN_SZHGSZ08  1.887e-01  6.128e-03    30.799  &lt; 2e-16 ***
ORIGIN_SZHGSZ09 -1.632e+00  8.420e-03  -193.818  &lt; 2e-16 ***
ORIGIN_SZHGSZ10 -3.078e+00  5.010e-02   -61.431  &lt; 2e-16 ***
ORIGIN_SZJESZ01  3.928e-01  5.627e-03    69.806  &lt; 2e-16 ***
ORIGIN_SZJESZ02  1.816e-01  5.688e-03    31.924  &lt; 2e-16 ***
ORIGIN_SZJESZ03  7.544e-02  6.103e-03    12.362  &lt; 2e-16 ***
ORIGIN_SZJESZ04 -1.344e+00  1.172e-02  -114.689  &lt; 2e-16 ***
ORIGIN_SZJESZ05 -1.992e+00  1.571e-02  -126.835  &lt; 2e-16 ***
ORIGIN_SZJESZ06  2.025e-01  5.524e-03    36.664  &lt; 2e-16 ***
ORIGIN_SZJESZ07 -1.668e+00  1.332e-02  -125.224  &lt; 2e-16 ***
ORIGIN_SZJESZ08 -8.879e-01  1.382e-02   -64.258  &lt; 2e-16 ***
ORIGIN_SZJESZ09  6.875e-01  6.036e-03   113.913  &lt; 2e-16 ***
ORIGIN_SZJESZ10 -1.209e+00  2.332e-02   -51.840  &lt; 2e-16 ***
ORIGIN_SZJESZ11 -1.355e+00  2.209e-02   -61.317  &lt; 2e-16 ***
ORIGIN_SZJWSZ01  4.609e-01  7.793e-03    59.145  &lt; 2e-16 ***
ORIGIN_SZJWSZ02  9.390e-01  5.315e-03   176.686  &lt; 2e-16 ***
ORIGIN_SZJWSZ03  1.357e+00  4.911e-03   276.316  &lt; 2e-16 ***
ORIGIN_SZJWSZ04  5.961e-01  5.779e-03   103.139  &lt; 2e-16 ***
ORIGIN_SZJWSZ05 -1.606e+00  1.469e-02  -109.264  &lt; 2e-16 ***
ORIGIN_SZJWSZ06 -1.021e+00  1.270e-02   -80.346  &lt; 2e-16 ***
ORIGIN_SZJWSZ07 -2.451e+00  3.579e-02   -68.487  &lt; 2e-16 ***
ORIGIN_SZJWSZ08  1.975e+00  4.809e-03   410.716  &lt; 2e-16 ***
ORIGIN_SZJWSZ09  1.869e+00  4.533e-03   412.387  &lt; 2e-16 ***
ORIGIN_SZKLSZ01  3.080e-01  5.691e-03    54.129  &lt; 2e-16 ***
ORIGIN_SZKLSZ02 -6.656e-01  7.453e-03   -89.306  &lt; 2e-16 ***
ORIGIN_SZKLSZ03 -3.949e-01  6.721e-03   -58.757  &lt; 2e-16 ***
ORIGIN_SZKLSZ04 -2.094e+00  1.384e-02  -151.276  &lt; 2e-16 ***
ORIGIN_SZKLSZ05 -1.076e+00  1.215e-02   -88.569  &lt; 2e-16 ***
ORIGIN_SZKLSZ06 -5.546e+00  1.857e-01   -29.858  &lt; 2e-16 ***
ORIGIN_SZKLSZ07 -1.088e+00  9.683e-03  -112.308  &lt; 2e-16 ***
ORIGIN_SZKLSZ08 -1.681e+00  1.143e-02  -147.049  &lt; 2e-16 ***
ORIGIN_SZLKSZ01 -1.663e+00  4.464e-02   -37.255  &lt; 2e-16 ***
ORIGIN_SZMDSZ01 -1.078e+00  3.188e-02   -33.817  &lt; 2e-16 ***
ORIGIN_SZMDSZ02 -5.846e-01  1.168e-02   -50.061  &lt; 2e-16 ***
ORIGIN_SZMDSZ03 -2.132e+00  1.983e-02  -107.525  &lt; 2e-16 ***
ORIGIN_SZMPSZ01 -5.425e-01  9.421e-03   -57.580  &lt; 2e-16 ***
ORIGIN_SZMPSZ02 -3.123e-01  7.798e-03   -40.041  &lt; 2e-16 ***
ORIGIN_SZMPSZ03  3.501e-01  6.373e-03    54.926  &lt; 2e-16 ***
ORIGIN_SZMUSZ02 -3.816e+00  1.105e-01   -34.535  &lt; 2e-16 ***
ORIGIN_SZNTSZ01 -2.807e+00  3.970e-02   -70.693  &lt; 2e-16 ***
ORIGIN_SZNTSZ02 -3.014e+00  2.495e-02  -120.821  &lt; 2e-16 ***
ORIGIN_SZNTSZ03 -8.077e-01  8.545e-03   -94.529  &lt; 2e-16 ***
ORIGIN_SZNTSZ05 -4.039e+00  5.797e-02   -69.668  &lt; 2e-16 ***
ORIGIN_SZNTSZ06 -4.386e+00  5.836e-02   -75.157  &lt; 2e-16 ***
ORIGIN_SZNVSZ01  3.963e-01  5.295e-03    74.831  &lt; 2e-16 ***
ORIGIN_SZNVSZ02 -4.611e-01  7.375e-03   -62.523  &lt; 2e-16 ***
ORIGIN_SZNVSZ03 -8.821e-01  9.058e-03   -97.388  &lt; 2e-16 ***
ORIGIN_SZNVSZ04 -7.373e-01  9.961e-03   -74.020  &lt; 2e-16 ***
ORIGIN_SZNVSZ05 -2.089e+00  1.824e-02  -114.532  &lt; 2e-16 ***
ORIGIN_SZPGSZ01 -4.122e-01  1.523e-02   -27.075  &lt; 2e-16 ***
ORIGIN_SZPGSZ02 -3.893e-01  8.557e-03   -45.495  &lt; 2e-16 ***
ORIGIN_SZPGSZ03  6.971e-01  5.585e-03   124.821  &lt; 2e-16 ***
ORIGIN_SZPGSZ04  1.183e+00  5.169e-03   228.759  &lt; 2e-16 ***
ORIGIN_SZPGSZ05  4.015e-01  7.035e-03    57.069  &lt; 2e-16 ***
ORIGIN_SZPLSZ01 -7.235e-01  1.345e-02   -53.775  &lt; 2e-16 ***
ORIGIN_SZPLSZ02 -1.028e+00  1.723e-02   -59.685  &lt; 2e-16 ***
ORIGIN_SZPLSZ03 -2.016e+00  4.726e-02   -42.658  &lt; 2e-16 ***
ORIGIN_SZPLSZ04 -2.289e+00  3.736e-02   -61.269  &lt; 2e-16 ***
ORIGIN_SZPLSZ05 -1.826e+00  2.609e-02   -69.970  &lt; 2e-16 ***
ORIGIN_SZPNSZ01  1.507e+00  5.482e-03   274.817  &lt; 2e-16 ***
ORIGIN_SZPNSZ02  7.643e-01  1.276e-02    59.916  &lt; 2e-16 ***
ORIGIN_SZPNSZ03 -1.367e+00  2.161e-02   -63.285  &lt; 2e-16 ***
ORIGIN_SZPNSZ04 -1.983e+00  3.606e-02   -54.993  &lt; 2e-16 ***
ORIGIN_SZPNSZ05 -8.975e-01  3.209e-02   -27.972  &lt; 2e-16 ***
ORIGIN_SZPRSZ01 -1.523e-01  1.393e-02   -10.934  &lt; 2e-16 ***
ORIGIN_SZPRSZ02  1.180e+00  5.388e-03   219.007  &lt; 2e-16 ***
ORIGIN_SZPRSZ03  7.962e-01  5.445e-03   146.221  &lt; 2e-16 ***
ORIGIN_SZPRSZ04 -2.542e-01  8.815e-03   -28.840  &lt; 2e-16 ***
ORIGIN_SZPRSZ05  1.430e+00  5.108e-03   279.924  &lt; 2e-16 ***
ORIGIN_SZPRSZ06 -8.027e-01  1.313e-02   -61.120  &lt; 2e-16 ***
ORIGIN_SZPRSZ07 -2.195e+00  1.774e-02  -123.738  &lt; 2e-16 ***
ORIGIN_SZPRSZ08  1.214e-01  7.286e-03    16.660  &lt; 2e-16 ***
ORIGIN_SZQTSZ01 -2.096e-01  7.879e-03   -26.603  &lt; 2e-16 ***
ORIGIN_SZQTSZ02 -6.730e-01  7.157e-03   -94.034  &lt; 2e-16 ***
ORIGIN_SZQTSZ03 -9.888e-02  6.558e-03   -15.079  &lt; 2e-16 ***
ORIGIN_SZQTSZ04 -1.095e+00  8.407e-03  -130.275  &lt; 2e-16 ***
ORIGIN_SZQTSZ05 -5.860e-01  7.238e-03   -80.958  &lt; 2e-16 ***
ORIGIN_SZQTSZ06 -5.722e-01  7.667e-03   -74.635  &lt; 2e-16 ***
ORIGIN_SZQTSZ07 -1.328e+00  1.094e-02  -121.453  &lt; 2e-16 ***
ORIGIN_SZQTSZ08 -1.730e-01  7.021e-03   -24.643  &lt; 2e-16 ***
ORIGIN_SZQTSZ09 -5.011e-01  7.876e-03   -63.627  &lt; 2e-16 ***
ORIGIN_SZQTSZ10 -2.196e-01  7.546e-03   -29.101  &lt; 2e-16 ***
ORIGIN_SZQTSZ11 -1.838e+00  1.513e-02  -121.535  &lt; 2e-16 ***
ORIGIN_SZQTSZ12 -2.501e+00  2.059e-02  -121.477  &lt; 2e-16 ***
ORIGIN_SZQTSZ13 -2.809e-01  8.843e-03   -31.769  &lt; 2e-16 ***
ORIGIN_SZQTSZ14 -1.556e+00  1.344e-02  -115.764  &lt; 2e-16 ***
ORIGIN_SZQTSZ15 -2.261e-01  1.320e-02   -17.134  &lt; 2e-16 ***
ORIGIN_SZRCSZ01 -1.633e+00  1.412e-02  -115.672  &lt; 2e-16 ***
ORIGIN_SZRCSZ06 -1.007e+00  9.489e-03  -106.170  &lt; 2e-16 ***
ORIGIN_SZRVSZ01 -2.887e+00  3.397e-02   -84.979  &lt; 2e-16 ***
ORIGIN_SZRVSZ02 -3.433e+00  2.976e-02  -115.330  &lt; 2e-16 ***
ORIGIN_SZRVSZ03 -3.099e+00  2.592e-02  -119.567  &lt; 2e-16 ***
ORIGIN_SZRVSZ04 -3.621e+00  5.759e-02   -62.873  &lt; 2e-16 ***
ORIGIN_SZRVSZ05 -2.775e+00  1.786e-02  -155.379  &lt; 2e-16 ***
ORIGIN_SZSBSZ01  5.388e-02  7.858e-03     6.856 7.10e-12 ***
ORIGIN_SZSBSZ02 -6.407e-01  9.309e-03   -68.821  &lt; 2e-16 ***
ORIGIN_SZSBSZ03  9.110e-01  5.473e-03   166.463  &lt; 2e-16 ***
ORIGIN_SZSBSZ04  8.464e-01  6.203e-03   136.450  &lt; 2e-16 ***
ORIGIN_SZSBSZ05 -1.581e-01  7.839e-03   -20.171  &lt; 2e-16 ***
ORIGIN_SZSBSZ06 -1.110e+00  1.964e-02   -56.488  &lt; 2e-16 ***
ORIGIN_SZSBSZ07 -7.889e-01  1.607e-02   -49.089  &lt; 2e-16 ***
ORIGIN_SZSBSZ08 -1.079e+00  1.746e-02   -61.796  &lt; 2e-16 ***
ORIGIN_SZSBSZ09 -6.218e-01  1.023e-02   -60.811  &lt; 2e-16 ***
ORIGIN_SZSESZ02  1.096e+00  5.131e-03   213.721  &lt; 2e-16 ***
ORIGIN_SZSESZ03  1.098e+00  4.942e-03   222.175  &lt; 2e-16 ***
ORIGIN_SZSESZ04  7.274e-01  5.745e-03   126.623  &lt; 2e-16 ***
ORIGIN_SZSESZ05 -3.725e-01  6.971e-03   -53.432  &lt; 2e-16 ***
ORIGIN_SZSESZ06  8.053e-01  5.590e-03   144.070  &lt; 2e-16 ***
ORIGIN_SZSESZ07 -2.278e+00  2.313e-02   -98.513  &lt; 2e-16 ***
ORIGIN_SZSGSZ01 -7.414e-01  9.901e-03   -74.882  &lt; 2e-16 ***
ORIGIN_SZSGSZ02 -1.169e+00  1.109e-02  -105.388  &lt; 2e-16 ***
ORIGIN_SZSGSZ03  1.130e-01  6.052e-03    18.669  &lt; 2e-16 ***
ORIGIN_SZSGSZ04  3.732e-01  5.617e-03    66.441  &lt; 2e-16 ***
ORIGIN_SZSGSZ05 -1.744e+00  1.189e-02  -146.626  &lt; 2e-16 ***
ORIGIN_SZSGSZ06  4.694e-01  5.289e-03    88.755  &lt; 2e-16 ***
ORIGIN_SZSGSZ07 -7.101e-01  7.313e-03   -97.098  &lt; 2e-16 ***
ORIGIN_SZSKSZ01  2.419e-01  1.007e-02    24.027  &lt; 2e-16 ***
ORIGIN_SZSKSZ02  1.287e+00  6.340e-03   203.006  &lt; 2e-16 ***
ORIGIN_SZSKSZ03 -2.639e-01  9.686e-03   -27.245  &lt; 2e-16 ***
ORIGIN_SZSKSZ04 -1.769e+00  3.592e-02   -49.252  &lt; 2e-16 ***
ORIGIN_SZSKSZ05 -3.764e-01  1.766e-02   -21.316  &lt; 2e-16 ***
ORIGIN_SZSLSZ01 -2.626e+00  3.480e-02   -75.445  &lt; 2e-16 ***
ORIGIN_SZSLSZ04 -2.435e-01  8.882e-03   -27.412  &lt; 2e-16 ***
ORIGIN_SZSRSZ01 -2.788e+00  1.736e-02  -160.559  &lt; 2e-16 ***
ORIGIN_SZTHSZ01 -1.901e+00  5.703e-02   -33.332  &lt; 2e-16 ***
ORIGIN_SZTHSZ03 -1.713e+00  2.728e-02   -62.780  &lt; 2e-16 ***
ORIGIN_SZTHSZ04 -2.806e+00  3.432e-02   -81.769  &lt; 2e-16 ***
ORIGIN_SZTHSZ06 -2.163e+00  2.055e-02  -105.237  &lt; 2e-16 ***
ORIGIN_SZTMSZ01  4.434e-01  6.713e-03    66.050  &lt; 2e-16 ***
ORIGIN_SZTMSZ02  2.200e+00  4.503e-03   488.514  &lt; 2e-16 ***
ORIGIN_SZTMSZ03  1.441e+00  4.879e-03   295.315  &lt; 2e-16 ***
ORIGIN_SZTMSZ04  7.973e-01  5.881e-03   135.556  &lt; 2e-16 ***
ORIGIN_SZTMSZ05 -4.176e-01  1.242e-02   -33.624  &lt; 2e-16 ***
ORIGIN_SZTNSZ01 -1.879e+00  1.396e-02  -134.582  &lt; 2e-16 ***
ORIGIN_SZTNSZ02 -1.726e+00  1.079e-02  -159.988  &lt; 2e-16 ***
ORIGIN_SZTNSZ03 -2.051e+00  1.468e-02  -139.762  &lt; 2e-16 ***
ORIGIN_SZTNSZ04 -3.472e-01  8.153e-03   -42.579  &lt; 2e-16 ***
ORIGIN_SZTPSZ01 -5.924e-01  7.562e-03   -78.341  &lt; 2e-16 ***
ORIGIN_SZTPSZ02  5.195e-01  5.020e-03   103.493  &lt; 2e-16 ***
ORIGIN_SZTPSZ03 -7.476e-01  7.225e-03  -103.479  &lt; 2e-16 ***
ORIGIN_SZTPSZ04 -6.308e-01  6.645e-03   -94.919  &lt; 2e-16 ***
ORIGIN_SZTPSZ05 -4.615e-01  7.037e-03   -65.580  &lt; 2e-16 ***
ORIGIN_SZTPSZ06 -3.031e-01  6.872e-03   -44.108  &lt; 2e-16 ***
ORIGIN_SZTPSZ07 -2.903e-01  7.105e-03   -40.853  &lt; 2e-16 ***
ORIGIN_SZTPSZ08 -1.036e+00  1.100e-02   -94.103  &lt; 2e-16 ***
ORIGIN_SZTPSZ09 -7.949e-01  7.916e-03  -100.408  &lt; 2e-16 ***
ORIGIN_SZTPSZ10 -8.850e-01  8.681e-03  -101.942  &lt; 2e-16 ***
ORIGIN_SZTPSZ11 -3.550e-02  6.434e-03    -5.517 3.44e-08 ***
ORIGIN_SZTPSZ12 -6.524e-01  7.832e-03   -83.301  &lt; 2e-16 ***
ORIGIN_SZTSSZ01 -1.736e+00  5.173e-02   -33.557  &lt; 2e-16 ***
ORIGIN_SZTSSZ02  1.163e+00  9.392e-03   123.799  &lt; 2e-16 ***
ORIGIN_SZTSSZ03  6.476e-01  9.562e-03    67.726  &lt; 2e-16 ***
ORIGIN_SZTSSZ04  8.921e-01  1.047e-02    85.241  &lt; 2e-16 ***
ORIGIN_SZTSSZ05  1.126e-01  1.785e-02     6.306 2.87e-10 ***
ORIGIN_SZTSSZ06  1.770e+00  2.067e-02    85.649  &lt; 2e-16 ***
ORIGIN_SZWCSZ01  7.755e-01  1.057e-02    73.361  &lt; 2e-16 ***
ORIGIN_SZWCSZ02 -1.969e+00  3.458e-02   -56.933  &lt; 2e-16 ***
ORIGIN_SZWCSZ03 -4.947e+00  1.475e-01   -33.537  &lt; 2e-16 ***
ORIGIN_SZWDSZ01  1.470e+00  4.756e-03   309.045  &lt; 2e-16 ***
ORIGIN_SZWDSZ02  9.234e-01  5.629e-03   164.045  &lt; 2e-16 ***
ORIGIN_SZWDSZ03  1.592e+00  5.240e-03   303.855  &lt; 2e-16 ***
ORIGIN_SZWDSZ04  1.241e+00  6.130e-03   202.440  &lt; 2e-16 ***
ORIGIN_SZWDSZ05  6.592e-01  6.241e-03   105.616  &lt; 2e-16 ***
ORIGIN_SZWDSZ06  8.079e-01  6.116e-03   132.099  &lt; 2e-16 ***
ORIGIN_SZWDSZ07 -6.073e-01  9.361e-03   -64.877  &lt; 2e-16 ***
ORIGIN_SZWDSZ08 -4.406e-01  9.667e-03   -45.582  &lt; 2e-16 ***
ORIGIN_SZWDSZ09  1.426e+00  5.228e-03   272.831  &lt; 2e-16 ***
ORIGIN_SZYSSZ01 -3.414e-01  6.960e-03   -49.052  &lt; 2e-16 ***
ORIGIN_SZYSSZ02  7.924e-01  5.899e-03   134.326  &lt; 2e-16 ***
ORIGIN_SZYSSZ03  1.789e+00  5.038e-03   355.014  &lt; 2e-16 ***
ORIGIN_SZYSSZ04  1.086e+00  5.301e-03   204.964  &lt; 2e-16 ***
ORIGIN_SZYSSZ05  2.719e-01  6.973e-03    38.991  &lt; 2e-16 ***
ORIGIN_SZYSSZ06 -4.010e-01  1.249e-02   -32.111  &lt; 2e-16 ***
ORIGIN_SZYSSZ07 -1.015e+00  1.559e-02   -65.119  &lt; 2e-16 ***
ORIGIN_SZYSSZ08  1.126e-01  7.095e-03    15.864  &lt; 2e-16 ***
ORIGIN_SZYSSZ09  1.124e+00  5.048e-03   222.620  &lt; 2e-16 ***
DESTIN_AGE7_12  -2.209e-04  8.376e-07  -263.710  &lt; 2e-16 ***
DESTIN_AGE13_24 -8.015e-05  6.370e-07  -125.824  &lt; 2e-16 ***
DESTIN_AGE25_64  5.898e-05  1.541e-07   382.728  &lt; 2e-16 ***
log(dist)       -1.696e+00  4.638e-04 -3657.649  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 36117615  on 14273  degrees of freedom
Residual deviance: 12373256  on 13991  degrees of freedom
AIC: 12458376

Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
<p>We can examine how the constraints hold for destinations this time.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CalcRSquared</span>(orcSIM2<span class="sc">$</span>data<span class="sc">$</span>TRIPS, orcSIM2<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4454161</code></pre>
</div>
</div>
</section>
<section id="destination-constrained" class="level3">
<h3 class="anchored" data-anchor-id="destination-constrained">Destination constrained</h3>
<p>In this section, we will fit a destination constrained SIM by using the code3 chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>decSIM <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> TRIPS <span class="sc">~</span> </span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>                DESTIN_SZ <span class="sc">+</span> </span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(ORIGIN_AGE25_64) <span class="sc">+</span> </span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(dist),</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> SIM_data,</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">na.action =</span> na.exclude)</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(decSIM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = TRIPS ~ DESTIN_SZ + log(ORIGIN_AGE25_64) + log(dist), 
    family = poisson(link = "log"), data = SIM_data, na.action = na.exclude)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-189.20   -15.64    -7.08     1.55   379.03  

Coefficients:
                       Estimate Std. Error   z value Pr(&gt;|z|)    
(Intercept)          19.4822997  0.0050784  3836.298  &lt; 2e-16 ***
DESTIN_SZAMSZ02       0.1263056  0.0049743    25.392  &lt; 2e-16 ***
DESTIN_SZAMSZ03       0.0421788  0.0049859     8.460  &lt; 2e-16 ***
DESTIN_SZAMSZ04      -1.1668479  0.0074254  -157.143  &lt; 2e-16 ***
DESTIN_SZAMSZ05      -1.2586639  0.0075854  -165.931  &lt; 2e-16 ***
DESTIN_SZAMSZ06      -1.1414791  0.0073474  -155.359  &lt; 2e-16 ***
DESTIN_SZAMSZ07      -1.5565804  0.0109476  -142.185  &lt; 2e-16 ***
DESTIN_SZAMSZ08      -0.3990754  0.0074159   -53.813  &lt; 2e-16 ***
DESTIN_SZAMSZ09      -1.0109118  0.0076802  -131.626  &lt; 2e-16 ***
DESTIN_SZAMSZ10       0.0159285  0.0051765     3.077  0.00209 ** 
DESTIN_SZAMSZ11      -0.3653273  0.0094866   -38.510  &lt; 2e-16 ***
DESTIN_SZAMSZ12       0.5297606  0.0053243    99.500  &lt; 2e-16 ***
DESTIN_SZBDSZ01       1.0394822  0.0044226   235.037  &lt; 2e-16 ***
DESTIN_SZBDSZ02       0.1956964  0.0059564    32.855  &lt; 2e-16 ***
DESTIN_SZBDSZ03       0.3209267  0.0053718    59.742  &lt; 2e-16 ***
DESTIN_SZBDSZ04       1.2429874  0.0043104   288.370  &lt; 2e-16 ***
DESTIN_SZBDSZ05       0.8535842  0.0046360   184.122  &lt; 2e-16 ***
DESTIN_SZBDSZ06       0.5181443  0.0053736    96.423  &lt; 2e-16 ***
DESTIN_SZBDSZ07      -0.5849371  0.0110468   -52.951  &lt; 2e-16 ***
DESTIN_SZBDSZ08      -1.2871050  0.0128623  -100.068  &lt; 2e-16 ***
DESTIN_SZBKSZ01      -1.0633560  0.0077771  -136.730  &lt; 2e-16 ***
DESTIN_SZBKSZ02      -0.4065316  0.0066712   -60.938  &lt; 2e-16 ***
DESTIN_SZBKSZ03      -0.6815674  0.0066509  -102.477  &lt; 2e-16 ***
DESTIN_SZBKSZ04      -0.4185485  0.0058306   -71.785  &lt; 2e-16 ***
DESTIN_SZBKSZ05      -0.8887654  0.0073867  -120.319  &lt; 2e-16 ***
DESTIN_SZBKSZ06      -0.9436078  0.0068625  -137.501  &lt; 2e-16 ***
DESTIN_SZBKSZ07      -0.0067325  0.0048408    -1.391  0.16430    
DESTIN_SZBKSZ08      -1.2680903  0.0079177  -160.160  &lt; 2e-16 ***
DESTIN_SZBKSZ09      -0.0350151  0.0054287    -6.450 1.12e-10 ***
DESTIN_SZBLSZ01      -0.3045203  0.0081978   -37.146  &lt; 2e-16 ***
DESTIN_SZBLSZ02       0.6432424  0.0074449    86.400  &lt; 2e-16 ***
DESTIN_SZBLSZ03       1.9595113  0.0084705   231.333  &lt; 2e-16 ***
DESTIN_SZBLSZ04       0.0149756  0.0172081     0.870  0.38415    
DESTIN_SZBMSZ01      -0.0378127  0.0055294    -6.838 8.00e-12 ***
DESTIN_SZBMSZ02      -0.8458055  0.0054043  -156.505  &lt; 2e-16 ***
DESTIN_SZBMSZ03      -1.1334399  0.0063720  -177.878  &lt; 2e-16 ***
DESTIN_SZBMSZ04      -1.1164759  0.0057743  -193.353  &lt; 2e-16 ***
DESTIN_SZBMSZ05      -1.1078742  0.0078703  -140.766  &lt; 2e-16 ***
DESTIN_SZBMSZ06      -2.2787234  0.0155126  -146.895  &lt; 2e-16 ***
DESTIN_SZBMSZ07      -0.2739089  0.0051924   -52.752  &lt; 2e-16 ***
DESTIN_SZBMSZ08      -1.6825978  0.0071842  -234.209  &lt; 2e-16 ***
DESTIN_SZBMSZ09      -3.0047801  0.0159980  -187.823  &lt; 2e-16 ***
DESTIN_SZBMSZ10      -2.2232689  0.0096907  -229.423  &lt; 2e-16 ***
DESTIN_SZBMSZ11      -1.9657136  0.0086445  -227.394  &lt; 2e-16 ***
DESTIN_SZBMSZ12      -1.5359286  0.0089658  -171.310  &lt; 2e-16 ***
DESTIN_SZBMSZ13      -0.5657561  0.0059960   -94.355  &lt; 2e-16 ***
DESTIN_SZBMSZ14      -1.6904858  0.0084858  -199.214  &lt; 2e-16 ***
DESTIN_SZBMSZ15      -1.5268383  0.0079959  -190.953  &lt; 2e-16 ***
DESTIN_SZBMSZ16      -2.2045600  0.0130872  -168.452  &lt; 2e-16 ***
DESTIN_SZBMSZ17      -2.2992381  0.0184895  -124.353  &lt; 2e-16 ***
DESTIN_SZBPSZ01      -0.8549497  0.0065168  -131.191  &lt; 2e-16 ***
DESTIN_SZBPSZ02      -1.7470549  0.0095751  -182.457  &lt; 2e-16 ***
DESTIN_SZBPSZ03      -1.4015145  0.0090888  -154.203  &lt; 2e-16 ***
DESTIN_SZBPSZ04      -0.5250632  0.0066496   -78.962  &lt; 2e-16 ***
DESTIN_SZBPSZ05       0.3413171  0.0046404    73.553  &lt; 2e-16 ***
DESTIN_SZBPSZ06      -0.8569188  0.0090795   -94.380  &lt; 2e-16 ***
DESTIN_SZBPSZ07      -0.0751284  0.0089704    -8.375  &lt; 2e-16 ***
DESTIN_SZBSSZ01       0.1015228  0.0055735    18.215  &lt; 2e-16 ***
DESTIN_SZBSSZ02      -0.7066412  0.0063845  -110.682  &lt; 2e-16 ***
DESTIN_SZBSSZ03       0.1622730  0.0046689    34.756  &lt; 2e-16 ***
DESTIN_SZBTSZ01       0.5470615  0.0047984   114.009  &lt; 2e-16 ***
DESTIN_SZBTSZ02      -0.1393371  0.0078266   -17.803  &lt; 2e-16 ***
DESTIN_SZBTSZ03       0.1474771  0.0059428    24.816  &lt; 2e-16 ***
DESTIN_SZBTSZ04      -1.2857827  0.0122000  -105.392  &lt; 2e-16 ***
DESTIN_SZBTSZ05      -0.2629188  0.0081769   -32.154  &lt; 2e-16 ***
DESTIN_SZBTSZ06      -0.8319920  0.0081401  -102.209  &lt; 2e-16 ***
DESTIN_SZBTSZ07      -1.8829448  0.0121227  -155.324  &lt; 2e-16 ***
DESTIN_SZBTSZ08      -1.5732123  0.0116752  -134.748  &lt; 2e-16 ***
DESTIN_SZCBSZ01      -3.5334327  0.3333510   -10.600  &lt; 2e-16 ***
DESTIN_SZCCSZ01      -0.2129306  0.0093782   -22.705  &lt; 2e-16 ***
DESTIN_SZCHSZ01      -0.1494972  0.0113078   -13.221  &lt; 2e-16 ***
DESTIN_SZCHSZ02       0.0041774  0.0063195     0.661  0.50860    
DESTIN_SZCHSZ03       2.5565450  0.0046495   549.857  &lt; 2e-16 ***
DESTIN_SZCKSZ01       0.0489719  0.0053801     9.102  &lt; 2e-16 ***
DESTIN_SZCKSZ02      -0.3548993  0.0060671   -58.496  &lt; 2e-16 ***
DESTIN_SZCKSZ03       0.5386351  0.0044913   119.928  &lt; 2e-16 ***
DESTIN_SZCKSZ04      -0.4425512  0.0073837   -59.936  &lt; 2e-16 ***
DESTIN_SZCKSZ05      -0.4092591  0.0077267   -52.967  &lt; 2e-16 ***
DESTIN_SZCKSZ06       0.2207041  0.0074252    29.724  &lt; 2e-16 ***
DESTIN_SZCLSZ01       0.2851460  0.0052362    54.457  &lt; 2e-16 ***
DESTIN_SZCLSZ02      -1.9270528  0.0147688  -130.482  &lt; 2e-16 ***
DESTIN_SZCLSZ03      -0.6266521  0.0086780   -72.212  &lt; 2e-16 ***
DESTIN_SZCLSZ04      -0.1335581  0.0054216   -24.634  &lt; 2e-16 ***
DESTIN_SZCLSZ05      -0.8912963  0.0096015   -92.829  &lt; 2e-16 ***
DESTIN_SZCLSZ06       0.1781234  0.0048150    36.993  &lt; 2e-16 ***
DESTIN_SZCLSZ07      -0.5609619  0.0062277   -90.075  &lt; 2e-16 ***
DESTIN_SZCLSZ08      -0.3875308  0.0068390   -56.665  &lt; 2e-16 ***
DESTIN_SZCLSZ09       0.2539453  0.0072623    34.968  &lt; 2e-16 ***
DESTIN_SZDTSZ02      -2.5036295  0.0373421   -67.046  &lt; 2e-16 ***
DESTIN_SZDTSZ03      -0.8956407  0.0149971   -59.721  &lt; 2e-16 ***
DESTIN_SZDTSZ13      -1.6562176  0.0175441   -94.403  &lt; 2e-16 ***
DESTIN_SZGLSZ01      -0.2716152  0.0056553   -48.029  &lt; 2e-16 ***
DESTIN_SZGLSZ02      -0.1735665  0.0055548   -31.246  &lt; 2e-16 ***
DESTIN_SZGLSZ03       0.7029507  0.0044934   156.441  &lt; 2e-16 ***
DESTIN_SZGLSZ04       0.5788027  0.0045449   127.351  &lt; 2e-16 ***
DESTIN_SZGLSZ05       0.6865291  0.0045131   152.118  &lt; 2e-16 ***
DESTIN_SZHGSZ01       0.3275950  0.0043866    74.681  &lt; 2e-16 ***
DESTIN_SZHGSZ02      -0.6326974  0.0063517   -99.610  &lt; 2e-16 ***
DESTIN_SZHGSZ03      -1.0597982  0.0073914  -143.382  &lt; 2e-16 ***
DESTIN_SZHGSZ04      -0.2267013  0.0052178   -43.448  &lt; 2e-16 ***
DESTIN_SZHGSZ05      -0.3063050  0.0055452   -55.238  &lt; 2e-16 ***
DESTIN_SZHGSZ06      -0.7483961  0.0065544  -114.182  &lt; 2e-16 ***
DESTIN_SZHGSZ07       0.1096958  0.0051309    21.379  &lt; 2e-16 ***
DESTIN_SZHGSZ08      -0.1374201  0.0056692   -24.240  &lt; 2e-16 ***
DESTIN_SZHGSZ09       0.0775400  0.0060230    12.874  &lt; 2e-16 ***
DESTIN_SZHGSZ10      -3.3017475  0.0289292  -114.132  &lt; 2e-16 ***
DESTIN_SZJESZ01      -0.0489065  0.0057246    -8.543  &lt; 2e-16 ***
DESTIN_SZJESZ02      -0.5101614  0.0060074   -84.921  &lt; 2e-16 ***
DESTIN_SZJESZ03      -0.5328921  0.0064129   -83.097  &lt; 2e-16 ***
DESTIN_SZJESZ04      -0.7348953  0.0082249   -89.351  &lt; 2e-16 ***
DESTIN_SZJESZ05      -1.0864570  0.0111740   -97.231  &lt; 2e-16 ***
DESTIN_SZJESZ06       0.2407920  0.0046801    51.451  &lt; 2e-16 ***
DESTIN_SZJESZ07      -1.1523093  0.0090103  -127.888  &lt; 2e-16 ***
DESTIN_SZJESZ08      -0.4627356  0.0094529   -48.952  &lt; 2e-16 ***
DESTIN_SZJESZ09       0.0528616  0.0068126     7.759 8.53e-15 ***
DESTIN_SZJESZ10       1.0240660  0.0084045   121.848  &lt; 2e-16 ***
DESTIN_SZJESZ11       0.7875517  0.0076251   103.284  &lt; 2e-16 ***
DESTIN_SZJWSZ01      -0.1533418  0.0076198   -20.124  &lt; 2e-16 ***
DESTIN_SZJWSZ02      -0.0011019  0.0059389    -0.186  0.85280    
DESTIN_SZJWSZ03       0.9063789  0.0046747   193.892  &lt; 2e-16 ***
DESTIN_SZJWSZ04       0.7019286  0.0049743   141.112  &lt; 2e-16 ***
DESTIN_SZJWSZ05      -0.5197057  0.0072971   -71.220  &lt; 2e-16 ***
DESTIN_SZJWSZ06       0.3350986  0.0061171    54.780  &lt; 2e-16 ***
DESTIN_SZJWSZ07      -0.5961960  0.0328336   -18.158  &lt; 2e-16 ***
DESTIN_SZJWSZ08       0.8054662  0.0056006   143.819  &lt; 2e-16 ***
DESTIN_SZJWSZ09       1.5860146  0.0040282   393.723  &lt; 2e-16 ***
DESTIN_SZKLSZ01      -0.6500838  0.0063560  -102.279  &lt; 2e-16 ***
DESTIN_SZKLSZ02      -0.7039434  0.0064465  -109.197  &lt; 2e-16 ***
DESTIN_SZKLSZ03      -1.1972384  0.0075577  -158.413  &lt; 2e-16 ***
DESTIN_SZKLSZ04      -1.7172228  0.0097573  -175.993  &lt; 2e-16 ***
DESTIN_SZKLSZ05      -0.6042386  0.0093730   -64.466  &lt; 2e-16 ***
DESTIN_SZKLSZ06      -3.0201496  0.0389503   -77.539  &lt; 2e-16 ***
DESTIN_SZKLSZ07      -1.1522413  0.0076607  -150.409  &lt; 2e-16 ***
DESTIN_SZKLSZ08      -0.6977825  0.0057610  -121.122  &lt; 2e-16 ***
DESTIN_SZLKSZ01      -0.6895952  0.0268661   -25.668  &lt; 2e-16 ***
DESTIN_SZMDSZ01      -0.7155951  0.0228203   -31.358  &lt; 2e-16 ***
DESTIN_SZMDSZ02      -0.8153643  0.0123003   -66.288  &lt; 2e-16 ***
DESTIN_SZMDSZ03      -2.7745226  0.0301326   -92.077  &lt; 2e-16 ***
DESTIN_SZMPSZ01      -0.5492095  0.0087198   -62.984  &lt; 2e-16 ***
DESTIN_SZMPSZ02      -0.6104744  0.0069346   -88.033  &lt; 2e-16 ***
DESTIN_SZMPSZ03       0.2775047  0.0054964    50.489  &lt; 2e-16 ***
DESTIN_SZMUSZ02      -2.6322870  0.0214943  -122.464  &lt; 2e-16 ***
DESTIN_SZNTSZ01      -4.0762008  0.0531046   -76.758  &lt; 2e-16 ***
DESTIN_SZNTSZ02      -1.9765545  0.0125659  -157.296  &lt; 2e-16 ***
DESTIN_SZNTSZ03      -1.4563069  0.0085433  -170.462  &lt; 2e-16 ***
DESTIN_SZNTSZ05      -2.0125598  0.0270737   -74.336  &lt; 2e-16 ***
DESTIN_SZNTSZ06      -3.0145357  0.0504986   -59.695  &lt; 2e-16 ***
DESTIN_SZNVSZ01      -0.4693625  0.0053866   -87.135  &lt; 2e-16 ***
DESTIN_SZNVSZ02      -0.4525631  0.0060428   -74.894  &lt; 2e-16 ***
DESTIN_SZNVSZ03      -0.4821492  0.0064725   -74.492  &lt; 2e-16 ***
DESTIN_SZNVSZ04      -1.8929756  0.0128397  -147.432  &lt; 2e-16 ***
DESTIN_SZNVSZ05      -1.4501752  0.0099737  -145.400  &lt; 2e-16 ***
DESTIN_SZPGSZ01      -1.2305867  0.0174321   -70.593  &lt; 2e-16 ***
DESTIN_SZPGSZ02      -0.8232919  0.0080153  -102.715  &lt; 2e-16 ***
DESTIN_SZPGSZ03       0.2138480  0.0050850    42.054  &lt; 2e-16 ***
DESTIN_SZPGSZ04       0.1045757  0.0053579    19.518  &lt; 2e-16 ***
DESTIN_SZPGSZ05      -0.7542450  0.0088883   -84.858  &lt; 2e-16 ***
DESTIN_SZPLSZ01      -0.0098642  0.0080428    -1.226  0.22003    
DESTIN_SZPLSZ02      -1.2630412  0.0152594   -82.771  &lt; 2e-16 ***
DESTIN_SZPLSZ03      -0.1554479  0.0108611   -14.312  &lt; 2e-16 ***
DESTIN_SZPLSZ04      -1.5505819  0.0114768  -135.105  &lt; 2e-16 ***
DESTIN_SZPLSZ05      -0.2417805  0.0130391   -18.543  &lt; 2e-16 ***
DESTIN_SZPNSZ01       0.7926715  0.0073628   107.659  &lt; 2e-16 ***
DESTIN_SZPNSZ02       2.1914920  0.0073537   298.013  &lt; 2e-16 ***
DESTIN_SZPNSZ03       1.0246845  0.0086874   117.951  &lt; 2e-16 ***
DESTIN_SZPNSZ04       2.5522612  0.0091789   278.057  &lt; 2e-16 ***
DESTIN_SZPNSZ05       1.7995301  0.0138562   129.872  &lt; 2e-16 ***
DESTIN_SZPRSZ01      -0.6576686  0.0096037   -68.481  &lt; 2e-16 ***
DESTIN_SZPRSZ02       0.3113532  0.0059851    52.021  &lt; 2e-16 ***
DESTIN_SZPRSZ03       0.9255296  0.0044779   206.687  &lt; 2e-16 ***
DESTIN_SZPRSZ04      -0.0028578  0.0093218    -0.307  0.75917    
DESTIN_SZPRSZ05       0.2457863  0.0058261    42.187  &lt; 2e-16 ***
DESTIN_SZPRSZ06       0.3692137  0.0064542    57.205  &lt; 2e-16 ***
DESTIN_SZPRSZ07      -1.6733306  0.0138440  -120.871  &lt; 2e-16 ***
DESTIN_SZPRSZ08      -0.2221048  0.0074846   -29.675  &lt; 2e-16 ***
DESTIN_SZQTSZ01      -1.0185488  0.0093179  -109.311  &lt; 2e-16 ***
DESTIN_SZQTSZ02      -1.2802688  0.0081670  -156.761  &lt; 2e-16 ***
DESTIN_SZQTSZ03      -1.3322708  0.0079106  -168.415  &lt; 2e-16 ***
DESTIN_SZQTSZ04      -1.1803631  0.0077366  -152.568  &lt; 2e-16 ***
DESTIN_SZQTSZ05      -1.2215818  0.0072829  -167.734  &lt; 2e-16 ***
DESTIN_SZQTSZ06      -1.3213145  0.0074858  -176.509  &lt; 2e-16 ***
DESTIN_SZQTSZ07      -1.6426306  0.0123347  -133.171  &lt; 2e-16 ***
DESTIN_SZQTSZ08      -0.2224169  0.0058405   -38.082  &lt; 2e-16 ***
DESTIN_SZQTSZ09      -0.8142678  0.0069796  -116.665  &lt; 2e-16 ***
DESTIN_SZQTSZ10      -0.1090496  0.0062573   -17.428  &lt; 2e-16 ***
DESTIN_SZQTSZ11      -0.0108951  0.0061145    -1.782  0.07477 .  
DESTIN_SZQTSZ12      -0.8582515  0.0090243   -95.105  &lt; 2e-16 ***
DESTIN_SZQTSZ13       0.1834409  0.0065231    28.122  &lt; 2e-16 ***
DESTIN_SZQTSZ14       0.1994454  0.0073615    27.093  &lt; 2e-16 ***
DESTIN_SZQTSZ15       0.6740197  0.0088699    75.990  &lt; 2e-16 ***
DESTIN_SZRCSZ01      -0.7746427  0.0079375   -97.593  &lt; 2e-16 ***
DESTIN_SZRCSZ06      -1.4394098  0.0209931   -68.566  &lt; 2e-16 ***
DESTIN_SZRVSZ01      -2.6060495  0.0175759  -148.274  &lt; 2e-16 ***
DESTIN_SZRVSZ02      -2.5823769  0.0354706   -72.803  &lt; 2e-16 ***
DESTIN_SZRVSZ03      -2.5890601  0.0152644  -169.614  &lt; 2e-16 ***
DESTIN_SZRVSZ04      -2.2277482  0.0165661  -134.477  &lt; 2e-16 ***
DESTIN_SZRVSZ05      -3.8610445  0.0298251  -129.456  &lt; 2e-16 ***
DESTIN_SZSBSZ01      -1.2035529  0.0103954  -115.777  &lt; 2e-16 ***
DESTIN_SZSBSZ02      -1.0267199  0.0085239  -120.452  &lt; 2e-16 ***
DESTIN_SZSBSZ03       0.5977382  0.0050336   118.750  &lt; 2e-16 ***
DESTIN_SZSBSZ04       0.5362769  0.0060573    88.534  &lt; 2e-16 ***
DESTIN_SZSBSZ05      -1.0440525  0.0089622  -116.495  &lt; 2e-16 ***
DESTIN_SZSBSZ06      -1.3939595  0.0246679   -56.509  &lt; 2e-16 ***
DESTIN_SZSBSZ07       0.1029116  0.0235414     4.372 1.23e-05 ***
DESTIN_SZSBSZ08       1.3564902  0.0060529   224.105  &lt; 2e-16 ***
DESTIN_SZSBSZ09       0.4573712  0.0056585    80.829  &lt; 2e-16 ***
DESTIN_SZSESZ02      -0.1553609  0.0056716   -27.393  &lt; 2e-16 ***
DESTIN_SZSESZ03       0.5412776  0.0043801   123.576  &lt; 2e-16 ***
DESTIN_SZSESZ04      -0.6382091  0.0065411   -97.568  &lt; 2e-16 ***
DESTIN_SZSESZ05      -0.3332093  0.0055002   -60.581  &lt; 2e-16 ***
DESTIN_SZSESZ06      -0.3085951  0.0072340   -42.659  &lt; 2e-16 ***
DESTIN_SZSESZ07      -2.6237684  0.0245753  -106.764  &lt; 2e-16 ***
DESTIN_SZSGSZ01      -0.1062372  0.0066634   -15.943  &lt; 2e-16 ***
DESTIN_SZSGSZ02      -0.0475568  0.0058908    -8.073 6.85e-16 ***
DESTIN_SZSGSZ03      -0.2118402  0.0055056   -38.477  &lt; 2e-16 ***
DESTIN_SZSGSZ04      -0.1099618  0.0054841   -20.051  &lt; 2e-16 ***
DESTIN_SZSGSZ05      -2.1556963  0.0113821  -189.394  &lt; 2e-16 ***
DESTIN_SZSGSZ06       0.4416352  0.0043842   100.734  &lt; 2e-16 ***
DESTIN_SZSGSZ07      -0.3949335  0.0059250   -66.655  &lt; 2e-16 ***
DESTIN_SZSISZ01      -1.2847094  0.0288610   -44.514  &lt; 2e-16 ***
DESTIN_SZSKSZ01       0.3089834  0.0082924    37.261  &lt; 2e-16 ***
DESTIN_SZSKSZ02       1.4139309  0.0059981   235.729  &lt; 2e-16 ***
DESTIN_SZSKSZ03       0.2427688  0.0067373    36.034  &lt; 2e-16 ***
DESTIN_SZSKSZ04      -0.2527488  0.0161286   -15.671  &lt; 2e-16 ***
DESTIN_SZSKSZ05       0.6046051  0.0122766    49.249  &lt; 2e-16 ***
DESTIN_SZSLSZ01      -0.3927387  0.0099790   -39.356  &lt; 2e-16 ***
DESTIN_SZSLSZ04      -0.5942110  0.0086225   -68.914  &lt; 2e-16 ***
DESTIN_SZSRSZ01      -2.6855766  0.0138707  -193.615  &lt; 2e-16 ***
DESTIN_SZTHSZ01      -3.2750084  0.0402668   -81.333  &lt; 2e-16 ***
DESTIN_SZTHSZ03      -1.7964408  0.0261810   -68.616  &lt; 2e-16 ***
DESTIN_SZTHSZ04      -2.6323994  0.0241831  -108.853  &lt; 2e-16 ***
DESTIN_SZTHSZ06      -1.9444390  0.0166052  -117.098  &lt; 2e-16 ***
DESTIN_SZTMSZ01       0.3856054  0.0063086    61.123  &lt; 2e-16 ***
DESTIN_SZTMSZ02       1.8586526  0.0039229   473.790  &lt; 2e-16 ***
DESTIN_SZTMSZ03       1.2601385  0.0044018   286.278  &lt; 2e-16 ***
DESTIN_SZTMSZ04       1.5884327  0.0043362   366.316  &lt; 2e-16 ***
DESTIN_SZTMSZ05       1.0377553  0.0063271   164.018  &lt; 2e-16 ***
DESTIN_SZTNSZ01      -0.9954275  0.0080345  -123.895  &lt; 2e-16 ***
DESTIN_SZTNSZ02      -2.1032696  0.0109228  -192.557  &lt; 2e-16 ***
DESTIN_SZTNSZ03      -2.0044892  0.0129215  -155.128  &lt; 2e-16 ***
DESTIN_SZTNSZ04      -0.9750326  0.0081677  -119.377  &lt; 2e-16 ***
DESTIN_SZTPSZ01      -0.7788383  0.0068769  -113.254  &lt; 2e-16 ***
DESTIN_SZTPSZ02       0.2866080  0.0042843    66.898  &lt; 2e-16 ***
DESTIN_SZTPSZ03      -0.8749841  0.0065470  -133.646  &lt; 2e-16 ***
DESTIN_SZTPSZ04      -1.6852792  0.0081488  -206.812  &lt; 2e-16 ***
DESTIN_SZTPSZ05      -1.3721346  0.0068230  -201.104  &lt; 2e-16 ***
DESTIN_SZTPSZ06      -0.7832133  0.0069164  -113.239  &lt; 2e-16 ***
DESTIN_SZTPSZ07      -2.3109126  0.0130830  -176.635  &lt; 2e-16 ***
DESTIN_SZTPSZ08      -1.6406531  0.0104897  -156.406  &lt; 2e-16 ***
DESTIN_SZTPSZ09      -0.5636273  0.0076848   -73.343  &lt; 2e-16 ***
DESTIN_SZTPSZ10      -1.5640843  0.0099984  -156.433  &lt; 2e-16 ***
DESTIN_SZTPSZ11      -0.3700482  0.0059834   -61.846  &lt; 2e-16 ***
DESTIN_SZTPSZ12      -0.8828228  0.0072302  -122.102  &lt; 2e-16 ***
DESTIN_SZTSSZ01       0.3529526  0.0221887    15.907  &lt; 2e-16 ***
DESTIN_SZTSSZ02       1.0265792  0.0153515    66.871  &lt; 2e-16 ***
DESTIN_SZTSSZ03       1.9647347  0.0092388   212.662  &lt; 2e-16 ***
DESTIN_SZTSSZ04       1.8649836  0.0089976   207.275  &lt; 2e-16 ***
DESTIN_SZTSSZ05       2.8437058  0.0085738   331.673  &lt; 2e-16 ***
DESTIN_SZTSSZ06       3.4238870  0.0161304   212.263  &lt; 2e-16 ***
DESTIN_SZWCSZ01       2.9550693  0.0051690   571.689  &lt; 2e-16 ***
DESTIN_SZWCSZ02      -0.8214103  0.0129213   -63.570  &lt; 2e-16 ***
DESTIN_SZWCSZ03      -1.7393427  0.0347472   -50.057  &lt; 2e-16 ***
DESTIN_SZWDSZ01       1.3424417  0.0039957   335.972  &lt; 2e-16 ***
DESTIN_SZWDSZ02      -0.2103694  0.0068601   -30.666  &lt; 2e-16 ***
DESTIN_SZWDSZ03       0.8268551  0.0051363   160.983  &lt; 2e-16 ***
DESTIN_SZWDSZ04      -0.0643997  0.0079076    -8.144 3.82e-16 ***
DESTIN_SZWDSZ05       0.0451985  0.0075732     5.968 2.40e-09 ***
DESTIN_SZWDSZ06       0.6981330  0.0051936   134.423  &lt; 2e-16 ***
DESTIN_SZWDSZ07      -0.0403233  0.0067749    -5.952 2.65e-09 ***
DESTIN_SZWDSZ08       0.2850631  0.0069225    41.179  &lt; 2e-16 ***
DESTIN_SZWDSZ09       1.3016106  0.0050365   258.433  &lt; 2e-16 ***
DESTIN_SZYSSZ01       0.7598564  0.0044144   172.133  &lt; 2e-16 ***
DESTIN_SZYSSZ02       0.2648061  0.0058239    45.469  &lt; 2e-16 ***
DESTIN_SZYSSZ03      -0.0412163  0.0068337    -6.031 1.63e-09 ***
DESTIN_SZYSSZ04      -0.0561054  0.0060829    -9.223  &lt; 2e-16 ***
DESTIN_SZYSSZ05      -0.9970159  0.0121827   -81.839  &lt; 2e-16 ***
DESTIN_SZYSSZ06      -1.3808376  0.0125738  -109.819  &lt; 2e-16 ***
DESTIN_SZYSSZ07      -0.7128364  0.0165296   -43.125  &lt; 2e-16 ***
DESTIN_SZYSSZ08       0.9409510  0.0045886   205.064  &lt; 2e-16 ***
DESTIN_SZYSSZ09       0.3738436  0.0047971    77.930  &lt; 2e-16 ***
log(ORIGIN_AGE25_64)  0.1928847  0.0001667  1157.214  &lt; 2e-16 ***
log(dist)            -1.7828141  0.0004794 -3718.501  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 36117615  on 14273  degrees of freedom
Residual deviance: 12319763  on 13992  degrees of freedom
AIC: 12404881

Number of Fisher Scoring iterations: 7</code></pre>
</div>
</div>
<p>We can examine how the constraints hold for destinations this time.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CalcRSquared</span>(decSIM<span class="sc">$</span>data<span class="sc">$</span>TRIPS, decSIM<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.496166</code></pre>
</div>
</div>
</section>
<section id="doubly-constrained" class="level3">
<h3 class="anchored" data-anchor-id="doubly-constrained">Doubly constrained</h3>
<p>In this section, we will fit a doubly constrained SIM by using the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>dbcSIM <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> TRIPS <span class="sc">~</span> </span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>                ORIGIN_SZ <span class="sc">+</span> </span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>                DESTIN_SZ <span class="sc">+</span> </span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(dist),</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> SIM_data,</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">na.action =</span> na.exclude)</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dbcSIM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = TRIPS ~ ORIGIN_SZ + DESTIN_SZ + log(dist), family = poisson(link = "log"), 
    data = SIM_data, na.action = na.exclude)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-159.373   -12.413    -4.694     2.892   270.252  

Coefficients:
                  Estimate Std. Error   z value Pr(&gt;|z|)    
(Intercept)     21.9587595  0.0066831  3285.715  &lt; 2e-16 ***
ORIGIN_SZAMSZ02  0.4778050  0.0054127    88.275  &lt; 2e-16 ***
ORIGIN_SZAMSZ03  0.2895973  0.0055517    52.163  &lt; 2e-16 ***
ORIGIN_SZAMSZ04 -0.2628080  0.0060720   -43.282  &lt; 2e-16 ***
ORIGIN_SZAMSZ05 -0.2631404  0.0069008   -38.132  &lt; 2e-16 ***
ORIGIN_SZAMSZ06  0.1722337  0.0062028    27.767  &lt; 2e-16 ***
ORIGIN_SZAMSZ07 -0.9883200  0.0111224   -88.859  &lt; 2e-16 ***
ORIGIN_SZAMSZ08 -0.4052821  0.0104095   -38.934  &lt; 2e-16 ***
ORIGIN_SZAMSZ09  0.0356290  0.0064816     5.497 3.86e-08 ***
ORIGIN_SZAMSZ10  0.4815569  0.0055521    86.735  &lt; 2e-16 ***
ORIGIN_SZAMSZ11 -1.4440079  0.0146079   -98.851  &lt; 2e-16 ***
ORIGIN_SZAMSZ12 -1.7862677  0.0128071  -139.475  &lt; 2e-16 ***
ORIGIN_SZBDSZ01  0.8653749  0.0054381   159.132  &lt; 2e-16 ***
ORIGIN_SZBDSZ02  0.0841000  0.0062834    13.385  &lt; 2e-16 ***
ORIGIN_SZBDSZ03  0.3158343  0.0057510    54.918  &lt; 2e-16 ***
ORIGIN_SZBDSZ04  1.4556701  0.0049986   291.215  &lt; 2e-16 ***
ORIGIN_SZBDSZ05  0.6363125  0.0057193   111.257  &lt; 2e-16 ***
ORIGIN_SZBDSZ06  0.6749341  0.0058650   115.078  &lt; 2e-16 ***
ORIGIN_SZBDSZ07 -1.2176407  0.0113698  -107.095  &lt; 2e-16 ***
ORIGIN_SZBDSZ08 -0.9803580  0.0105604   -92.833  &lt; 2e-16 ***
ORIGIN_SZBKSZ01 -0.2919642  0.0080763   -36.151  &lt; 2e-16 ***
ORIGIN_SZBKSZ02  0.4609570  0.0067997    67.791  &lt; 2e-16 ***
ORIGIN_SZBKSZ03  0.6273448  0.0065989    95.068  &lt; 2e-16 ***
ORIGIN_SZBKSZ04 -0.2499063  0.0076555   -32.644  &lt; 2e-16 ***
ORIGIN_SZBKSZ05 -0.2628428  0.0078905   -33.311  &lt; 2e-16 ***
ORIGIN_SZBKSZ06 -0.2174034  0.0075134   -28.936  &lt; 2e-16 ***
ORIGIN_SZBKSZ07  0.7094093  0.0058574   121.114  &lt; 2e-16 ***
ORIGIN_SZBKSZ08 -0.1614362  0.0067626   -23.872  &lt; 2e-16 ***
ORIGIN_SZBKSZ09 -0.2739085  0.0072969   -37.537  &lt; 2e-16 ***
ORIGIN_SZBLSZ01 -2.4281074  0.0181172  -134.022  &lt; 2e-16 ***
ORIGIN_SZBLSZ02 -2.7305447  0.0219341  -124.489  &lt; 2e-16 ***
ORIGIN_SZBLSZ03 -3.3071431  0.0540398   -61.198  &lt; 2e-16 ***
ORIGIN_SZBLSZ04 -2.4550671  0.0263946   -93.014  &lt; 2e-16 ***
ORIGIN_SZBMSZ01  0.1198976  0.0065964    18.176  &lt; 2e-16 ***
ORIGIN_SZBMSZ02 -1.3908667  0.0083230  -167.112  &lt; 2e-16 ***
ORIGIN_SZBMSZ03 -0.6999122  0.0069754  -100.339  &lt; 2e-16 ***
ORIGIN_SZBMSZ04 -0.2691159  0.0066184   -40.662  &lt; 2e-16 ***
ORIGIN_SZBMSZ05 -2.6163780  0.0190989  -136.991  &lt; 2e-16 ***
ORIGIN_SZBMSZ06 -2.9729956  0.0197182  -150.774  &lt; 2e-16 ***
ORIGIN_SZBMSZ07 -0.7309916  0.0072407  -100.956  &lt; 2e-16 ***
ORIGIN_SZBMSZ08 -1.0019514  0.0073169  -136.936  &lt; 2e-16 ***
ORIGIN_SZBMSZ09 -1.3667460  0.0105325  -129.764  &lt; 2e-16 ***
ORIGIN_SZBMSZ10 -1.6907268  0.0106687  -158.476  &lt; 2e-16 ***
ORIGIN_SZBMSZ11 -1.2288802  0.0082919  -148.202  &lt; 2e-16 ***
ORIGIN_SZBMSZ12 -1.6517767  0.0115101  -143.507  &lt; 2e-16 ***
ORIGIN_SZBMSZ13 -0.7251351  0.0075289   -96.314  &lt; 2e-16 ***
ORIGIN_SZBMSZ14 -1.1534912  0.0082629  -139.599  &lt; 2e-16 ***
ORIGIN_SZBMSZ15 -0.5476774  0.0075710   -72.339  &lt; 2e-16 ***
ORIGIN_SZBMSZ16 -1.5195034  0.0111459  -136.329  &lt; 2e-16 ***
ORIGIN_SZBMSZ17 -1.6026767  0.0184419   -86.904  &lt; 2e-16 ***
ORIGIN_SZBPSZ01  0.5571291  0.0071866    77.523  &lt; 2e-16 ***
ORIGIN_SZBPSZ02  0.0523197  0.0082259     6.360 2.01e-10 ***
ORIGIN_SZBPSZ03  0.2942047  0.0080482    36.555  &lt; 2e-16 ***
ORIGIN_SZBPSZ04  0.6246296  0.0065878    94.816  &lt; 2e-16 ***
ORIGIN_SZBPSZ05  0.8663708  0.0060852   142.372  &lt; 2e-16 ***
ORIGIN_SZBPSZ06 -0.9896182  0.0109551   -90.334  &lt; 2e-16 ***
ORIGIN_SZBPSZ07 -0.5219250  0.0101830   -51.255  &lt; 2e-16 ***
ORIGIN_SZBSSZ01  0.3299588  0.0066440    49.663  &lt; 2e-16 ***
ORIGIN_SZBSSZ02  0.2851357  0.0057077    49.956  &lt; 2e-16 ***
ORIGIN_SZBSSZ03 -0.2084740  0.0063364   -32.901  &lt; 2e-16 ***
ORIGIN_SZBTSZ01  0.1425664  0.0071103    20.051  &lt; 2e-16 ***
ORIGIN_SZBTSZ02 -0.5591999  0.0093616   -59.733  &lt; 2e-16 ***
ORIGIN_SZBTSZ03 -0.3648190  0.0081677   -44.666  &lt; 2e-16 ***
ORIGIN_SZBTSZ04 -1.4555078  0.0120138  -121.152  &lt; 2e-16 ***
ORIGIN_SZBTSZ05 -0.8635510  0.0133848   -64.517  &lt; 2e-16 ***
ORIGIN_SZBTSZ06 -1.1383111  0.0106421  -106.963  &lt; 2e-16 ***
ORIGIN_SZBTSZ07 -2.3477669  0.0160858  -145.953  &lt; 2e-16 ***
ORIGIN_SZBTSZ08 -1.2918779  0.0124862  -103.464  &lt; 2e-16 ***
ORIGIN_SZCBSZ01 -3.3713588  0.0578683   -58.259  &lt; 2e-16 ***
ORIGIN_SZCCSZ01 -0.6029242  0.0153385   -39.308  &lt; 2e-16 ***
ORIGIN_SZCHSZ01 -0.7641380  0.0135100   -56.561  &lt; 2e-16 ***
ORIGIN_SZCHSZ02 -0.8400736  0.0101951   -82.400  &lt; 2e-16 ***
ORIGIN_SZCHSZ03  1.2753127  0.0072576   175.720  &lt; 2e-16 ***
ORIGIN_SZCKSZ01  0.2470943  0.0067135    36.806  &lt; 2e-16 ***
ORIGIN_SZCKSZ02  0.5793581  0.0070498    82.181  &lt; 2e-16 ***
ORIGIN_SZCKSZ03  1.0795767  0.0060642   178.025  &lt; 2e-16 ***
ORIGIN_SZCKSZ04  1.4947920  0.0063122   236.808  &lt; 2e-16 ***
ORIGIN_SZCKSZ05  0.7457580  0.0074071   100.681  &lt; 2e-16 ***
ORIGIN_SZCKSZ06  0.5760952  0.0094861    60.730  &lt; 2e-16 ***
ORIGIN_SZCLSZ01 -0.9061335  0.0098617   -91.884  &lt; 2e-16 ***
ORIGIN_SZCLSZ02 -1.7609479  0.0156124  -112.791  &lt; 2e-16 ***
ORIGIN_SZCLSZ03 -1.0081325  0.0095171  -105.929  &lt; 2e-16 ***
ORIGIN_SZCLSZ04  0.6181200  0.0057953   106.659  &lt; 2e-16 ***
ORIGIN_SZCLSZ05 -2.0462335  0.0168934  -121.127  &lt; 2e-16 ***
ORIGIN_SZCLSZ06  0.7902389  0.0055680   141.924  &lt; 2e-16 ***
ORIGIN_SZCLSZ07 -0.5472929  0.0071001   -77.082  &lt; 2e-16 ***
ORIGIN_SZCLSZ08 -0.2197650  0.0077460   -28.372  &lt; 2e-16 ***
ORIGIN_SZCLSZ09 -1.8175782  0.0195989   -92.739  &lt; 2e-16 ***
ORIGIN_SZDTSZ02 -3.7618796  0.0872098   -43.136  &lt; 2e-16 ***
ORIGIN_SZDTSZ03 -3.4514766  0.0840812   -41.049  &lt; 2e-16 ***
ORIGIN_SZDTSZ13 -3.0627578  0.0352485   -86.891  &lt; 2e-16 ***
ORIGIN_SZGLSZ01 -1.8055929  0.0111938  -161.303  &lt; 2e-16 ***
ORIGIN_SZGLSZ02 -0.1588829  0.0061413   -25.871  &lt; 2e-16 ***
ORIGIN_SZGLSZ03 -0.2508524  0.0064276   -39.027  &lt; 2e-16 ***
ORIGIN_SZGLSZ04  0.8819358  0.0051993   169.627  &lt; 2e-16 ***
ORIGIN_SZGLSZ05  0.6062778  0.0053735   112.828  &lt; 2e-16 ***
ORIGIN_SZHGSZ01  0.3841503  0.0056776    67.660  &lt; 2e-16 ***
ORIGIN_SZHGSZ02  0.3962330  0.0057579    68.815  &lt; 2e-16 ***
ORIGIN_SZHGSZ03  0.2159531  0.0061671    35.017  &lt; 2e-16 ***
ORIGIN_SZHGSZ04  0.7831941  0.0052216   149.992  &lt; 2e-16 ***
ORIGIN_SZHGSZ05  1.1741558  0.0051799   226.677  &lt; 2e-16 ***
ORIGIN_SZHGSZ06 -0.1891403  0.0065556   -28.852  &lt; 2e-16 ***
ORIGIN_SZHGSZ07  0.3105421  0.0057186    54.304  &lt; 2e-16 ***
ORIGIN_SZHGSZ08 -0.0766364  0.0063474   -12.074  &lt; 2e-16 ***
ORIGIN_SZHGSZ09 -1.2211107  0.0101434  -120.384  &lt; 2e-16 ***
ORIGIN_SZHGSZ10 -3.4844709  0.0504793   -69.028  &lt; 2e-16 ***
ORIGIN_SZJESZ01  0.4916496  0.0063444    77.493  &lt; 2e-16 ***
ORIGIN_SZJESZ02  0.1343893  0.0063762    21.077  &lt; 2e-16 ***
ORIGIN_SZJESZ03 -0.2761723  0.0068085   -40.563  &lt; 2e-16 ***
ORIGIN_SZJESZ04 -1.5932744  0.0121402  -131.240  &lt; 2e-16 ***
ORIGIN_SZJESZ05 -2.3041311  0.0160245  -143.788  &lt; 2e-16 ***
ORIGIN_SZJESZ06  0.2811076  0.0062495    44.981  &lt; 2e-16 ***
ORIGIN_SZJESZ07 -1.9413956  0.0136276  -142.461  &lt; 2e-16 ***
ORIGIN_SZJESZ08 -1.3315645  0.0143168   -93.007  &lt; 2e-16 ***
ORIGIN_SZJESZ09  0.4418314  0.0069208    63.841  &lt; 2e-16 ***
ORIGIN_SZJESZ10 -1.5551555  0.0236523   -65.751  &lt; 2e-16 ***
ORIGIN_SZJESZ11 -1.8888230  0.0224630   -84.086  &lt; 2e-16 ***
ORIGIN_SZJWSZ01  0.2564586  0.0084699    30.279  &lt; 2e-16 ***
ORIGIN_SZJWSZ02  0.6899398  0.0061751   111.729  &lt; 2e-16 ***
ORIGIN_SZJWSZ03  1.4761229  0.0057392   257.198  &lt; 2e-16 ***
ORIGIN_SZJWSZ04  0.5701272  0.0065749    86.713  &lt; 2e-16 ***
ORIGIN_SZJWSZ05 -2.1253657  0.0150769  -140.968  &lt; 2e-16 ***
ORIGIN_SZJWSZ06 -1.5307265  0.0131906  -116.047  &lt; 2e-16 ***
ORIGIN_SZJWSZ07 -2.8801618  0.0360772   -79.833  &lt; 2e-16 ***
ORIGIN_SZJWSZ08  1.4428820  0.0059638   241.938  &lt; 2e-16 ***
ORIGIN_SZJWSZ09  1.8968475  0.0055649   340.860  &lt; 2e-16 ***
ORIGIN_SZKLSZ01  0.1116580  0.0059844    18.658  &lt; 2e-16 ***
ORIGIN_SZKLSZ02 -0.9618787  0.0077344  -124.364  &lt; 2e-16 ***
ORIGIN_SZKLSZ03 -0.7070626  0.0070275  -100.613  &lt; 2e-16 ***
ORIGIN_SZKLSZ04 -2.2742765  0.0139991  -162.459  &lt; 2e-16 ***
ORIGIN_SZKLSZ05 -1.1907262  0.0123719   -96.244  &lt; 2e-16 ***
ORIGIN_SZKLSZ06 -5.9774897  0.1857994   -32.172  &lt; 2e-16 ***
ORIGIN_SZKLSZ07 -1.4258369  0.0103083  -138.320  &lt; 2e-16 ***
ORIGIN_SZKLSZ08 -1.7625888  0.0116107  -151.808  &lt; 2e-16 ***
ORIGIN_SZLKSZ01 -2.0541388  0.0448216   -45.829  &lt; 2e-16 ***
ORIGIN_SZMDSZ01 -0.8571117  0.0321054   -26.697  &lt; 2e-16 ***
ORIGIN_SZMDSZ02 -0.6034597  0.0120724   -49.987  &lt; 2e-16 ***
ORIGIN_SZMDSZ03 -2.1681163  0.0201078  -107.825  &lt; 2e-16 ***
ORIGIN_SZMPSZ01 -0.9331562  0.0096218   -96.984  &lt; 2e-16 ***
ORIGIN_SZMPSZ02 -1.0268229  0.0081379  -126.178  &lt; 2e-16 ***
ORIGIN_SZMPSZ03  0.0054001  0.0066875     0.807 0.419385    
ORIGIN_SZMUSZ02 -3.6269863  0.1105492   -32.809  &lt; 2e-16 ***
ORIGIN_SZNTSZ01 -3.0593717  0.0399843   -76.514  &lt; 2e-16 ***
ORIGIN_SZNTSZ02 -3.3331415  0.0251754  -132.397  &lt; 2e-16 ***
ORIGIN_SZNTSZ03 -0.8351522  0.0090372   -92.413  &lt; 2e-16 ***
ORIGIN_SZNTSZ05 -4.2082472  0.0583343   -72.140  &lt; 2e-16 ***
ORIGIN_SZNTSZ06 -3.8549296  0.0593793   -64.920  &lt; 2e-16 ***
ORIGIN_SZNVSZ01  0.2789069  0.0056024    49.784  &lt; 2e-16 ***
ORIGIN_SZNVSZ02 -0.6036857  0.0077126   -78.273  &lt; 2e-16 ***
ORIGIN_SZNVSZ03 -1.0072683  0.0092678  -108.685  &lt; 2e-16 ***
ORIGIN_SZNVSZ04 -0.8723996  0.0101399   -86.037  &lt; 2e-16 ***
ORIGIN_SZNVSZ05 -2.1552928  0.0183064  -117.734  &lt; 2e-16 ***
ORIGIN_SZPGSZ01  0.0520607  0.0157846     3.298 0.000973 ***
ORIGIN_SZPGSZ02 -0.3481687  0.0089328   -38.976  &lt; 2e-16 ***
ORIGIN_SZPGSZ03  0.9095292  0.0058835   154.590  &lt; 2e-16 ***
ORIGIN_SZPGSZ04  1.3653717  0.0054727   249.489  &lt; 2e-16 ***
ORIGIN_SZPGSZ05  0.3762720  0.0073841    50.957  &lt; 2e-16 ***
ORIGIN_SZPLSZ01 -0.9142754  0.0136552   -66.954  &lt; 2e-16 ***
ORIGIN_SZPLSZ02 -1.0987582  0.0175891   -62.468  &lt; 2e-16 ***
ORIGIN_SZPLSZ03 -2.3427113  0.0474176   -49.406  &lt; 2e-16 ***
ORIGIN_SZPLSZ04 -2.9140779  0.0374458   -77.821  &lt; 2e-16 ***
ORIGIN_SZPLSZ05 -2.2381965  0.0261572   -85.567  &lt; 2e-16 ***
ORIGIN_SZPNSZ01  0.9659006  0.0075177   128.484  &lt; 2e-16 ***
ORIGIN_SZPNSZ02 -0.0158348  0.0143869    -1.101 0.271053    
ORIGIN_SZPNSZ03 -2.1837321  0.0224396   -97.316  &lt; 2e-16 ***
ORIGIN_SZPNSZ04 -3.2481509  0.0370762   -87.608  &lt; 2e-16 ***
ORIGIN_SZPNSZ05 -2.0450679  0.0328165   -62.318  &lt; 2e-16 ***
ORIGIN_SZPRSZ01 -0.6701245  0.0141567   -47.336  &lt; 2e-16 ***
ORIGIN_SZPRSZ02  0.7931907  0.0058079   136.570  &lt; 2e-16 ***
ORIGIN_SZPRSZ03  0.4249094  0.0058610    72.498  &lt; 2e-16 ***
ORIGIN_SZPRSZ04 -0.8529967  0.0090997   -93.739  &lt; 2e-16 ***
ORIGIN_SZPRSZ05  0.7865479  0.0055282   142.278  &lt; 2e-16 ***
ORIGIN_SZPRSZ06 -1.3303664  0.0134512   -98.903  &lt; 2e-16 ***
ORIGIN_SZPRSZ07 -3.0458370  0.0181514  -167.802  &lt; 2e-16 ***
ORIGIN_SZPRSZ08 -0.5342399  0.0075966   -70.327  &lt; 2e-16 ***
ORIGIN_SZQTSZ01 -0.2548930  0.0086485   -29.473  &lt; 2e-16 ***
ORIGIN_SZQTSZ02 -0.8662439  0.0076549  -113.162  &lt; 2e-16 ***
ORIGIN_SZQTSZ03 -0.0890168  0.0072455   -12.286  &lt; 2e-16 ***
ORIGIN_SZQTSZ04 -1.4634370  0.0089384  -163.724  &lt; 2e-16 ***
ORIGIN_SZQTSZ05 -0.6535669  0.0077612   -84.210  &lt; 2e-16 ***
ORIGIN_SZQTSZ06 -0.8275765  0.0081835  -101.128  &lt; 2e-16 ***
ORIGIN_SZQTSZ07 -1.5369800  0.0112808  -136.248  &lt; 2e-16 ***
ORIGIN_SZQTSZ08 -0.4437979  0.0075302   -58.936  &lt; 2e-16 ***
ORIGIN_SZQTSZ09 -0.8184934  0.0083589   -97.918  &lt; 2e-16 ***
ORIGIN_SZQTSZ10 -0.6906597  0.0080980   -85.288  &lt; 2e-16 ***
ORIGIN_SZQTSZ11 -2.3251162  0.0154191  -150.795  &lt; 2e-16 ***
ORIGIN_SZQTSZ12 -3.0442790  0.0208985  -145.670  &lt; 2e-16 ***
ORIGIN_SZQTSZ13 -0.7241013  0.0093441   -77.493  &lt; 2e-16 ***
ORIGIN_SZQTSZ14 -1.8225351  0.0138207  -131.870  &lt; 2e-16 ***
ORIGIN_SZQTSZ15 -0.8720806  0.0138589   -62.926  &lt; 2e-16 ***
ORIGIN_SZRCSZ01 -1.8063415  0.0144295  -125.184  &lt; 2e-16 ***
ORIGIN_SZRCSZ06 -0.5370905  0.0101573   -52.877  &lt; 2e-16 ***
ORIGIN_SZRVSZ01 -2.7426167  0.0341386   -80.338  &lt; 2e-16 ***
ORIGIN_SZRVSZ02 -3.0827269  0.0302299  -101.976  &lt; 2e-16 ***
ORIGIN_SZRVSZ03 -2.9133853  0.0262543  -110.968  &lt; 2e-16 ***
ORIGIN_SZRVSZ04 -3.4220022  0.0582209   -58.776  &lt; 2e-16 ***
ORIGIN_SZRVSZ05 -2.6206257  0.0197470  -132.710  &lt; 2e-16 ***
ORIGIN_SZSBSZ01  0.1010337  0.0085117    11.870  &lt; 2e-16 ***
ORIGIN_SZSBSZ02 -0.8810456  0.0098244   -89.680  &lt; 2e-16 ***
ORIGIN_SZSBSZ03  0.8303668  0.0063009   131.785  &lt; 2e-16 ***
ORIGIN_SZSBSZ04  0.3489128  0.0071456    48.829  &lt; 2e-16 ***
ORIGIN_SZSBSZ05 -0.3182914  0.0085560   -37.201  &lt; 2e-16 ***
ORIGIN_SZSBSZ06 -0.9074308  0.0200035   -45.364  &lt; 2e-16 ***
ORIGIN_SZSBSZ07 -0.2217124  0.0167188   -13.261  &lt; 2e-16 ***
ORIGIN_SZSBSZ08 -1.3007367  0.0178771   -72.760  &lt; 2e-16 ***
ORIGIN_SZSBSZ09 -0.9813703  0.0107885   -90.965  &lt; 2e-16 ***
ORIGIN_SZSESZ02  1.1283424  0.0054209   208.146  &lt; 2e-16 ***
ORIGIN_SZSESZ03  1.2389996  0.0051926   238.610  &lt; 2e-16 ***
ORIGIN_SZSESZ04  0.7535119  0.0060371   124.814  &lt; 2e-16 ***
ORIGIN_SZSESZ05 -0.2347978  0.0071482   -32.847  &lt; 2e-16 ***
ORIGIN_SZSESZ06  0.9520620  0.0057572   165.368  &lt; 2e-16 ***
ORIGIN_SZSESZ07 -2.4296685  0.0231677  -104.873  &lt; 2e-16 ***
ORIGIN_SZSGSZ01 -0.6995899  0.0099969   -69.980  &lt; 2e-16 ***
ORIGIN_SZSGSZ02 -1.2602157  0.0111471  -113.053  &lt; 2e-16 ***
ORIGIN_SZSGSZ03  0.0725860  0.0061970    11.713  &lt; 2e-16 ***
ORIGIN_SZSGSZ04  0.2738315  0.0057524    47.603  &lt; 2e-16 ***
ORIGIN_SZSGSZ05 -2.0207710  0.0119838  -168.625  &lt; 2e-16 ***
ORIGIN_SZSGSZ06  0.4885608  0.0054646    89.404  &lt; 2e-16 ***
ORIGIN_SZSGSZ07 -0.8892155  0.0075074  -118.445  &lt; 2e-16 ***
ORIGIN_SZSKSZ01 -0.3682754  0.0108025   -34.092  &lt; 2e-16 ***
ORIGIN_SZSKSZ02  1.1826086  0.0071388   165.659  &lt; 2e-16 ***
ORIGIN_SZSKSZ03 -0.3230177  0.0101683   -31.767  &lt; 2e-16 ***
ORIGIN_SZSKSZ04 -1.8504236  0.0362400   -51.060  &lt; 2e-16 ***
ORIGIN_SZSKSZ05 -0.2759035  0.0185157   -14.901  &lt; 2e-16 ***
ORIGIN_SZSLSZ01 -2.2757902  0.0348766   -65.253  &lt; 2e-16 ***
ORIGIN_SZSLSZ04 -0.0899820  0.0090356    -9.959  &lt; 2e-16 ***
ORIGIN_SZSRSZ01 -2.1460151  0.0187871  -114.228  &lt; 2e-16 ***
ORIGIN_SZTHSZ01 -2.6851549  0.0571841   -46.956  &lt; 2e-16 ***
ORIGIN_SZTHSZ03 -1.0121495  0.0275551   -36.732  &lt; 2e-16 ***
ORIGIN_SZTHSZ04 -2.6129645  0.0345167   -75.701  &lt; 2e-16 ***
ORIGIN_SZTHSZ06 -1.7229100  0.0208134   -82.779  &lt; 2e-16 ***
ORIGIN_SZTMSZ01 -0.2254986  0.0070312   -32.071  &lt; 2e-16 ***
ORIGIN_SZTMSZ02  1.7271575  0.0049219   350.914  &lt; 2e-16 ***
ORIGIN_SZTMSZ03  0.9891319  0.0052266   189.250  &lt; 2e-16 ***
ORIGIN_SZTMSZ04  0.2018090  0.0062114    32.490  &lt; 2e-16 ***
ORIGIN_SZTMSZ05 -1.1882870  0.0125842   -94.427  &lt; 2e-16 ***
ORIGIN_SZTNSZ01 -1.6122620  0.0141911  -113.611  &lt; 2e-16 ***
ORIGIN_SZTNSZ02 -1.5630967  0.0112227  -139.280  &lt; 2e-16 ***
ORIGIN_SZTNSZ03 -2.0739538  0.0149298  -138.914  &lt; 2e-16 ***
ORIGIN_SZTNSZ04 -0.2816960  0.0085295   -33.026  &lt; 2e-16 ***
ORIGIN_SZTPSZ01 -0.7822239  0.0077901  -100.412  &lt; 2e-16 ***
ORIGIN_SZTPSZ02  0.5735478  0.0053042   108.131  &lt; 2e-16 ***
ORIGIN_SZTPSZ03 -0.8748650  0.0074202  -117.903  &lt; 2e-16 ***
ORIGIN_SZTPSZ04 -0.8537831  0.0069792  -122.332  &lt; 2e-16 ***
ORIGIN_SZTPSZ05 -0.5581114  0.0077012   -72.471  &lt; 2e-16 ***
ORIGIN_SZTPSZ06  0.0262001  0.0075241     3.482 0.000497 ***
ORIGIN_SZTPSZ07 -0.5969952  0.0074272   -80.380  &lt; 2e-16 ***
ORIGIN_SZTPSZ08 -1.0537959  0.0111297   -94.683  &lt; 2e-16 ***
ORIGIN_SZTPSZ09 -0.9588508  0.0081314  -117.920  &lt; 2e-16 ***
ORIGIN_SZTPSZ10 -1.1177249  0.0089403  -125.021  &lt; 2e-16 ***
ORIGIN_SZTPSZ11 -0.2799677  0.0067135   -41.702  &lt; 2e-16 ***
ORIGIN_SZTPSZ12 -0.8898871  0.0080215  -110.938  &lt; 2e-16 ***
ORIGIN_SZTSSZ01 -2.6146463  0.0521606   -50.127  &lt; 2e-16 ***
ORIGIN_SZTSSZ02  0.1682588  0.0119965    14.026  &lt; 2e-16 ***
ORIGIN_SZTSSZ03  0.2587653  0.0123809    20.900  &lt; 2e-16 ***
ORIGIN_SZTSSZ04 -0.5473825  0.0135215   -40.482  &lt; 2e-16 ***
ORIGIN_SZTSSZ05 -0.9967379  0.0206068   -48.369  &lt; 2e-16 ***
ORIGIN_SZTSSZ06  0.4933147  0.0229597    21.486  &lt; 2e-16 ***
ORIGIN_SZWCSZ01  1.2524706  0.0111133   112.700  &lt; 2e-16 ***
ORIGIN_SZWCSZ02 -2.8544820  0.0347805   -82.071  &lt; 2e-16 ***
ORIGIN_SZWCSZ03 -5.1277334  0.1475585   -34.751  &lt; 2e-16 ***
ORIGIN_SZWDSZ01  1.4725308  0.0056496   260.645  &lt; 2e-16 ***
ORIGIN_SZWDSZ02  0.1571680  0.0064909    24.214  &lt; 2e-16 ***
ORIGIN_SZWDSZ03  1.2584097  0.0061471   204.717  &lt; 2e-16 ***
ORIGIN_SZWDSZ04  0.8578765  0.0069277   123.833  &lt; 2e-16 ***
ORIGIN_SZWDSZ05  0.1702728  0.0069687    24.434  &lt; 2e-16 ***
ORIGIN_SZWDSZ06  0.1736910  0.0069507    24.989  &lt; 2e-16 ***
ORIGIN_SZWDSZ07 -1.5610176  0.0100803  -154.859  &lt; 2e-16 ***
ORIGIN_SZWDSZ08 -0.9490906  0.0102047   -93.005  &lt; 2e-16 ***
ORIGIN_SZWDSZ09  1.2107011  0.0062294   194.354  &lt; 2e-16 ***
ORIGIN_SZYSSZ01 -0.3324158  0.0074537   -44.598  &lt; 2e-16 ***
ORIGIN_SZYSSZ02  0.8177113  0.0066108   123.693  &lt; 2e-16 ***
ORIGIN_SZYSSZ03  1.6751777  0.0058470   286.503  &lt; 2e-16 ***
ORIGIN_SZYSSZ04  0.8130044  0.0059025   137.738  &lt; 2e-16 ***
ORIGIN_SZYSSZ05  0.3678420  0.0072431    50.785  &lt; 2e-16 ***
ORIGIN_SZYSSZ06 -0.6024384  0.0126722   -47.540  &lt; 2e-16 ***
ORIGIN_SZYSSZ07 -0.7631918  0.0158478   -48.157  &lt; 2e-16 ***
ORIGIN_SZYSSZ08  0.2141930  0.0076154    28.126  &lt; 2e-16 ***
ORIGIN_SZYSSZ09  1.0809368  0.0057973   186.457  &lt; 2e-16 ***
DESTIN_SZAMSZ02  0.0761304  0.0051207    14.867  &lt; 2e-16 ***
DESTIN_SZAMSZ03  0.0143394  0.0050755     2.825 0.004724 ** 
DESTIN_SZAMSZ04 -1.2516780  0.0074947  -167.008  &lt; 2e-16 ***
DESTIN_SZAMSZ05 -1.2312375  0.0076598  -160.741  &lt; 2e-16 ***
DESTIN_SZAMSZ06 -1.0333412  0.0075283  -137.261  &lt; 2e-16 ***
DESTIN_SZAMSZ07 -1.5338249  0.0110036  -139.392  &lt; 2e-16 ***
DESTIN_SZAMSZ08 -0.3751665  0.0075358   -49.784  &lt; 2e-16 ***
DESTIN_SZAMSZ09 -1.1633493  0.0077556  -150.001  &lt; 2e-16 ***
DESTIN_SZAMSZ10  0.1017717  0.0053151    19.148  &lt; 2e-16 ***
DESTIN_SZAMSZ11 -0.8840362  0.0097007   -91.131  &lt; 2e-16 ***
DESTIN_SZAMSZ12  0.1628123  0.0055220    29.484  &lt; 2e-16 ***
DESTIN_SZBDSZ01  1.0040794  0.0047922   209.523  &lt; 2e-16 ***
DESTIN_SZBDSZ02 -0.2478149  0.0063085   -39.283  &lt; 2e-16 ***
DESTIN_SZBDSZ03  0.1016088  0.0057420    17.696  &lt; 2e-16 ***
DESTIN_SZBDSZ04  1.1082928  0.0047747   232.116  &lt; 2e-16 ***
DESTIN_SZBDSZ05  0.8737933  0.0050593   172.712  &lt; 2e-16 ***
DESTIN_SZBDSZ06  0.2897032  0.0058244    49.740  &lt; 2e-16 ***
DESTIN_SZBDSZ07 -0.9026193  0.0113656   -79.416  &lt; 2e-16 ***
DESTIN_SZBDSZ08 -1.7063577  0.0131234  -130.024  &lt; 2e-16 ***
DESTIN_SZBKSZ01 -1.3892839  0.0083307  -166.767  &lt; 2e-16 ***
DESTIN_SZBKSZ02 -0.6661120  0.0073464   -90.672  &lt; 2e-16 ***
DESTIN_SZBKSZ03 -0.9536826  0.0073196  -130.292  &lt; 2e-16 ***
DESTIN_SZBKSZ04 -0.6655610  0.0065868  -101.044  &lt; 2e-16 ***
DESTIN_SZBKSZ05 -0.9053119  0.0079264  -114.215  &lt; 2e-16 ***
DESTIN_SZBKSZ06 -1.2622159  0.0075079  -168.119  &lt; 2e-16 ***
DESTIN_SZBKSZ07 -0.0423370  0.0056686    -7.469 8.10e-14 ***
DESTIN_SZBKSZ08 -1.3811240  0.0084985  -162.515  &lt; 2e-16 ***
DESTIN_SZBKSZ09 -0.0797012  0.0061428   -12.975  &lt; 2e-16 ***
DESTIN_SZBLSZ01 -0.8859670  0.0088108  -100.555  &lt; 2e-16 ***
DESTIN_SZBLSZ02  0.1362723  0.0082167    16.585  &lt; 2e-16 ***
DESTIN_SZBLSZ03  1.2037396  0.0093508   128.732  &lt; 2e-16 ***
DESTIN_SZBLSZ04 -0.9316219  0.0178080   -52.315  &lt; 2e-16 ***
DESTIN_SZBMSZ01  0.7188470  0.0061160   117.536  &lt; 2e-16 ***
DESTIN_SZBMSZ02 -0.0597895  0.0061206    -9.769  &lt; 2e-16 ***
DESTIN_SZBMSZ03 -0.2427075  0.0069937   -34.704  &lt; 2e-16 ***
DESTIN_SZBMSZ04 -0.0622494  0.0065569    -9.494  &lt; 2e-16 ***
DESTIN_SZBMSZ05 -0.2857019  0.0086450   -33.048  &lt; 2e-16 ***
DESTIN_SZBMSZ06 -1.3486558  0.0158904   -84.872  &lt; 2e-16 ***
DESTIN_SZBMSZ07  0.4549687  0.0058315    78.020  &lt; 2e-16 ***
DESTIN_SZBMSZ08 -0.8730268  0.0077814  -112.195  &lt; 2e-16 ***
DESTIN_SZBMSZ09 -2.0319890  0.0163038  -124.633  &lt; 2e-16 ***
DESTIN_SZBMSZ10 -1.4319101  0.0102616  -139.541  &lt; 2e-16 ***
DESTIN_SZBMSZ11 -1.2429176  0.0092250  -134.733  &lt; 2e-16 ***
DESTIN_SZBMSZ12 -0.8526549  0.0096009   -88.810  &lt; 2e-16 ***
DESTIN_SZBMSZ13  0.1399907  0.0066885    20.930  &lt; 2e-16 ***
DESTIN_SZBMSZ14 -1.0103155  0.0091377  -110.566  &lt; 2e-16 ***
DESTIN_SZBMSZ15 -0.6819769  0.0086179   -79.135  &lt; 2e-16 ***
DESTIN_SZBMSZ16 -1.4468308  0.0134051  -107.931  &lt; 2e-16 ***
DESTIN_SZBMSZ17 -1.5312175  0.0186843   -81.952  &lt; 2e-16 ***
DESTIN_SZBPSZ01 -1.1726725  0.0073257  -160.077  &lt; 2e-16 ***
DESTIN_SZBPSZ02 -2.1072012  0.0103320  -203.949  &lt; 2e-16 ***
DESTIN_SZBPSZ03 -1.6944911  0.0098520  -171.995  &lt; 2e-16 ***
DESTIN_SZBPSZ04 -0.7664610  0.0074458  -102.939  &lt; 2e-16 ***
DESTIN_SZBPSZ05  0.1358370  0.0056258    24.145  &lt; 2e-16 ***
DESTIN_SZBPSZ06 -1.2425471  0.0096942  -128.175  &lt; 2e-16 ***
DESTIN_SZBPSZ07 -0.1666192  0.0094969   -17.545  &lt; 2e-16 ***
DESTIN_SZBSSZ01  0.3857894  0.0057261    67.374  &lt; 2e-16 ***
DESTIN_SZBSSZ02 -0.5293265  0.0064886   -81.578  &lt; 2e-16 ***
DESTIN_SZBSSZ03  0.3909966  0.0048540    80.551  &lt; 2e-16 ***
DESTIN_SZBTSZ01  0.7114965  0.0054528   130.482  &lt; 2e-16 ***
DESTIN_SZBTSZ02 -0.0487084  0.0082474    -5.906 3.51e-09 ***
DESTIN_SZBTSZ03  0.5539032  0.0064423    85.979  &lt; 2e-16 ***
DESTIN_SZBTSZ04 -0.7120734  0.0128676   -55.339  &lt; 2e-16 ***
DESTIN_SZBTSZ05  0.2176097  0.0086791    25.073  &lt; 2e-16 ***
DESTIN_SZBTSZ06 -0.2167084  0.0084925   -25.518  &lt; 2e-16 ***
DESTIN_SZBTSZ07 -1.4045618  0.0124363  -112.940  &lt; 2e-16 ***
DESTIN_SZBTSZ08 -0.8213918  0.0120793   -68.000  &lt; 2e-16 ***
DESTIN_SZCBSZ01 -5.7340877  0.3333916   -17.199  &lt; 2e-16 ***
DESTIN_SZCCSZ01 -0.0304192  0.0095920    -3.171 0.001518 ** 
DESTIN_SZCHSZ01 -0.2598507  0.0115311   -22.535  &lt; 2e-16 ***
DESTIN_SZCHSZ02  0.3497750  0.0068334    51.186  &lt; 2e-16 ***
DESTIN_SZCHSZ03  2.4550172  0.0050883   482.481  &lt; 2e-16 ***
DESTIN_SZCKSZ01 -0.4691744  0.0063130   -74.319  &lt; 2e-16 ***
DESTIN_SZCKSZ02 -0.9557084  0.0069331  -137.847  &lt; 2e-16 ***
DESTIN_SZCKSZ03  0.0442112  0.0057117     7.740 9.91e-15 ***
DESTIN_SZCKSZ04 -0.8592063  0.0081238  -105.764  &lt; 2e-16 ***
DESTIN_SZCKSZ05 -1.1745333  0.0087305  -134.532  &lt; 2e-16 ***
DESTIN_SZCKSZ06 -0.4982877  0.0085514   -58.269  &lt; 2e-16 ***
DESTIN_SZCLSZ01  0.2665065  0.0059712    44.632  &lt; 2e-16 ***
DESTIN_SZCLSZ02 -1.9758876  0.0150823  -131.007  &lt; 2e-16 ***
DESTIN_SZCLSZ03 -0.9051310  0.0091479   -98.944  &lt; 2e-16 ***
DESTIN_SZCLSZ04 -0.0828732  0.0061559   -13.462  &lt; 2e-16 ***
DESTIN_SZCLSZ05 -1.1414780  0.0100760  -113.287  &lt; 2e-16 ***
DESTIN_SZCLSZ06  0.3229402  0.0056269    57.392  &lt; 2e-16 ***
DESTIN_SZCLSZ07 -0.4833612  0.0069777   -69.272  &lt; 2e-16 ***
DESTIN_SZCLSZ08 -0.3219670  0.0075615   -42.580  &lt; 2e-16 ***
DESTIN_SZCLSZ09  0.0564166  0.0080703     6.991 2.74e-12 ***
DESTIN_SZDTSZ02 -1.6384236  0.0374725   -43.723  &lt; 2e-16 ***
DESTIN_SZDTSZ03 -0.4021571  0.0152716   -26.334  &lt; 2e-16 ***
DESTIN_SZDTSZ13 -1.2799441  0.0177095   -72.274  &lt; 2e-16 ***
DESTIN_SZGLSZ01 -0.0190303  0.0060665    -3.137 0.001707 ** 
DESTIN_SZGLSZ02 -0.0308469  0.0058724    -5.253 1.50e-07 ***
DESTIN_SZGLSZ03  0.6927638  0.0048456   142.969  &lt; 2e-16 ***
DESTIN_SZGLSZ04  0.9325848  0.0049183   189.616  &lt; 2e-16 ***
DESTIN_SZGLSZ05  0.8480056  0.0048801   173.768  &lt; 2e-16 ***
DESTIN_SZHGSZ01  0.0652969  0.0047795    13.662  &lt; 2e-16 ***
DESTIN_SZHGSZ02 -0.9498251  0.0066577  -142.667  &lt; 2e-16 ***
DESTIN_SZHGSZ03 -1.4372499  0.0076387  -188.154  &lt; 2e-16 ***
DESTIN_SZHGSZ04 -0.5236292  0.0055353   -94.599  &lt; 2e-16 ***
DESTIN_SZHGSZ05 -0.5420295  0.0058099   -93.295  &lt; 2e-16 ***
DESTIN_SZHGSZ06 -0.9054730  0.0067581  -133.983  &lt; 2e-16 ***
DESTIN_SZHGSZ07  0.0215109  0.0054019     3.982 6.83e-05 ***
DESTIN_SZHGSZ08 -0.0490979  0.0059206    -8.293  &lt; 2e-16 ***
DESTIN_SZHGSZ09 -0.0711560  0.0062875   -11.317  &lt; 2e-16 ***
DESTIN_SZHGSZ10 -3.5807154  0.0290642  -123.200  &lt; 2e-16 ***
DESTIN_SZJESZ01 -0.4023638  0.0065057   -61.848  &lt; 2e-16 ***
DESTIN_SZJESZ02 -0.7654353  0.0067096  -114.081  &lt; 2e-16 ***
DESTIN_SZJESZ03 -0.8778812  0.0071238  -123.232  &lt; 2e-16 ***
DESTIN_SZJESZ04 -1.1998075  0.0088733  -135.215  &lt; 2e-16 ***
DESTIN_SZJESZ05 -1.5623652  0.0116898  -133.652  &lt; 2e-16 ***
DESTIN_SZJESZ06  0.2311474  0.0055595    41.577  &lt; 2e-16 ***
DESTIN_SZJESZ07 -1.2753348  0.0094838  -134.475  &lt; 2e-16 ***
DESTIN_SZJESZ08 -0.7654533  0.0099306   -77.081  &lt; 2e-16 ***
DESTIN_SZJESZ09  0.1637628  0.0074164    22.081  &lt; 2e-16 ***
DESTIN_SZJESZ10  0.7394958  0.0091249    81.041  &lt; 2e-16 ***
DESTIN_SZJESZ11  0.5157364  0.0086546    59.591  &lt; 2e-16 ***
DESTIN_SZJWSZ01 -1.0165204  0.0083025  -122.435  &lt; 2e-16 ***
DESTIN_SZJWSZ02 -0.8530646  0.0067851  -125.727  &lt; 2e-16 ***
DESTIN_SZJWSZ03  0.5176135  0.0056449    91.695  &lt; 2e-16 ***
DESTIN_SZJWSZ04  0.3427105  0.0058499    58.584  &lt; 2e-16 ***
DESTIN_SZJWSZ05 -1.1695940  0.0080069  -146.073  &lt; 2e-16 ***
DESTIN_SZJWSZ06 -0.7466462  0.0070240  -106.299  &lt; 2e-16 ***
DESTIN_SZJWSZ07 -3.0124535  0.0333481   -90.334  &lt; 2e-16 ***
DESTIN_SZJWSZ08 -0.4253502  0.0066584   -63.881  &lt; 2e-16 ***
DESTIN_SZJWSZ09  0.9428005  0.0053190   177.251  &lt; 2e-16 ***
DESTIN_SZKLSZ01 -0.2965013  0.0066422   -44.639  &lt; 2e-16 ***
DESTIN_SZKLSZ02 -0.4921137  0.0067689   -72.702  &lt; 2e-16 ***
DESTIN_SZKLSZ03 -0.8489213  0.0078294  -108.427  &lt; 2e-16 ***
DESTIN_SZKLSZ04 -1.2656342  0.0099918  -126.667  &lt; 2e-16 ***
DESTIN_SZKLSZ05 -0.3570126  0.0096300   -37.073  &lt; 2e-16 ***
DESTIN_SZKLSZ06 -2.4764906  0.0390868   -63.359  &lt; 2e-16 ***
DESTIN_SZKLSZ07 -0.7316189  0.0080994   -90.330  &lt; 2e-16 ***
DESTIN_SZKLSZ08 -0.1115398  0.0061168   -18.235  &lt; 2e-16 ***
DESTIN_SZLKSZ01 -1.4940710  0.0271518   -55.027  &lt; 2e-16 ***
DESTIN_SZMDSZ01 -1.6101440  0.0231238   -69.631  &lt; 2e-16 ***
DESTIN_SZMDSZ02 -0.9339318  0.0126277   -73.959  &lt; 2e-16 ***
DESTIN_SZMDSZ03 -3.4868547  0.0303657  -114.829  &lt; 2e-16 ***
DESTIN_SZMPSZ01 -0.4518483  0.0089869   -50.279  &lt; 2e-16 ***
DESTIN_SZMPSZ02 -0.5868264  0.0073193   -80.176  &lt; 2e-16 ***
DESTIN_SZMPSZ03  0.4805365  0.0059041    81.391  &lt; 2e-16 ***
DESTIN_SZMUSZ02 -1.3837581  0.0218713   -63.268  &lt; 2e-16 ***
DESTIN_SZNTSZ01 -3.0694691  0.0533346   -57.551  &lt; 2e-16 ***
DESTIN_SZNTSZ02 -1.4992973  0.0130358  -115.014  &lt; 2e-16 ***
DESTIN_SZNTSZ03 -0.5221236  0.0089923   -58.064  &lt; 2e-16 ***
DESTIN_SZNTSZ05 -1.9751162  0.0282369   -69.948  &lt; 2e-16 ***
DESTIN_SZNTSZ06 -3.9959411  0.0511214   -78.166  &lt; 2e-16 ***
DESTIN_SZNVSZ01 -0.1126966  0.0057077   -19.745  &lt; 2e-16 ***
DESTIN_SZNVSZ02 -0.0259250  0.0064427    -4.024 5.72e-05 ***
DESTIN_SZNVSZ03 -0.0123214  0.0067692    -1.820 0.068725 .  
DESTIN_SZNVSZ04 -1.3371298  0.0130261  -102.650  &lt; 2e-16 ***
DESTIN_SZNVSZ05 -0.9686333  0.0101539   -95.395  &lt; 2e-16 ***
DESTIN_SZPGSZ01 -1.1798309  0.0180543   -65.349  &lt; 2e-16 ***
DESTIN_SZPGSZ02 -1.3289737  0.0085335  -155.736  &lt; 2e-16 ***
DESTIN_SZPGSZ03 -0.1661373  0.0055166   -30.116  &lt; 2e-16 ***
DESTIN_SZPGSZ04 -0.3046408  0.0058469   -52.103  &lt; 2e-16 ***
DESTIN_SZPGSZ05 -1.5412612  0.0093261  -165.264  &lt; 2e-16 ***
DESTIN_SZPLSZ01 -0.3439667  0.0083504   -41.192  &lt; 2e-16 ***
DESTIN_SZPLSZ02 -1.7574919  0.0154244  -113.942  &lt; 2e-16 ***
DESTIN_SZPLSZ03 -0.3455776  0.0112089   -30.831  &lt; 2e-16 ***
DESTIN_SZPLSZ04 -2.0749385  0.0141153  -146.999  &lt; 2e-16 ***
DESTIN_SZPLSZ05 -0.4855216  0.0134069   -36.214  &lt; 2e-16 ***
DESTIN_SZPNSZ01  0.0117816  0.0083558     1.410 0.158543    
DESTIN_SZPNSZ02  0.7389858  0.0089823    82.272  &lt; 2e-16 ***
DESTIN_SZPNSZ03 -0.4708719  0.0098588   -47.761  &lt; 2e-16 ***
DESTIN_SZPNSZ04  1.3156771  0.0111200   118.316  &lt; 2e-16 ***
DESTIN_SZPNSZ05  0.9881886  0.0153169    64.516  &lt; 2e-16 ***
DESTIN_SZPRSZ01 -1.0678999  0.0098295  -108.642  &lt; 2e-16 ***
DESTIN_SZPRSZ02  0.0650279  0.0063927    10.172  &lt; 2e-16 ***
DESTIN_SZPRSZ03  0.6348138  0.0050147   126.592  &lt; 2e-16 ***
DESTIN_SZPRSZ04 -0.3640286  0.0097572   -37.309  &lt; 2e-16 ***
DESTIN_SZPRSZ05  0.0380410  0.0062577     6.079 1.21e-09 ***
DESTIN_SZPRSZ06  0.3153712  0.0068742    45.877  &lt; 2e-16 ***
DESTIN_SZPRSZ07 -1.6669973  0.0145573  -114.513  &lt; 2e-16 ***
DESTIN_SZPRSZ08 -0.6170648  0.0078424   -78.683  &lt; 2e-16 ***
DESTIN_SZQTSZ01 -0.5496582  0.0098285   -55.925  &lt; 2e-16 ***
DESTIN_SZQTSZ02 -0.7318114  0.0086807   -84.303  &lt; 2e-16 ***
DESTIN_SZQTSZ03 -0.5893064  0.0084789   -69.503  &lt; 2e-16 ***
DESTIN_SZQTSZ04 -0.7103906  0.0085341   -83.242  &lt; 2e-16 ***
DESTIN_SZQTSZ05 -0.4721472  0.0078164   -60.405  &lt; 2e-16 ***
DESTIN_SZQTSZ06 -0.6591466  0.0080069   -82.322  &lt; 2e-16 ***
DESTIN_SZQTSZ07 -0.9540454  0.0126807   -75.236  &lt; 2e-16 ***
DESTIN_SZQTSZ08  0.4508867  0.0064870    69.507  &lt; 2e-16 ***
DESTIN_SZQTSZ09 -0.4061810  0.0075485   -53.810  &lt; 2e-16 ***
DESTIN_SZQTSZ10  0.1351889  0.0068202    19.822  &lt; 2e-16 ***
DESTIN_SZQTSZ11  0.3181553  0.0067958    46.816  &lt; 2e-16 ***
DESTIN_SZQTSZ12 -0.1055766  0.0095576   -11.046  &lt; 2e-16 ***
DESTIN_SZQTSZ13  0.5199663  0.0071928    72.290  &lt; 2e-16 ***
DESTIN_SZQTSZ14  0.6086332  0.0078537    77.496  &lt; 2e-16 ***
DESTIN_SZQTSZ15  1.3906866  0.0092250   150.753  &lt; 2e-16 ***
DESTIN_SZRCSZ01 -0.0862091  0.0085363   -10.099  &lt; 2e-16 ***
DESTIN_SZRCSZ06 -1.0186282  0.0211113   -48.250  &lt; 2e-16 ***
DESTIN_SZRVSZ01 -1.5294454  0.0179337   -85.283  &lt; 2e-16 ***
DESTIN_SZRVSZ02 -2.3607754  0.0355628   -66.383  &lt; 2e-16 ***
DESTIN_SZRVSZ03 -1.5266254  0.0156276   -97.688  &lt; 2e-16 ***
DESTIN_SZRVSZ04 -1.0986565  0.0168695   -65.127  &lt; 2e-16 ***
DESTIN_SZRVSZ05 -2.4004418  0.0320917   -74.799  &lt; 2e-16 ***
DESTIN_SZSBSZ01 -1.4023966  0.0109496  -128.078  &lt; 2e-16 ***
DESTIN_SZSBSZ02 -1.3899893  0.0090891  -152.929  &lt; 2e-16 ***
DESTIN_SZSBSZ03  0.4509008  0.0059864    75.321  &lt; 2e-16 ***
DESTIN_SZSBSZ04  0.1796309  0.0070142    25.610  &lt; 2e-16 ***
DESTIN_SZSBSZ05 -1.3159699  0.0096485  -136.391  &lt; 2e-16 ***
DESTIN_SZSBSZ06 -1.7705263  0.0253064   -69.964  &lt; 2e-16 ***
DESTIN_SZSBSZ07 -0.7471529  0.0238628   -31.310  &lt; 2e-16 ***
DESTIN_SZSBSZ08  0.7884520  0.0069638   113.221  &lt; 2e-16 ***
DESTIN_SZSBSZ09  0.0131702  0.0066350     1.985 0.047150 *  
DESTIN_SZSESZ02 -0.7247347  0.0060626  -119.541  &lt; 2e-16 ***
DESTIN_SZSESZ03  0.1032728  0.0048330    21.368  &lt; 2e-16 ***
DESTIN_SZSESZ04 -1.0992420  0.0068328  -160.878  &lt; 2e-16 ***
DESTIN_SZSESZ05 -0.8374712  0.0058155  -144.006  &lt; 2e-16 ***
DESTIN_SZSESZ06 -0.5531619  0.0074766   -73.985  &lt; 2e-16 ***
DESTIN_SZSESZ07 -3.0328672  0.0246371  -123.101  &lt; 2e-16 ***
DESTIN_SZSGSZ01 -0.1933777  0.0068235   -28.340  &lt; 2e-16 ***
DESTIN_SZSGSZ02 -0.3000845  0.0060284   -49.779  &lt; 2e-16 ***
DESTIN_SZSGSZ03 -0.4322879  0.0057308   -75.433  &lt; 2e-16 ***
DESTIN_SZSGSZ04 -0.1214792  0.0056548   -21.482  &lt; 2e-16 ***
DESTIN_SZSGSZ05 -2.0309074  0.0114993  -176.611  &lt; 2e-16 ***
DESTIN_SZSGSZ06  0.6592095  0.0046364   142.182  &lt; 2e-16 ***
DESTIN_SZSGSZ07 -0.4618538  0.0062027   -74.460  &lt; 2e-16 ***
DESTIN_SZSISZ01 -0.5227257  0.0293399   -17.816  &lt; 2e-16 ***
DESTIN_SZSKSZ01 -0.4797341  0.0091087   -52.668  &lt; 2e-16 ***
DESTIN_SZSKSZ02  0.8477357  0.0067821   124.996  &lt; 2e-16 ***
DESTIN_SZSKSZ03 -0.2477566  0.0074817   -33.115  &lt; 2e-16 ***
DESTIN_SZSKSZ04 -1.3315992  0.0167055   -79.710  &lt; 2e-16 ***
DESTIN_SZSKSZ05 -0.3519096  0.0131326   -26.797  &lt; 2e-16 ***
DESTIN_SZSLSZ01 -0.8570431  0.0102100   -83.941  &lt; 2e-16 ***
DESTIN_SZSLSZ04 -0.9949105  0.0088280  -112.699  &lt; 2e-16 ***
DESTIN_SZSRSZ01 -1.0260696  0.0154393   -66.458  &lt; 2e-16 ***
DESTIN_SZTHSZ01 -4.2040410  0.0404795  -103.856  &lt; 2e-16 ***
DESTIN_SZTHSZ03 -2.4907000  0.0264056   -94.325  &lt; 2e-16 ***
DESTIN_SZTHSZ04 -3.0701470  0.0244975  -125.325  &lt; 2e-16 ***
DESTIN_SZTHSZ06 -2.5308161  0.0169699  -149.135  &lt; 2e-16 ***
DESTIN_SZTMSZ01 -0.2354889  0.0067201   -35.042  &lt; 2e-16 ***
DESTIN_SZTMSZ02  1.7379292  0.0044573   389.906  &lt; 2e-16 ***
DESTIN_SZTMSZ03  0.9112458  0.0048718   187.043  &lt; 2e-16 ***
DESTIN_SZTMSZ04  1.0731075  0.0048626   220.685  &lt; 2e-16 ***
DESTIN_SZTMSZ05  0.6398583  0.0067321    95.046  &lt; 2e-16 ***
DESTIN_SZTNSZ01 -0.3500456  0.0083835   -41.754  &lt; 2e-16 ***
DESTIN_SZTNSZ02 -1.0573515  0.0112412   -94.060  &lt; 2e-16 ***
DESTIN_SZTNSZ03 -1.4069979  0.0132733  -106.002  &lt; 2e-16 ***
DESTIN_SZTNSZ04 -0.3616604  0.0085207   -42.445  &lt; 2e-16 ***
DESTIN_SZTPSZ01 -0.5919243  0.0071153   -83.190  &lt; 2e-16 ***
DESTIN_SZTPSZ02  0.7083350  0.0046540   152.198  &lt; 2e-16 ***
DESTIN_SZTPSZ03 -0.5746433  0.0069625   -82.534  &lt; 2e-16 ***
DESTIN_SZTPSZ04 -1.5821259  0.0084517  -187.196  &lt; 2e-16 ***
DESTIN_SZTPSZ05 -1.1796256  0.0073039  -161.505  &lt; 2e-16 ***
DESTIN_SZTPSZ06 -0.3968272  0.0077295   -51.339  &lt; 2e-16 ***
DESTIN_SZTPSZ07 -2.1796617  0.0135199  -161.219  &lt; 2e-16 ***
DESTIN_SZTPSZ08 -1.2568483  0.0107267  -117.170  &lt; 2e-16 ***
DESTIN_SZTPSZ09 -0.2446623  0.0080840   -30.265  &lt; 2e-16 ***
DESTIN_SZTPSZ10 -1.2542191  0.0102049  -122.904  &lt; 2e-16 ***
DESTIN_SZTPSZ11 -0.0886883  0.0062888   -14.102  &lt; 2e-16 ***
DESTIN_SZTPSZ12 -0.7211823  0.0075086   -96.048  &lt; 2e-16 ***
DESTIN_SZTSSZ01 -1.6271921  0.0238498   -68.227  &lt; 2e-16 ***
DESTIN_SZTSSZ02 -0.3340439  0.0169137   -19.750  &lt; 2e-16 ***
DESTIN_SZTSSZ03  0.3924580  0.0111060    35.338  &lt; 2e-16 ***
DESTIN_SZTSSZ04  0.4169932  0.0114926    36.283  &lt; 2e-16 ***
DESTIN_SZTSSZ05  1.3206287  0.0120381   109.704  &lt; 2e-16 ***
DESTIN_SZTSSZ06  2.4023725  0.0192840   124.579  &lt; 2e-16 ***
DESTIN_SZWCSZ01  2.0697378  0.0061379   337.206  &lt; 2e-16 ***
DESTIN_SZWCSZ02 -2.0934025  0.0134782  -155.318  &lt; 2e-16 ***
DESTIN_SZWCSZ03 -3.0670149  0.0349748   -87.692  &lt; 2e-16 ***
DESTIN_SZWDSZ01  1.0113215  0.0051461   196.522  &lt; 2e-16 ***
DESTIN_SZWDSZ02 -1.3383793  0.0076482  -174.993  &lt; 2e-16 ***
DESTIN_SZWDSZ03  0.3394361  0.0060396    56.202  &lt; 2e-16 ***
DESTIN_SZWDSZ04 -0.8324928  0.0086019   -96.780  &lt; 2e-16 ***
DESTIN_SZWDSZ05 -0.8279090  0.0083251   -99.447  &lt; 2e-16 ***
DESTIN_SZWDSZ06 -0.2252899  0.0061074   -36.888  &lt; 2e-16 ***
DESTIN_SZWDSZ07 -1.3638599  0.0077990  -174.877  &lt; 2e-16 ***
DESTIN_SZWDSZ08 -0.4350176  0.0077566   -56.083  &lt; 2e-16 ***
DESTIN_SZWDSZ09  0.5461048  0.0060745    89.901  &lt; 2e-16 ***
DESTIN_SZYSSZ01  0.0243093  0.0053476     4.546 5.47e-06 ***
DESTIN_SZYSSZ02 -0.3398962  0.0065947   -51.540  &lt; 2e-16 ***
DESTIN_SZYSSZ03 -0.3694187  0.0074032   -49.900  &lt; 2e-16 ***
DESTIN_SZYSSZ04 -0.5222848  0.0067396   -77.495  &lt; 2e-16 ***
DESTIN_SZYSSZ05 -1.5460539  0.0124899  -123.784  &lt; 2e-16 ***
DESTIN_SZYSSZ06 -1.5556892  0.0127640  -121.881  &lt; 2e-16 ***
DESTIN_SZYSSZ07 -0.8673403  0.0167723   -51.713  &lt; 2e-16 ***
DESTIN_SZYSSZ08  0.5389364  0.0052540   102.577  &lt; 2e-16 ***
DESTIN_SZYSSZ09  0.1199483  0.0055235    21.716  &lt; 2e-16 ***
log(dist)       -1.8906989  0.0005319 -3554.786  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 36117615  on 14273  degrees of freedom
Residual deviance:  8091747  on 13715  degrees of freedom
AIC: 8177420

Number of Fisher Scoring iterations: 7</code></pre>
</div>
</div>
<p>We can examine how the constraints hold for destinations this time.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CalcRSquared</span>(dbcSIM<span class="sc">$</span>data<span class="sc">$</span>TRIPS, dbcSIM<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6883675</code></pre>
</div>
</div>
<p>Notice that there is a relatively greater improvement in the R^2 value.</p>
</section>
<section id="model-comparison" class="level3">
<h3 class="anchored" data-anchor-id="model-comparison">Model comparison</h3>
<p>Another useful model performance measure for continuous dependent variable is <a href="https://towardsdatascience.com/what-does-rmse-really-mean-806b65f2e48e">Root Mean Squared Error</a>. In this sub-section, you will learn how to use <a href="https://easystats.github.io/performance/reference/compare_performance.html"><code>compare_performance()</code></a> of <a href="https://easystats.github.io/performance/index.html"><strong>performance</strong></a> package</p>
<p>First of all, let us create a list called <em>model_list</em> by using the code chun below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>model_list <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">unconstrained=</span>uncSIM,</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">originConstrained=</span>orcSIM,</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">destinationConstrained=</span>decSIM,</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">doublyConstrained=</span>dbcSIM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we will compute the RMSE of all the models in <em>model_list</em> file by using the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(model_list,</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">metrics =</span> <span class="st">"RMSE"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name                   | Model |     RMSE
-----------------------------------------
unconstrained          |   glm | 2560.120
originConstrained      |   glm | 2057.579
destinationConstrained |   glm | 1891.724
doublyConstrained      |   glm | 1487.111</code></pre>
</div>
</div>
<p>The print above reveals that doubly constrained SIM is the best model among all the four SIMs because it has the smallest RMSE value of 1487.111.</p>
</section>
<section id="visualising-fitted" class="level3">
<h3 class="anchored" data-anchor-id="visualising-fitted">Visualising fitted</h3>
<p>In this section, you will learn how to visualise the observed values and the fitted values.</p>
<p>Firstly we will extract the fitted values from each model by using the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(uncSIM<span class="sc">$</span>fitted.values) <span class="sc">%&gt;%</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we will join the values to <em>SIM_data</em> data frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>SIM_data <span class="ot">&lt;-</span> SIM_data <span class="sc">%&gt;%</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(df) <span class="sc">%&gt;%</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">uncTRIPS =</span> <span class="st">"uncSIM$fitted.values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Repeat the same step by for Origin Constrained SIM (i.e.&nbsp;orcSIM)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(orcSIM<span class="sc">$</span>fitted.values) <span class="sc">%&gt;%</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>SIM_data <span class="ot">&lt;-</span> SIM_data <span class="sc">%&gt;%</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(df) <span class="sc">%&gt;%</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">orcTRIPS =</span> <span class="st">"orcSIM$fitted.values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Repeat the same step by for Destination Constrained SIM (i.e.&nbsp;decSIM)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(decSIM<span class="sc">$</span>fitted.values) <span class="sc">%&gt;%</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>SIM_data <span class="ot">&lt;-</span> SIM_data <span class="sc">%&gt;%</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(df) <span class="sc">%&gt;%</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">decTRIPS =</span> <span class="st">"decSIM$fitted.values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Repeat the same step by for Doubly Constrained SIM (i.e.&nbsp;dbcSIM)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(dbcSIM<span class="sc">$</span>fitted.values) <span class="sc">%&gt;%</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>SIM_data <span class="ot">&lt;-</span> SIM_data <span class="sc">%&gt;%</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(df) <span class="sc">%&gt;%</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">dbcTRIPS =</span> <span class="st">"dbcSIM$fitted.values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>unc_p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> SIM_data,</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> uncTRIPS,</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> TRIPS)) <span class="sc">+</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>orc_p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> SIM_data,</span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> orcTRIPS,</span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> TRIPS)) <span class="sc">+</span></span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a>dec_p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> SIM_data,</span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> decTRIPS,</span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> TRIPS)) <span class="sc">+</span></span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span>
<span id="cb97-18"><a href="#cb97-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-19"><a href="#cb97-19" aria-hidden="true" tabindex="-1"></a>dbc_p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> SIM_data,</span>
<span id="cb97-20"><a href="#cb97-20" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> dbcTRIPS,</span>
<span id="cb97-21"><a href="#cb97-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> TRIPS)) <span class="sc">+</span></span>
<span id="cb97-22"><a href="#cb97-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb97-23"><a href="#cb97-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span>
<span id="cb97-24"><a href="#cb97-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-25"><a href="#cb97-25" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(unc_p, orc_p, dec_p, dbc_p,</span>
<span id="cb97-26"><a href="#cb97-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb97-27"><a href="#cb97-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="In-class_Ex11_SIM_files/figure-html/unnamed-chunk-76-1.png" class="img-fluid" width="672"></p>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>